"use strict";(self.webpackChunkflink=self.webpackChunkflink||[]).push([[615],{40615:(st,C,o)=>{o.r(C),o.d(C,{CompletedJobModule:()=>at});var d=o(69808),b=o(32846),l=o(30325),x=o(9248),S=o(92245),j=o(30796),O=o(20035),t=o(5e3),m=o(22679);let Z=(()=>{class e{constructor(n,a){this.statusService=n,this.router=a}canActivate(n,a){return!!this.statusService.configuration.features["web-history"]||(this.router.navigate(["/","job","completed",n.parent.params.jid,"overview"]).then(),!1)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(m.B),t.LFG(l.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var p=o(8929),I=o(30567),T=o(21086),z=o(27221),u=o(7625),D=o(94138),R=o(67035);let F=(()=>{class e{constructor(n,a,i){this.activatedRoute=n,this.jobManagerService=a,this.cdr=i,this.configurations=[],this.loading=!0,this.destroy$=new p.xQ}ngOnInit(){this.jobId=this.activatedRoute.parent.snapshot.params.jid,(0,I.D)([this.jobManagerService.loadHistoryServerConfig(this.jobId).pipe((0,z.K)(()=>(0,T.of)([]))),this.jobManagerService.loadHistoryServerEnvironment(this.jobId).pipe((0,z.K)(()=>(0,T.of)(void 0)))]).pipe((0,u.R)(this.destroy$)).subscribe(([n,a])=>{this.loading=!1,this.configurations=n.sort((i,g)=>i.key>g.key?1:-1),this.environmentInfo=a,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(l.gz),t.Y36(D.x),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["flink-cluster-config"]],decls:1,vars:3,consts:[["title","Job Manager Configuration",3,"configurations","environmentInfo","loading"]],template:function(n,a){1&n&&t._UZ(0,"flink-configuration-cards",0),2&n&&t.Q6J("configurations",a.configurations)("environmentInfo",a.environmentInfo)("loading",a.loading)},directives:[R.I],styles:["[_nghost-%COMP%]{display:flex;flex:1;flex-direction:column}"],changeDetection:0}),e})();var U=o(66176);const Q=[{path:"",component:O.J,children:[{path:"overview",loadChildren:()=>Promise.all([o.e(44),o.e(80)]).then(o.bind(o,78080)).then(e=>e.JobOverviewModule),data:{path:"overview"}},{path:"timeline",component:U.Q,data:{path:"timeline"}},{path:"exceptions",component:j.R,data:{path:"exceptions"}},{path:"checkpoints",component:x.G,data:{path:"checkpoints"}},{path:"configuration",component:S.V,data:{path:"configuration"}},{path:"cluster_configuration",component:F,canActivate:[Z],data:{path:"cluster_configuration"}},{path:"**",redirectTo:"overview",pathMatch:"full"}]}];let Y=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[l.Bz.forChild(Q)],l.Bz]}),e})();var h=o(15126),E=o(90342),H=o(22359),L=o(77484),r=o(63677),V=o(90685),f=o(70647),v=o(63640),B=o(92051),$=o(76559),N=o(70592),G=o(90868),k=o(72986),y=o(92198),M=o(61709),J=o(88098),A=o(45695),c=o(64219);function W(e,s){1&e&&(t.TgZ(0,"span"),t._uU(1," -\n"),t.qZA())}function w(e,s){if(1&e&&(t.TgZ(0,"a",2),t._UZ(1,"i",3),t.qZA(),t.TgZ(2,"nz-dropdown-menu",null,4),t.TgZ(4,"ul",5),t.TgZ(5,"li",6),t.TgZ(6,"a",7),t._uU(7,"View External Taskmanager Log"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e){const n=t.MAs(3),a=t.oxw();t.Q6J("nzDropdownMenu",n),t.xp6(5),t.Q6J("nzDisabled",a.loading),t.xp6(1),t.Q6J("href",a.logUrl,t.LSH)}}let P=(()=>{class e{constructor(n,a,i){this.jobLocalService=n,this.taskManagerService=a,this.cdr=i,this.loading=!0,this.logUrl="",this.destroy$=new p.xQ}ngOnInit(){this.jobLocalService.jobDetailChanges().pipe((0,k.q)(1),(0,y.h)(()=>{var n;return!!(null===(n=this.subtask)||void 0===n?void 0:n["taskmanager-id"])&&"(unassigned)"!==this.subtask["taskmanager-id"]}),(0,M.zg)(n=>this.taskManagerService.loadHistoryServerTaskManagerLogUrl(n.jid,this.subtask["taskmanager-id"])),(0,u.R)(this.destroy$)).subscribe(n=>{this.loading=!1,this.logUrl=n,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(J.R),t.Y36(A.k),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["flink-completed-job-subtasks-table-action"]],inputs:{subtask:"subtask"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["hrefTpl",""],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"nzDisabled"],["target","_blank",3,"href"]],template:function(n,a){if(1&n&&(t.YNc(0,W,2,0,"span",0),t.YNc(1,w,8,3,"ng-template",null,1,t.W1O)),2&n){const i=t.MAs(2);t.Q6J("ngIf",!a.subtask||!a.subtask["taskmanager-id"]||"(unassigned)"===a.subtask["taskmanager-id"])("ngIfElse",i)}},directives:[d.O5,r.Ws,r.cm,f.Ls,r.RR,c.wO,c.r9],styles:[""],changeDetection:0}),e})();var X=o(71470);function K(e,s){1&e&&(t.TgZ(0,"span"),t._uU(1,"-"),t.qZA())}function q(e,s){if(1&e&&(t.ynx(0),t._UZ(1,"flink-table-aggregated-metrics",11),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("aggregated",n.taskManager.aggregated)}}function _(e,s){if(1&e&&(t.TgZ(0,"li",12),t.TgZ(1,"a",13),t._uU(2,"View External Taskmanager Log"),t.qZA(),t.qZA()),2&e){const n=t.oxw(2);t.Q6J("nzDisabled",n.loading),t.xp6(1),t.Q6J("href",n.logUrl,t.LSH)}}function tt(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"a",2),t._UZ(1,"i",3),t.qZA(),t.TgZ(2,"nz-dropdown-menu",null,4),t.TgZ(4,"ul",5),t.TgZ(5,"li",6),t.TgZ(6,"a",7),t.NdJ("click",function(){return t.CHM(n),t.oxw().setModalVisible(!0)}),t._uU(7,"View Aggregated Metrics"),t.qZA(),t.TgZ(8,"nz-modal",8),t.NdJ("nzVisibleChange",function(i){return t.CHM(n),t.oxw().visible=i})("nzOnCancel",function(){return t.CHM(n),t.oxw().setModalVisible(!1)}),t.YNc(9,q,2,1,"ng-container",9),t.qZA(),t.qZA(),t.YNc(10,_,3,2,"li",10),t.qZA(),t.qZA()}if(2&e){const n=t.MAs(3),a=t.oxw();t.Q6J("nzDropdownMenu",n),t.xp6(8),t.Q6J("nzTitle",a.taskManager["taskmanager-id"])("nzVisible",a.visible)("nzFooter",null)("nzWidth",800),t.xp6(2),t.Q6J("ngIf",a.taskManager["taskmanager-id"]&&"(unassigned)"!==a.taskManager["taskmanager-id"])}}let nt=(()=>{class e{constructor(n,a,i){this.jobLocalService=n,this.taskManagerService=a,this.cdr=i,this.visible=!1,this.loading=!0,this.logUrl="",this.destroy$=new p.xQ}ngOnInit(){this.jobLocalService.jobDetailChanges().pipe((0,k.q)(1),(0,y.h)(()=>{var n;return!!(null===(n=this.taskManager)||void 0===n?void 0:n["taskmanager-id"])&&"(unassigned)"!==this.taskManager["taskmanager-id"]}),(0,M.zg)(n=>this.taskManagerService.loadHistoryServerTaskManagerLogUrl(n.jid,this.taskManager["taskmanager-id"])),(0,u.R)(this.destroy$)).subscribe(n=>{this.loading=!1,this.logUrl=n,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}setModalVisible(n){this.visible=n,this.cdr.markForCheck()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(J.R),t.Y36(A.k),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["flink-completed-job-taskmanagers-table-action"]],inputs:{taskManager:"taskManager"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["hrefTpl",""],["nz-dropdown","","nzPlacement","bottomRight",3,"nzDropdownMenu"],["nz-icon","","nzType","ellipsis","nzTheme","outline"],["menu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item",""],[3,"click"],[3,"nzTitle","nzVisible","nzFooter","nzWidth","nzVisibleChange","nzOnCancel"],[4,"nzModalContent"],["nz-menu-item","",3,"nzDisabled",4,"ngIf"],[3,"aggregated"],["nz-menu-item","",3,"nzDisabled"],["target","_blank",3,"href"]],template:function(n,a){if(1&n&&(t.YNc(0,K,2,0,"span",0),t.YNc(1,tt,11,6,"ng-template",null,1,t.W1O)),2&n){const i=t.MAs(2);t.Q6J("ngIf",!a.taskManager)("ngIfElse",i)}},directives:[d.O5,r.Ws,r.cm,f.Ls,r.RR,c.wO,c.r9,v.du,v.Hf,X.B],styles:[""],changeDetection:0}),e})();const et=e=>({customComponents:e.configuration.features["web-history"]?Object.assign(Object.assign({},h.C.customComponents),{subtaskActionComponent:P,taskManagerActionComponent:nt}):h.C.customComponents}),ot=e=>({routerTabs:e.configuration.features["web-history"]?[{title:"Overview",path:"overview"},{title:"Exceptions",path:"exceptions"},{title:"TimeLine",path:"timeline"},{title:"Checkpoints",path:"checkpoints"},{title:"Job Configuration",path:"configuration"},{title:"Cluster Configuration",path:"cluster_configuration"}]:b.f.routerTabs});let at=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[{provide:h.s,useFactory:et,deps:[m.B]},{provide:b.l,useFactory:ot,deps:[m.B]}],imports:[[d.ez,Y,E.G,f.PV,$.H0,H.L,L.vh,N.HQ,V.Xo,B.YS,r.b1,v.Qp,G.we]]}),e})()}}]);