"use strict";(self.webpackChunkflink=self.webpackChunkflink||[]).push([[61],{90061:($t,O,a)=>{a.r(O),a.d(O,{SubmitModule:()=>Bt});var h=a(69808),u=a(93075),B=a(90342),b=a(76042),N=a(77484),Z=a(16114),A=a(34147),x=a(64546),C=a(70647),y=a(70655),t=a(5e3),v=a(8929),$=a(36787),Q=a(92198),m=a(7625),U=a(1059),Y=a(87545),M=a(61709),w=a(24850),S=a(31721),T=a(50226),G=a(15664),P=a(969),L=a(70925);const j=["nz-input-group-slot",""];function E(e,o){if(1&e&&t._UZ(0,"i",2),2&e){const n=t.oxw();t.Q6J("nzType",n.icon)}}function k(e,o){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Oqu(n.template)}}function q(e,o){if(1&e&&t._UZ(0,"span",7),2&e){const n=t.oxw(2);t.Q6J("icon",n.nzAddOnBeforeIcon)("template",n.nzAddOnBefore)}}function V(e,o){}function W(e,o){if(1&e&&(t.TgZ(0,"span",8),t.YNc(1,V,0,0,"ng-template",9),t.qZA()),2&e){const n=t.oxw(2),i=t.MAs(4);t.ekj("ant-input-affix-wrapper-disabled",n.disabled)("ant-input-affix-wrapper-sm",n.isSmall)("ant-input-affix-wrapper-lg",n.isLarge),t.xp6(1),t.Q6J("ngTemplateOutlet",i)}}function X(e,o){if(1&e&&t._UZ(0,"span",7),2&e){const n=t.oxw(2);t.Q6J("icon",n.nzAddOnAfterIcon)("template",n.nzAddOnAfter)}}function K(e,o){if(1&e&&(t.TgZ(0,"span",4),t.YNc(1,q,1,2,"span",5),t.YNc(2,W,2,7,"span",6),t.YNc(3,X,1,2,"span",5),t.qZA()),2&e){const n=t.oxw(),i=t.MAs(6);t.xp6(1),t.Q6J("ngIf",n.nzAddOnBefore||n.nzAddOnBeforeIcon),t.xp6(1),t.Q6J("ngIf",n.isAffix)("ngIfElse",i),t.xp6(1),t.Q6J("ngIf",n.nzAddOnAfter||n.nzAddOnAfterIcon)}}function tt(e,o){}function nt(e,o){if(1&e&&t.YNc(0,tt,0,0,"ng-template",9),2&e){t.oxw(2);const n=t.MAs(4);t.Q6J("ngTemplateOutlet",n)}}function et(e,o){if(1&e&&t.YNc(0,nt,1,1,"ng-template",10),2&e){const n=t.oxw(),i=t.MAs(6);t.Q6J("ngIf",n.isAffix)("ngIfElse",i)}}function it(e,o){if(1&e&&t._UZ(0,"span",13),2&e){const n=t.oxw(2);t.Q6J("icon",n.nzPrefixIcon)("template",n.nzPrefix)}}function ot(e,o){}function rt(e,o){if(1&e&&t._UZ(0,"span",14),2&e){const n=t.oxw(2);t.Q6J("icon",n.nzSuffixIcon)("template",n.nzSuffix)}}function at(e,o){if(1&e&&(t.YNc(0,it,1,2,"span",11),t.YNc(1,ot,0,0,"ng-template",9),t.YNc(2,rt,1,2,"span",12)),2&e){const n=t.oxw(),i=t.MAs(6);t.Q6J("ngIf",n.nzPrefix||n.nzPrefixIcon),t.xp6(1),t.Q6J("ngTemplateOutlet",i),t.xp6(1),t.Q6J("ngIf",n.nzSuffix||n.nzSuffixIcon)}}function st(e,o){1&e&&t.Hsn(0)}const lt=["*"];let J=(()=>{class e{constructor(n,i,r,s){this.ngControl=n,this.directionality=s,this.nzBorderless=!1,this.nzSize="default",this._disabled=!1,this.disabled$=new v.xQ,this.dir="ltr",this.destroy$=new v.xQ,i.addClass(r.nativeElement,"ant-input")}get disabled(){return this.ngControl&&null!==this.ngControl.disabled?this.ngControl.disabled:this._disabled}set disabled(n){this._disabled=null!=n&&"false"!=`${n}`}ngOnInit(){var n,i;this.ngControl&&(null===(n=this.ngControl.statusChanges)||void 0===n||n.pipe((0,Q.h)(()=>null!==this.ngControl.disabled),(0,m.R)(this.destroy$)).subscribe(()=>{this.disabled$.next(this.ngControl.disabled)})),this.dir=this.directionality.value,null===(i=this.directionality.change)||void 0===i||i.pipe((0,m.R)(this.destroy$)).subscribe(r=>{this.dir=r})}ngOnChanges(n){const{disabled:i}=n;i&&this.disabled$.next(this.disabled)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.a5,10),t.Y36(t.Qsj),t.Y36(t.SBq),t.Y36(T.Is,8))},e.\u0275dir=t.lG2({type:e,selectors:[["input","nz-input",""],["textarea","nz-input",""]],hostVars:11,hostBindings:function(n,i){2&n&&(t.uIk("disabled",i.disabled||null),t.ekj("ant-input-disabled",i.disabled)("ant-input-borderless",i.nzBorderless)("ant-input-lg","large"===i.nzSize)("ant-input-sm","small"===i.nzSize)("ant-input-rtl","rtl"===i.dir))},inputs:{nzBorderless:"nzBorderless",nzSize:"nzSize",disabled:"disabled"},exportAs:["nzInput"],features:[t.TTD]}),(0,y.gn)([(0,S.yF)()],e.prototype,"nzBorderless",void 0),e})(),pt=(()=>{class e{constructor(){this.icon=null,this.type=null,this.template=null}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["","nz-input-group-slot",""]],hostVars:6,hostBindings:function(n,i){2&n&&t.ekj("ant-input-group-addon","addon"===i.type)("ant-input-prefix","prefix"===i.type)("ant-input-suffix","suffix"===i.type)},inputs:{icon:"icon",type:"type",template:"template"},attrs:j,decls:2,vars:2,consts:[["nz-icon","",3,"nzType",4,"ngIf"],[4,"nzStringTemplateOutlet"],["nz-icon","",3,"nzType"]],template:function(n,i){1&n&&(t.YNc(0,E,1,1,"i",0),t.YNc(1,k,2,1,"ng-container",1)),2&n&&(t.Q6J("ngIf",i.icon),t.xp6(1),t.Q6J("nzStringTemplateOutlet",i.template))},directives:[h.O5,C.Ls,P.f],encapsulation:2,changeDetection:0}),e})(),ct=(()=>{class e{constructor(n){this.elementRef=n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(t.SBq))},e.\u0275dir=t.lG2({type:e,selectors:[["nz-input-group","nzSuffix",""],["nz-input-group","nzPrefix",""]]}),e})(),ut=(()=>{class e{constructor(n,i,r,s){this.focusMonitor=n,this.elementRef=i,this.cdr=r,this.directionality=s,this.nzAddOnBeforeIcon=null,this.nzAddOnAfterIcon=null,this.nzPrefixIcon=null,this.nzSuffixIcon=null,this.nzSize="default",this.nzSearch=!1,this.nzCompact=!1,this.isLarge=!1,this.isSmall=!1,this.isAffix=!1,this.isAddOn=!1,this.focused=!1,this.disabled=!1,this.dir="ltr",this.destroy$=new v.xQ}updateChildrenInputSize(){this.listOfNzInputDirective&&this.listOfNzInputDirective.forEach(n=>n.nzSize=this.nzSize)}ngOnInit(){var n;this.focusMonitor.monitor(this.elementRef,!0).pipe((0,m.R)(this.destroy$)).subscribe(i=>{this.focused=!!i,this.cdr.markForCheck()}),this.dir=this.directionality.value,null===(n=this.directionality.change)||void 0===n||n.pipe((0,m.R)(this.destroy$)).subscribe(i=>{this.dir=i})}ngAfterContentInit(){this.updateChildrenInputSize();const n=this.listOfNzInputDirective.changes.pipe((0,U.O)(this.listOfNzInputDirective));n.pipe((0,Y.w)(i=>(0,$.T)(n,...i.map(r=>r.disabled$))),(0,M.zg)(()=>n),(0,w.U)(i=>i.some(r=>r.disabled)),(0,m.R)(this.destroy$)).subscribe(i=>{this.disabled=i,this.cdr.markForCheck()})}ngOnChanges(n){const{nzSize:i,nzSuffix:r,nzPrefix:s,nzPrefixIcon:l,nzSuffixIcon:c,nzAddOnAfter:f,nzAddOnBefore:p,nzAddOnAfterIcon:g,nzAddOnBeforeIcon:_}=n;i&&(this.updateChildrenInputSize(),this.isLarge="large"===this.nzSize,this.isSmall="small"===this.nzSize),(r||s||l||c)&&(this.isAffix=!!(this.nzSuffix||this.nzPrefix||this.nzPrefixIcon||this.nzSuffixIcon)),(f||p||g||_)&&(this.isAddOn=!!(this.nzAddOnAfter||this.nzAddOnBefore||this.nzAddOnAfterIcon||this.nzAddOnBeforeIcon))}ngOnDestroy(){this.focusMonitor.stopMonitoring(this.elementRef),this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(G.tE),t.Y36(t.SBq),t.Y36(t.sBO),t.Y36(T.Is,8))},e.\u0275cmp=t.Xpm({type:e,selectors:[["nz-input-group"]],contentQueries:function(n,i,r){if(1&n&&t.Suo(r,J,4),2&n){let s;t.iGM(s=t.CRH())&&(i.listOfNzInputDirective=s)}},hostVars:40,hostBindings:function(n,i){2&n&&t.ekj("ant-input-group-compact",i.nzCompact)("ant-input-search-enter-button",i.nzSearch)("ant-input-search",i.nzSearch)("ant-input-search-rtl","rtl"===i.dir)("ant-input-search-sm",i.nzSearch&&i.isSmall)("ant-input-search-large",i.nzSearch&&i.isLarge)("ant-input-group-wrapper",i.isAddOn)("ant-input-group-wrapper-rtl","rtl"===i.dir)("ant-input-group-wrapper-lg",i.isAddOn&&i.isLarge)("ant-input-group-wrapper-sm",i.isAddOn&&i.isSmall)("ant-input-affix-wrapper",i.isAffix&&!i.isAddOn)("ant-input-affix-wrapper-rtl","rtl"===i.dir)("ant-input-affix-wrapper-focused",i.isAffix&&i.focused)("ant-input-affix-wrapper-disabled",i.isAffix&&i.disabled)("ant-input-affix-wrapper-lg",i.isAffix&&!i.isAddOn&&i.isLarge)("ant-input-affix-wrapper-sm",i.isAffix&&!i.isAddOn&&i.isSmall)("ant-input-group",!i.isAffix&&!i.isAddOn)("ant-input-group-rtl","rtl"===i.dir)("ant-input-group-lg",!i.isAffix&&!i.isAddOn&&i.isLarge)("ant-input-group-sm",!i.isAffix&&!i.isAddOn&&i.isSmall)},inputs:{nzAddOnBeforeIcon:"nzAddOnBeforeIcon",nzAddOnAfterIcon:"nzAddOnAfterIcon",nzPrefixIcon:"nzPrefixIcon",nzSuffixIcon:"nzSuffixIcon",nzAddOnBefore:"nzAddOnBefore",nzAddOnAfter:"nzAddOnAfter",nzPrefix:"nzPrefix",nzSuffix:"nzSuffix",nzSize:"nzSize",nzSearch:"nzSearch",nzCompact:"nzCompact"},exportAs:["nzInputGroup"],features:[t.TTD],ngContentSelectors:lt,decls:7,vars:2,consts:[["class","ant-input-wrapper ant-input-group",4,"ngIf","ngIfElse"],["noAddOnTemplate",""],["affixTemplate",""],["contentTemplate",""],[1,"ant-input-wrapper","ant-input-group"],["nz-input-group-slot","","type","addon",3,"icon","template",4,"ngIf"],["class","ant-input-affix-wrapper",3,"ant-input-affix-wrapper-disabled","ant-input-affix-wrapper-sm","ant-input-affix-wrapper-lg",4,"ngIf","ngIfElse"],["nz-input-group-slot","","type","addon",3,"icon","template"],[1,"ant-input-affix-wrapper"],[3,"ngTemplateOutlet"],[3,"ngIf","ngIfElse"],["nz-input-group-slot","","type","prefix",3,"icon","template",4,"ngIf"],["nz-input-group-slot","","type","suffix",3,"icon","template",4,"ngIf"],["nz-input-group-slot","","type","prefix",3,"icon","template"],["nz-input-group-slot","","type","suffix",3,"icon","template"]],template:function(n,i){if(1&n&&(t.F$t(),t.YNc(0,K,4,4,"span",0),t.YNc(1,et,1,2,"ng-template",null,1,t.W1O),t.YNc(3,at,3,3,"ng-template",null,2,t.W1O),t.YNc(5,st,1,0,"ng-template",null,3,t.W1O)),2&n){const r=t.MAs(2);t.Q6J("ngIf",i.isAddOn)("ngIfElse",r)}},directives:[pt,h.O5,h.tP],encapsulation:2,changeDetection:0}),(0,y.gn)([(0,S.yF)()],e.prototype,"nzSearch",void 0),(0,y.gn)([(0,S.yF)()],e.prototype,"nzCompact",void 0),e})(),dt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[T.vT,h.ez,C.PV,L.ud,P.T]]}),e})();var D=a(49841),F=a(24342),d=a(70592),I=a(30325),z=a(40520),H=a(97910),ft=a(21086),gt=a(27221),ht=a(70946);let mt=(()=>{class e{constructor(n,i){this.httpClient=n,this.configService=i}loadJarList(){return this.httpClient.get(`${this.configService.BASE_URL}/jars`).pipe((0,gt.K)(()=>(0,ft.of)({address:"",error:!0,files:[]})))}uploadJar(n){const i=new FormData;i.append("jarfile",n,n.name);const r=new z.aW("POST",`${this.configService.BASE_URL}/jars/upload`,i,{reportProgress:!0});return this.httpClient.request(r)}deleteJar(n){return this.httpClient.delete(`${this.configService.BASE_URL}/jars/${n}`)}runJob(n,i,r,s,l,c){const f={entryClass:i,parallelism:r,programArgs:s,savepointPath:l,allowNonRestoredState:c};let p=new z.LE;return i&&(p=p.append("entry-class",i)),r&&(p=p.append("parallelism",r)),s&&(p=p.append("program-args",s)),l&&(p=p.append("savepointPath",s)),c&&(p=p.append("allowNonRestoredState",c)),this.httpClient.post(`${this.configService.BASE_URL}/jars/${n}/run`,f,{params:p})}getPlan(n,i,r,s){let l=new z.LE;return i&&(l=l.append("entry-class",i)),r&&(l=l.append("parallelism",r)),s&&(l=l.append("program-args",s)),this.httpClient.get(`${this.configService.BASE_URL}/jars/${n}/plan`,{params:l}).pipe((0,w.U)(c=>{const f=[];let p=[];return c.plan.nodes.length&&(p=c.plan.nodes.map(g=>Object.assign(Object.assign({},g),{detail:void 0})),p.forEach(g=>{g.inputs&&g.inputs.length&&g.inputs.forEach(_=>{f.push(Object.assign(Object.assign({},_),{source:_.id,target:g.id,id:`${_.id}-${g.id}`}))})})),{nodes:p,links:f}}))}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(z.eN),t.LFG(ht.E))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var zt=a(22679),R=a(41894),_t=a(82683),xt=a(92643);let Ct=(()=>{class e{constructor(){this.fileRead=new t.vpe}onChange(n){this.fileRead.emit(n.target.files[0])}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=t.lG2({type:e,selectors:[["","flinkFileRead",""]],hostBindings:function(n,i){1&n&&t.NdJ("change",function(s){return i.onChange(s)})},outputs:{fileRead:"fileRead"}}),e})();function vt(e,o){if(1&e&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&e){const n=o.$implicit;t.xp6(1),t.hij(" ",n.name," ")}}function At(e,o){1&e&&(t.TgZ(0,"div"),t._uU(1,"-"),t.qZA())}function yt(e,o){1&e&&t._UZ(0,"i",26)}function St(e,o){1&e&&t._UZ(0,"i",27)}function Tt(e,o){1&e&&t._UZ(0,"i",28)}function It(e,o){1&e&&t._UZ(0,"i",29)}function Ot(e,o){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"tr",7),t.NdJ("click",function(){const s=t.CHM(n).$implicit;return t.oxw(2).expandJar(s)}),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"td"),t.YNc(8,vt,2,1,"div",8),t.YNc(9,At,2,0,"div",1),t.qZA(),t.TgZ(10,"td",9),t.TgZ(11,"a",10),t.NdJ("click",function(r){return r.stopPropagation()})("nzOnConfirm",function(){const s=t.CHM(n).$implicit;return t.oxw(2).deleteJar(s)}),t._uU(12," Delete "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"tr",11),t.TgZ(14,"td",12),t.TgZ(15,"form",13),t.TgZ(16,"nz-form-item"),t.TgZ(17,"nz-form-control"),t.TgZ(18,"nz-input-group",14),t._UZ(19,"input",15),t.qZA(),t.YNc(20,yt,1,0,"ng-template",null,16,t.W1O),t.qZA(),t.qZA(),t.TgZ(22,"nz-form-item"),t.TgZ(23,"nz-form-control"),t.TgZ(24,"nz-input-group",14),t._UZ(25,"input",17),t.qZA(),t.YNc(26,St,1,0,"ng-template",null,18,t.W1O),t.qZA(),t.qZA(),t.TgZ(28,"nz-form-item"),t.TgZ(29,"nz-form-control"),t.TgZ(30,"nz-input-group",14),t._UZ(31,"input",19),t.qZA(),t.YNc(32,Tt,1,0,"ng-template",null,20,t.W1O),t.qZA(),t.qZA(),t.TgZ(34,"nz-form-item"),t.TgZ(35,"nz-form-control"),t.TgZ(36,"nz-input-group",14),t._UZ(37,"input",21),t.qZA(),t.YNc(38,It,1,0,"ng-template",null,22,t.W1O),t.qZA(),t.qZA(),t.TgZ(40,"nz-form-item"),t.TgZ(41,"nz-form-control"),t.TgZ(42,"label",23),t._uU(43," Allow Non Restored State "),t.qZA(),t.qZA(),t.qZA(),t.TgZ(44,"nz-form-item"),t.TgZ(45,"nz-form-control"),t.TgZ(46,"button",24),t.NdJ("click",function(){const s=t.CHM(n).$implicit;return t.oxw(2).showPlan(s)}),t._uU(47,"Show Plan"),t.qZA(),t.TgZ(48,"button",25),t.NdJ("click",function(){const s=t.CHM(n).$implicit;return t.oxw(2).submitJob(s)}),t._uU(49,"Submit"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&e){const n=o.$implicit,i=t.MAs(21),r=t.MAs(27),s=t.MAs(33),l=t.MAs(39),c=t.oxw(2);t.xp6(3),t.Oqu(n.name),t.xp6(2),t.Oqu(t.xi3(6,11,n.uploaded,"yyyy-MM-dd, HH:mm:ss")),t.xp6(3),t.Q6J("ngForOf",n.entry),t.xp6(1),t.Q6J("ngIf",0===n.entry.length),t.xp6(4),t.Q6J("nzExpand",c.expandedMap.get(n.id)),t.xp6(2),t.Q6J("nzLayout","inline")("formGroup",c.validateForm),t.xp6(3),t.Q6J("nzPrefix",i),t.xp6(6),t.Q6J("nzPrefix",r),t.xp6(6),t.Q6J("nzPrefix",s),t.xp6(6),t.Q6J("nzPrefix",l)}}function bt(e,o){if(1&e&&(t.ynx(0),t.TgZ(1,"nz-table",5),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t.TgZ(4,"th"),t._uU(5,"Name"),t.qZA(),t.TgZ(6,"th"),t._uU(7,"Upload Time"),t.qZA(),t.TgZ(8,"th"),t._uU(9,"Entry Class"),t.qZA(),t._UZ(10,"th"),t.qZA(),t.qZA(),t.TgZ(11,"tbody"),t.YNc(12,Ot,50,14,"ng-container",6),t.qZA(),t.qZA(),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("nzSize","small")("nzData",n.listOfJar)("nzFrontPagination",!1)("nzShowPagination",!1)("nzBordered",!1),t.xp6(11),t.Q6J("ngForOf",n.listOfJar)("ngForTrackBy",n.trackById)}}function Nt(e,o){1&e&&(t.TgZ(0,"span"),t._uU(1," Yarn's AM proxy doesn't allow file uploads. Please wait while we fetch an alternate url for you to use "),t.qZA())}function Zt(e,o){if(1&e&&(t.TgZ(0,"span"),t._uU(1," Yarn's AM proxy doesn't allow file uploads. You can visit\xa0 "),t.TgZ(2,"a"),t._uU(3,"here"),t.qZA(),t._uU(4," \xa0to access this functionality. "),t.qZA()),2&e){const n=t.oxw(2);t.xp6(2),t.uIk("href",n.address+"/#/submit",t.LSH)}}function Mt(e,o){if(1&e&&(t.ynx(0),t.YNc(1,Nt,2,0,"span",1),t.YNc(2,Zt,5,1,"span",1),t.BQk()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",!n.address),t.xp6(1),t.Q6J("ngIf",n.address)}}function wt(e,o){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"input",33),t.NdJ("fileRead",function(r){return t.CHM(n),t.oxw(3).uploadJar(r)}),t.qZA(),t.TgZ(2,"label",34),t.TgZ(3,"span"),t._UZ(4,"i",35),t._uU(5," Add New "),t.qZA(),t.qZA(),t.BQk()}}function Pt(e,o){if(1&e&&t._UZ(0,"nz-progress",36),2&e){const n=t.oxw(3);t.Q6J("nzPercent",n.progress)("nzShowInfo",!1)}}function Jt(e,o){if(1&e&&(t.TgZ(0,"div",31),t.YNc(1,wt,6,0,"ng-container",1),t.YNc(2,Pt,1,2,"nz-progress",32),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!n.isUploading),t.xp6(1),t.Q6J("ngIf",n.isUploading)}}function Dt(e,o){if(1&e&&t.YNc(0,Jt,3,2,"div",30),2&e){const n=t.oxw();t.Q6J("ngIf",!n.noAccess&&!n.isYarn)}}function Ft(e,o){1&e&&(t.ynx(0),t._UZ(1,"flink-dagre"),t.BQk())}const Ht=[{path:"",component:(()=>{class e{constructor(n,i,r,s,l){this.jarService=n,this.statusService=i,this.fb=r,this.router=s,this.cdr=l,this.trackById=(c,f)=>f.id,this.expandedMap=new Map,this.isLoading=!0,this.listOfJar=[],this.isYarn=!1,this.noAccess=!1,this.isUploading=!1,this.progress=0,this.planVisible=!1,this.destroy$=new v.xQ}ngOnInit(){this.isYarn=-1!==window.location.href.indexOf("/proxy/application_"),this.validateForm=this.fb.group({entryClass:[null],parallelism:[null],programArgs:[null],savepointPath:[null],allowNonRestoredState:[null]}),this.statusService.refresh$.pipe((0,m.R)(this.destroy$),(0,M.zg)(()=>this.jarService.loadJarList())).subscribe(n=>{this.isLoading=!1,this.listOfJar=n.files,this.address=n.address,this.cdr.markForCheck(),this.noAccess=Boolean(n.error)},()=>{this.isLoading=!1,this.noAccess=!0,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}uploadJar(n){this.jarService.uploadJar(n).subscribe(i=>{i.type===z.dt.UploadProgress&&i.total?(this.isUploading=!0,this.progress=Math.round(100*i.loaded/i.total)):i.type===z.dt.Response&&(this.isUploading=!1,this.statusService.forceRefresh())},()=>{this.isUploading=!1,this.progress=0})}deleteJar(n){this.jarService.deleteJar(n.id).subscribe(()=>{this.statusService.forceRefresh(),this.expandedMap.set(n.id,!1)})}expandJar(n){this.expandedMap.get(n.id)?this.expandedMap.set(n.id,!1):(this.expandedMap.forEach((i,r)=>{this.expandedMap.set(r,!1),this.validateForm.reset()}),this.expandedMap.set(n.id,!0)),n.entry&&n.entry[0]&&n.entry[0].name?this.validateForm.get("entryClass").setValue(n.entry[0].name):this.validateForm.get("entryClass").setValue(null)}showPlan(n){this.jarService.getPlan(n.id,this.validateForm.get("entryClass").value,this.validateForm.get("parallelism").value,this.validateForm.get("programArgs").value).subscribe(i=>{this.planVisible=!0,this.dagreComponent.flush(i.nodes,i.links,!0)})}hidePlan(){this.planVisible=!1}submitJob(n){this.jarService.runJob(n.id,this.validateForm.get("entryClass").value,this.validateForm.get("parallelism").value,this.validateForm.get("programArgs").value,this.validateForm.get("savepointPath").value,this.validateForm.get("allowNonRestoredState").value).subscribe(i=>{this.router.navigate(["job","running",i.jobid]).then()})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(mt),t.Y36(zt.B),t.Y36(u.qu),t.Y36(I.F0),t.Y36(t.sBO))},e.\u0275cmp=t.Xpm({type:e,selectors:[["flink-submit"]],viewQuery:function(n,i){if(1&n&&t.Gf(H.B,7),2&n){let r;t.iGM(r=t.CRH())&&(i.dagreComponent=r.first)}},decls:7,vars:10,consts:[[3,"nzBordered","nzTitle","nzLoading","nzExtra"],[4,"ngIf"],["extraTemplate",""],[3,"nzHeight","nzVisible","nzPlacement","nzTitle","nzOnClose"],[4,"nzDrawerContent"],[3,"nzSize","nzData","nzFrontPagination","nzShowPagination","nzBordered"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"clickable",3,"click"],[4,"ngFor","ngForOf"],[1,"delete-jar"],["nz-popconfirm","","nzPopconfirmTitle","Are you sure delete this jar?",3,"click","nzOnConfirm"],[3,"nzExpand"],["colspan","4"],["nz-form","",3,"nzLayout","formGroup"],[3,"nzPrefix"],["formControlName","entryClass","nz-input","","placeholder","Entry Class"],["apiTemplate",""],["formControlName","parallelism","nz-input","","placeholder","Parallelism"],["loginTemplate",""],["formControlName","programArgs","nz-input","","placeholder","Program Arguments"],["settingTemplate",""],["formControlName","savepointPath","nz-input","","placeholder","Savepoint Path"],["folderTemplate",""],["nz-checkbox","","formControlName","allowNonRestoredState"],["nz-button","",3,"click"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","deployment-unit","nzTheme","outline"],["nz-icon","","nzType","login"],["nz-icon","","nzType","setting"],["nz-icon","","nzType","folder"],["class","extra",4,"ngIf"],[1,"extra"],["nzSize","small",3,"nzPercent","nzShowInfo",4,"ngIf"],["flinkFileRead","","type","file","id","upload-file",1,"input-file",3,"fileRead"],["for","upload-file",1,"upload","ant-btn-primary","ant-btn","ant-btn-sm"],["nz-icon","","nzType","plus"],["nzSize","small",3,"nzPercent","nzShowInfo"]],template:function(n,i){if(1&n&&(t.TgZ(0,"nz-card",0),t.YNc(1,bt,13,7,"ng-container",1),t.YNc(2,Mt,3,2,"ng-container",1),t.qZA(),t.YNc(3,Dt,1,1,"ng-template",null,2,t.W1O),t.TgZ(5,"nz-drawer",3),t.NdJ("nzOnClose",function(){return i.hidePlan()}),t.YNc(6,Ft,2,0,"ng-container",4),t.qZA()),2&n){const r=t.MAs(4);t.Q6J("nzBordered",!1)("nzTitle","Uploaded Jars")("nzLoading",i.isLoading)("nzExtra",r),t.xp6(1),t.Q6J("ngIf",!i.isYarn),t.xp6(1),t.Q6J("ngIf",!i.noAccess&&i.isYarn),t.xp6(3),t.Q6J("nzHeight","100%")("nzVisible",i.planVisible)("nzPlacement","bottom")("nzTitle","Plan Visualization")}},directives:[N.bd,h.O5,d.N8,d.Om,d.$Z,d.Uo,d._C,d.p0,h.sg,D.JW,d.d3,d.Vk,u._Y,u.JL,x.Lr,u.sg,R.SK,x.Nx,R.t3,x.Fd,ut,_t.w,ct,u.Fj,J,u.JJ,u.u,C.Ls,Z.Ie,b.ix,xt.dQ,Ct,F.M,A.Vz,A.SQ,H.B],pipes:[h.uU],styles:[".input-file[_ngcontent-%COMP%]{position:absolute;z-index:-1;overflow:hidden;width:.1px;height:.1px;opacity:0}.extra[_ngcontent-%COMP%]{position:absolute;top:18px;right:24px}.extra[_ngcontent-%COMP%]   nz-progress[_ngcontent-%COMP%]{display:block;width:150px}.extra[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]{vertical-align:middle}.extra[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;line-height:22px}.extra[_ngcontent-%COMP%]   .upload[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:6px}flink-dagre[_ngcontent-%COMP%]{position:absolute;top:60px;right:0;bottom:0;left:0}  .ant-form-inline .ant-form-item{margin-bottom:8px}nz-form-item[_ngcontent-%COMP%]{width:calc(50% - 16px)}nz-form-item[_ngcontent-%COMP%]   nz-form-control[_ngcontent-%COMP%]{width:100%}nz-form-item[_ngcontent-%COMP%]   nz-form-control[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-right:12px}.delete-jar[_ngcontent-%COMP%]{word-break:keep-all}"],changeDetection:0}),e})()}];let Rt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[I.Bz.forChild(Ht)],I.Bz]}),e})(),Bt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[h.ez,u.UX,Rt,B.G,d.HQ,D._p,x.U5,N.vh,dt,F.W,A.BL,C.PV,b.sL,Z.Wr]]}),e})()}}]);