(self.webpackChunkflink=self.webpackChunkflink||[]).push([[80],{78080:(Nn,j,O)=>{"use strict";O.r(j),O.d(j,{JobOverviewModule:()=>h});var B=O(69808),dt=O(93075),Jn=O(90342),cn=O(22359),Se=O(55737),Ne=O(63677),Dn=O(64546),F=O(70647),G=O(63640),L=O(23868),X=O(78054),K=O(17525),D=O(70592),H=O(90868),vt=O(16695),at=O(30325),rt=O(8929),se=O(21086),jt=O(61709),Ut=O(27221),it=O(7625),wt=O(73925),t=O(5e3),Je=O(22423),Jt=O(88098);function oi(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"number"),t.qZA(),t.qZA(),t.BQk()),2&n){const r=s.ngIf;t.xp6(3),t.Oqu(r.name),t.xp6(2),t.Oqu(r.type),t.xp6(2),t.Oqu(t.xi3(8,3,r.value,"1.0-3")||r.value)}}function ai(n,s){if(1&n&&t.YNc(0,oi,9,6,"ng-container",9),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowUserAccumulators(r))}}function si(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",10),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.qZA(),t.TgZ(8,"td",11),t._uU(9),t.qZA(),t.qZA(),t.BQk()),2&n){const r=s.ngIf;t.xp6(3),t.lnq(" (",r.subtask,") ",r.host,", attempt: ",r.attempt+1," "),t.xp6(2),t.Oqu(r.name),t.xp6(2),t.Oqu(r.type),t.xp6(2),t.Oqu(r.value)}}function li(n,s){if(1&n&&t.YNc(0,si,10,6,"ng-container",9),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowSubTaskAccumulators(r))}}const fr=function(){return{y:"100%"}};let ci=(()=>{class n{constructor(r,a,f){this.jobService=r,this.jobLocalService=a,this.cdr=f,this.trackByName=(d,_)=>_.name,this.listOfAccumulator=[],this.listOfSubTaskAccumulator=[],this.isLoading=!0,this.virtualItemSize=36,this.narrowUserAccumulators=(0,wt.t)(),this.narrowSubTaskAccumulators=(0,wt.t)(),this.destroy$=new rt.xQ}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,jt.zg)(r=>this.jobService.loadAccumulators(r.job.jid,r.vertex.id).pipe((0,Ut.K)(()=>(0,se.of)({main:[],subtasks:[]})))),(0,it.R)(this.destroy$)).subscribe(r=>{this.isLoading=!1,this.listOfAccumulator=r.main,this.listOfSubTaskAccumulator=this.transformToSubTaskAccumulator(r.subtasks)||[],this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}transformToSubTaskAccumulator(r){const a=[];return r.forEach(f=>{f["user-accumulators"].forEach(d=>{a.push(Object.assign(Object.assign({},f),{name:d.name,type:d.type,value:d.value}))})}),a}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Je.O),t.Y36(Jt.R),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-accumulators"]],decls:27,vars:22,consts:[[3,"nzTabBarGutter","nzSize"],["nzTitle","Vertex Accumulators"],["nzSize","small",3,"nzLoading","nzData","nzScroll","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMinBufferPx","nzVirtualMaxBufferPx","nzVirtualForTrackBy"],["nzWidth","33.33%"],["nz-virtual-scroll",""],["nzTitle","SubTask Accumulators"],["nzWidth","25%","nzLeft",""],["nzWidth","25%"],["nzWidth","25%","nzRight",""],[4,"ngIf"],["nzLeft",""],["nzRight",""]],template:function(r,a){1&r&&(t.TgZ(0,"nz-tabset",0),t.TgZ(1,"nz-tab",1),t.TgZ(2,"nz-table",2),t.TgZ(3,"thead"),t.TgZ(4,"tr"),t.TgZ(5,"th",3),t._uU(6,"Name"),t.qZA(),t.TgZ(7,"th",3),t._uU(8,"Type"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Value"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"tbody"),t.YNc(12,ai,1,1,"ng-template",4),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"nz-tab",5),t.TgZ(14,"nz-table",2),t.TgZ(15,"thead"),t.TgZ(16,"tr"),t.TgZ(17,"th",6),t._uU(18,"SubTask"),t.qZA(),t.TgZ(19,"th",7),t._uU(20,"Name"),t.qZA(),t.TgZ(21,"th",7),t._uU(22,"Type"),t.qZA(),t.TgZ(23,"th",8),t._uU(24,"Value"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"tbody"),t.YNc(26,li,1,1,"ng-template",4),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r&&(t.Q6J("nzTabBarGutter",16)("nzSize","small"),t.xp6(2),t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfAccumulator)("nzScroll",t.DdM(20,fr))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",a.virtualItemSize)("nzVirtualMinBufferPx",300)("nzVirtualMaxBufferPx",300)("nzVirtualForTrackBy",a.trackByName),t.xp6(12),t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfSubTaskAccumulator)("nzScroll",t.DdM(21,fr))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",a.virtualItemSize)("nzVirtualMinBufferPx",300)("nzVirtualMaxBufferPx",300)("nzVirtualForTrackBy",a.trackByName))},directives:[H.xH,H.xw,D.N8,D.Om,D.$Z,D.Uo,D._C,D.p0,D.zu,B.O5,D.qn],pipes:[B.JJ],styles:["[_nghost-%COMP%]{position:relative;display:block;height:100%}[_nghost-%COMP%]   nz-tabset[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]     .ant-table-cell{font-size:12px}[_nghost-%COMP%]     .ant-tabs-content{height:100%}[_nghost-%COMP%]     .ant-tabs-content .ant-tabs-tabpane{height:100%}[_nghost-%COMP%]     .ant-tabs-nav{margin-bottom:0}[_nghost-%COMP%]     .ant-tabs-small>.ant-tabs-nav .ant-tabs-tab{font-size:12px}[_nghost-%COMP%]     .ant-tabs-small>.ant-tabs-nav .ant-tabs-tab:first-of-type{margin:0 0 0 16px}[_nghost-%COMP%]     ::-webkit-scrollbar{display:none}[_nghost-%COMP%]     nz-table, [_nghost-%COMP%]     nz-spin, [_nghost-%COMP%]     cdk-virtual-scroll-viewport, [_nghost-%COMP%]     nz-table-inner-scroll, [_nghost-%COMP%]     .ant-spin-container, [_nghost-%COMP%]     .ant-table{height:100%}"],changeDetection:0}),n})();var hr=O(22868),st=O(15126);let pr=(()=>{class n{constructor(r){this.viewContainerRef=r}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(t.s_b))},n.\u0275dir=t.lG2({type:n,selectors:[["","flink-dynamic",""]]}),n})();function ui(n,s){}let un=(()=>{class n{constructor(){this.data={}}ngOnChanges(r){if(r.component){const a=this.host.viewContainerRef;a.clear(),this.componentRef=a.createComponent(this.component)}if(r.data&&this.componentRef){const a=this.componentRef.instance;Object.keys(this.data).forEach(f=>{a[f]=this.data[f]}),this.componentRef.injector.get(t.sBO).markForCheck()}}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-dynamic-host"]],viewQuery:function(r,a){if(1&r&&t.Gf(pr,7),2&r){let f;t.iGM(f=t.CRH())&&(a.host=f.first)}},inputs:{data:"data",component:"component"},features:[t.TTD],decls:1,vars:0,consts:[["flink-dynamic",""]],template:function(r,a){1&r&&t.YNc(0,ui,0,0,"ng-template",0)},directives:[pr],styles:[""],changeDetection:0}),n})();var le=O(53148);function fi(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeDuration"),t.qZA()),2&n){const r=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,r.now-r.backpressure["end-timestamp"])," ago ")}}function hi(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"Sampling in progress..."),t.qZA())}function pi(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1," - "),t.qZA())}const ce=function(n){return{state:n}};function qn(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1," Measurement: "),t.YNc(2,fi,3,3,"span",2),t.YNc(3,hi,2,0,"span",2),t.YNc(4,pi,2,0,"span",2),t._UZ(5,"nz-divider",4),t._uU(6," Back Pressure Status: "),t.TgZ(7,"span"),t._UZ(8,"flink-dynamic-host",5),t.qZA(),t.qZA()),2&n){const r=t.oxw();t.xp6(2),t.Q6J("ngIf",r.backpressure["end-timestamp"]),t.xp6(1),t.Q6J("ngIf","deprecated"===r.backpressure.status),t.xp6(1),t.Q6J("ngIf",!r.backpressure["end-timestamp"]&&"deprecated"!==r.backpressure.status),t.xp6(1),t.Q6J("nzType","vertical"),t.xp6(3),t.Q6J("data",t.VKq(6,ce,r.backpressure["backpressure-level"]))("component",r.stateBadgeComponent)}}function ue(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1," Operator is not running. Cannot sample back pressure. "),t.qZA())}function di(n,s){if(1&n&&(t.TgZ(0,"span",8),t._uU(1),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" [attempt-",r["attempt-number"]+1,"] ")}}function gi(n,s){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" \xa0[attempt-",r["attempt-number"]+1,"] ")}}function mi(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",10),t._uU(3),t.YNc(4,gi,2,1,"ng-container",2),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"flink-dynamic-host",5),t.qZA(),t.qZA(),t.BQk()),2&n){const r=s.$implicit,a=t.oxw(4);t.xp6(2),t.Q6J("nzIndentSize",1),t.xp6(1),t.hij(" ",r.subtask," "),t.xp6(1),t.Q6J("ngIf",void 0!==r["attempt-number"]),t.xp6(2),t.lnq(" ",a.prettyPrint(r.ratio)," / ",a.prettyPrint(r.idleRatio)," / ",a.prettyPrint(r.busyRatio)," "),t.xp6(2),t.Q6J("data",t.VKq(8,ce,r["backpressure-level"]))("component",a.stateBadgeComponent)}}function _i(n,s){if(1&n&&(t.ynx(0),t.YNc(1,mi,9,10,"ng-container",9),t.BQk()),2&n){const r=t.oxw().ngIf,a=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r["other-concurrent-attempts"])("ngForTrackBy",a.trackBySubtaskAttempt)}}function vi(n,s){if(1&n){const r=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",6),t.NdJ("nzExpandChange",function(f){const _=t.CHM(r).ngIf;return t.oxw(2).onExpandChange(_,f)}),t._uU(3),t.YNc(4,di,2,1,"span",7),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td"),t._UZ(8,"flink-dynamic-host",5),t.qZA(),t.qZA(),t.YNc(9,_i,2,2,"ng-container",2),t.BQk()}if(2&n){const r=s.ngIf,a=t.oxw(2);t.xp6(2),t.Q6J("nzShowExpand",(null==r["other-concurrent-attempts"]?null:r["other-concurrent-attempts"].length)>0)("nzExpand",a.expandSet.has(r.subtask)),t.xp6(1),t.hij(" ",r.subtask," "),t.xp6(1),t.Q6J("ngIf",void 0!==r["attempt-number"]),t.xp6(2),t.lnq(" ",a.prettyPrint(r.ratio)," / ",a.prettyPrint(r.idleRatio)," / ",a.prettyPrint(r.busyRatio)," "),t.xp6(2),t.Q6J("data",t.VKq(10,ce,r["backpressure-level"]))("component",a.stateBadgeComponent),t.xp6(1),t.Q6J("ngIf",a.expandSet.has(r.subtask))}}function wi(n,s){if(1&n&&t.YNc(0,vi,10,12,"ng-container",2),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowType(r))}}const yi=function(){return{y:"calc( 100% - 90px )"}},Fn=function(){return["33.33%","33.33%","33.33%"]};let xi=(()=>{class n{constructor(r,a,f,d){var _;this.jobService=r,this.jobLocalService=a,this.cdr=f,this.moduleConfig=d,this.trackBySubtask=(v,x)=>x.subtask,this.trackBySubtaskAttempt=(v,x)=>`${x.subtask}-${x["attempt-number"]}`,this.expandSet=new Set,this.isLoading=!0,this.now=Date.now(),this.backpressure={},this.listOfSubTaskBackpressure=[],this.narrowType=(0,wt.t)(),this.destroy$=new rt.xQ,this.stateBadgeComponent=(null===(_=d.customComponents)||void 0===_?void 0:_.backpressureBadgeComponent)||st.C.customComponents.backpressureBadgeComponent}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,hr.b)(r=>{this.selectedVertex=r.vertex,this.cdr.markForCheck()}),(0,jt.zg)(r=>this.jobService.loadOperatorBackPressure(r.job.jid,r.vertex.id).pipe((0,Ut.K)(()=>(0,se.of)({})))),(0,it.R)(this.destroy$)).subscribe(r=>{this.isLoading=!1,this.now=Date.now(),this.backpressure=r,this.listOfSubTaskBackpressure=(null==r?void 0:r.subtasks)||[],this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}collapseAll(){this.expandSet.clear(),this.cdr.markForCheck()}onExpandChange(r,a){a?this.expandSet.add(r.subtask):this.expandSet.delete(r.subtask),this.cdr.markForCheck()}prettyPrint(r){return isNaN(r)?"N/A":`${Math.round(100*r)}%`}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Je.O),t.Y36(Jt.R),t.Y36(t.sBO),t.Y36(st.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-backpressure"]],decls:15,vars:14,consts:[["nzSize","small",3,"nzLoading","nzData","nzScroll","nzWidthConfig","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMinBufferPx","nzVirtualMaxBufferPx","nzVirtualForTrackBy"],["colspan","3",1,"title"],[4,"ngIf"],["nz-virtual-scroll",""],[3,"nzType"],[3,"data","component"],[3,"nzShowExpand","nzExpand","nzExpandChange"],["class","left-margin",4,"ngIf"],[1,"left-margin"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"nzIndentSize"]],template:function(r,a){1&r&&(t.TgZ(0,"nz-table",0),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th",1),t.YNc(4,qn,9,8,"span",2),t.YNc(5,ue,2,0,"span",2),t.qZA(),t.qZA(),t.TgZ(6,"tr"),t.TgZ(7,"th"),t._uU(8,"SubTask"),t.qZA(),t.TgZ(9,"th"),t._uU(10,"Backpressured / Idle / Busy"),t.qZA(),t.TgZ(11,"th"),t._uU(12,"Backpressure Status"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(13,"tbody"),t.YNc(14,wi,1,1,"ng-template",3),t.qZA(),t.qZA()),2&r&&(t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfSubTaskBackpressure)("nzScroll",t.DdM(12,yi))("nzWidthConfig",t.DdM(13,Fn))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",36)("nzVirtualMinBufferPx",300)("nzVirtualMaxBufferPx",300)("nzVirtualForTrackBy",a.trackBySubtask),t.xp6(4),t.Q6J("ngIf","RUNNING"===(null==a.selectedVertex||null==a.selectedVertex.detail?null:a.selectedVertex.detail.status)),t.xp6(1),t.Q6J("ngIf","RUNNING"!==(null==a.selectedVertex||null==a.selectedVertex.detail?null:a.selectedVertex.detail.status)))},directives:[D.N8,D.Om,D.$Z,D.Uo,D._C,B.O5,Se.g,un,D.p0,D.zu,D.h7,B.sg],pipes:[le.w],styles:["[_nghost-%COMP%]   .left-margin[_ngcontent-%COMP%]{margin-left:4px}[_nghost-%COMP%]     .ant-table-row-indent{padding-left:0!important}[_nghost-%COMP%]     .ant-table-row-indent+.ant-table-row-expand-icon{margin-top:2px}[_nghost-%COMP%]     .ant-table-cell{font-size:12px}[_nghost-%COMP%]     ::-webkit-scrollbar{display:none}[_nghost-%COMP%]     nz-table, [_nghost-%COMP%]     nz-spin, [_nghost-%COMP%]     cdk-virtual-scroll-viewport, [_nghost-%COMP%]     nz-table-inner-scroll, [_nghost-%COMP%]     .ant-spin-container, [_nghost-%COMP%]     .ant-table{height:100%}[_nghost-%COMP%]   flink-backpressure-badge[_ngcontent-%COMP%], [_nghost-%COMP%]   flink-dynamic-host[_ngcontent-%COMP%]{display:inline-block;margin-left:4px}"],changeDetection:0}),n})();var bi=O(75778),dr=O(92198),Ci=O(77027);let yt=(()=>{class n{constructor(){this.resize$=new rt.xQ}resize(){this.resize$.next()}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var gr=O(76042),mr=O(82683),Ti=O(92643),Pn=O(7963),Xt=O(87764);let De=(()=>{class n{transform(r,a){if((0,Pn.k)(r))return"-";let f="";return f=/bytes/i.test(a)&&/persecond/i.test(a)?`${(new Xt.E).transform(r)} / s`:/bytes/i.test(a)?(new Xt.E).transform(r):/persecond/i.test(a)?`${r} / s`:/time/i.test(a)||/latency/i.test(a)?(new le.w).transform(r,!0):`${r}`,f}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275pipe=t.Yjl({name:"humanizeChartNumeric",type:n,pure:!0}),n})();const En=["chart"];let fn=(()=>{class n{constructor(r,a){this.cdr=r,this.jobChartService=a,this.closed=new t.vpe,this.size="small",this.displayMode="chart",this.data=[],this.destroy$=new rt.xQ}get isBig(){return"big"===this.size}refresh(r){this.latestValue=r.values[this.title],"numeric"===this.displayMode&&this.cdr.detectChanges(),this.data.push({time:r.timestamp,value:this.latestValue,type:this.title}),this.data.length>20&&this.data.shift(),this.chartInstance&&this.chartInstance.changeData(this.data)}setMode(r){this.displayMode=r,this.cdr.detectChanges()}resize(r){this.size=r,this.cdr.detectChanges(),setTimeout(()=>this.chartInstance.forceFit())}close(){this.closed.emit(this.title)}ngAfterViewInit(){this.cdr.detach(),this.chartInstance=new Ci.kL({container:this.chart.nativeElement,height:150,autoFit:!0,padding:"auto"}),this.chartInstance.legend(!1),this.chartInstance.data(this.data),this.chartInstance.scale({time:{alias:"Time",type:"time",mask:"HH:mm:ss",tickCount:3},type:{type:"cat"}}),this.chartInstance.line().position("time*value").shape("smooth").color("type").size(2).animate({update:{duration:0}}),this.chartInstance.render(),this.jobChartService.resize$.pipe((0,it.R)(this.destroy$)).subscribe(()=>{this.chartInstance&&setTimeout(()=>{this.chartInstance.forceFit()})})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.chartInstance&&this.chartInstance.destroy()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(t.sBO),t.Y36(yt))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-chart"]],viewQuery:function(r,a){if(1&r&&t.Gf(En,7),2&r){let f;t.iGM(f=t.CRH())&&(a.chart=f.first)}},hostVars:2,hostBindings:function(r,a){2&r&&t.ekj("big",a.isBig)},inputs:{title:"title"},outputs:{closed:"closed"},decls:24,vars:15,consts:[[1,"chart"],[1,"title"],[1,"text"],[1,"operate"],[3,"nzSize"],["nz-button","",3,"nzType","click"],["nz-button","",1,"close",3,"nzSize","click"],["nz-icon","","nzType","close","nzTheme","outline"],[1,"content"],[3,"hidden"],["chart",""],[1,"numeric",3,"hidden"],[1,"type-switch"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"div",3),t.TgZ(5,"nz-button-group",4),t.TgZ(6,"button",5),t.NdJ("click",function(){return a.resize("big")}),t._uU(7," Big "),t.qZA(),t.TgZ(8,"button",5),t.NdJ("click",function(){return a.resize("small")}),t._uU(9," Small "),t.qZA(),t.qZA(),t.TgZ(10,"button",6),t.NdJ("click",function(){return a.close()}),t._UZ(11,"i",7),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",8),t._UZ(13,"div",9,10),t.TgZ(15,"div",11),t._uU(16),t.ALo(17,"humanizeChartNumeric"),t.qZA(),t.TgZ(18,"div",12),t.TgZ(19,"nz-button-group",4),t.TgZ(20,"button",5),t.NdJ("click",function(){return a.setMode("chart")}),t._uU(21," Chart "),t.qZA(),t.TgZ(22,"button",5),t.NdJ("click",function(){return a.setMode("numeric")}),t._uU(23," Numeric "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&r&&(t.xp6(2),t.uIk("title",a.title),t.xp6(1),t.Oqu(a.title),t.xp6(2),t.Q6J("nzSize","small"),t.xp6(1),t.Q6J("nzType","big"===a.size?"primary":"default"),t.xp6(2),t.Q6J("nzType","small"===a.size?"primary":"default"),t.xp6(2),t.Q6J("nzSize","small"),t.xp6(3),t.Q6J("hidden","numeric"===a.displayMode),t.xp6(2),t.Q6J("hidden","chart"===a.displayMode),t.xp6(1),t.hij(" ",t.xi3(17,12,a.latestValue,a.title)," "),t.xp6(3),t.Q6J("nzSize","small"),t.xp6(1),t.Q6J("nzType","chart"===a.displayMode?"primary":"default"),t.xp6(2),t.Q6J("nzType","numeric"===a.displayMode?"primary":"default"))},directives:[gr.fY,mr.w,gr.ix,Ti.dQ,F.Ls],pipes:[De],styles:["[_nghost-%COMP%]{float:left;width:33.33%;margin-bottom:12px;padding:12px}.big[_nghost-%COMP%]{width:100%}.close[_ngcontent-%COMP%]{margin-left:8px}.chart[_ngcontent-%COMP%]{position:relative;border:1px solid #f0f0f0}.title[_ngcontent-%COMP%]{position:relative;padding:12px;border-bottom:1px solid #f0f0f0}.text[_ngcontent-%COMP%]{overflow:hidden;max-width:calc(100% - 128px);font-size:12px;line-height:24px;text-overflow:ellipsis}.operate[_ngcontent-%COMP%]{position:absolute;top:12px;right:12px;display:flex;align-items:center}.content[_ngcontent-%COMP%]{padding:12px}.content[_ngcontent-%COMP%]   .numeric[_ngcontent-%COMP%]{font-size:32px;line-height:150px;text-align:center}button[_ngcontent-%COMP%]{transition:none}"],changeDetection:0}),n})();var xt=O(24850),Ai=O(40520),_r=O(70946);let In=(()=>{class n{constructor(r,a){this.httpClient=r,this.configService=a}loadAllAvailableMetrics(r,a){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${r}/vertices/${a}/metrics`).pipe((0,xt.U)(f=>f.sort((d,_)=>{const v=d.id.toLowerCase(),x=_.id.toLowerCase();return v<x?-1:v>x?1:0})))}loadMetrics(r,a,f){const d=f.join(",");return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${r}/vertices/${a}/metrics?get=${d}`).pipe((0,xt.U)(_=>{const v={};return _.forEach(x=>{v[x.id]=parseInt(x.value,10)}),{timestamp:Date.now(),values:v}}))}loadAggregatedMetrics(r,a,f,d="max"){const _=f.join(",");return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${r}/vertices/${a}/subtasks/metrics?get=${_}`).pipe((0,xt.U)(v=>{const x={};return v.forEach(T=>{switch(d){case"min":x[T.id]=+T.min;break;case"max":x[T.id]=+T.max;break;case"avg":x[T.id]=+T.avg;break;case"sum":x[T.id]=+T.sum;break;default:throw new Error(`Unsupported aggregate: ${d}`)}}),x}))}loadWatermarks(r,a){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${r}/vertices/${a}/watermarks`).pipe((0,xt.U)(f=>{let _,d=NaN;const v={};return f.forEach(x=>{const T=parseInt(x.value,10),z=x.id.replace(".currentInputWatermark","");v[z]=T,(isNaN(d)||T<d)&&(d=T)}),_=!isNaN(d)&&d>this.configService.LONG_MIN_VALUE?d:NaN,{lowWatermark:_,watermarks:v}}))}}return n.\u0275fac=function(r){return new(r||n)(t.LFG(Ai.eN),t.LFG(_r.E))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function zi(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"No Available Metric"),t.qZA())}function ki(n,s){if(1&n&&(t.TgZ(0,"nz-option",7),t.TgZ(1,"span",8),t._uU(2),t.qZA(),t.qZA()),2&n){const r=s.$implicit;t.Q6J("nzLabel",r)("nzValue",r),t.xp6(1),t.Q6J("title",r),t.xp6(1),t.Oqu(r)}}function Mi(n,s){if(1&n){const r=t.EpF();t._uU(0," Add Metric: "),t.TgZ(1,"nz-select",5),t.NdJ("ngModelChange",function(f){return t.CHM(r),t.oxw().updateMetric(f)}),t.YNc(2,ki,3,4,"nz-option",6),t.qZA()}if(2&n){const r=t.oxw();t.xp6(1),t.Q6J("ngModel",null)("nzPlaceHolder","Select Metric Name"),t.xp6(1),t.Q6J("ngForOf",r.listOfUnselectedMetric)}}function Zi(n,s){if(1&n){const r=t.EpF();t.TgZ(0,"flink-job-chart",9),t.NdJ("closed",function(f){return t.CHM(r),t.oxw().closeMetric(f)}),t.qZA()}2&n&&t.Q6J("title",s.$implicit)}let Oi=(()=>{class n{constructor(r,a,f){this.metricsService=r,this.jobLocalService=a,this.cdr=f,this.data=[],this.listOfMetricName=[],this.listOfSelectedMetric=[],this.listOfUnselectedMetric=[],this.destroy$=new rt.xQ}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,bi.x)((r,a)=>r.vertex.id===a.vertex.id),(0,it.R)(this.destroy$)).subscribe(r=>{this.loadMetricList(r.job.jid,r.vertex.id)}),this.jobLocalService.jobWithVertexChanges().pipe((0,dr.h)(()=>this.listOfSelectedMetric.length>0),(0,jt.zg)(r=>this.metricsService.loadMetrics(r.job.jid,r.vertex.id,this.listOfSelectedMetric)),(0,it.R)(this.destroy$)).subscribe(r=>{this.listOfJobChartComponent&&this.listOfJobChartComponent.length&&this.listOfJobChartComponent.forEach(a=>{a.refresh(r)}),this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMetricList(r,a){this.cacheMetricKey=`${r}/${a}`,this.metricsService.loadAllAvailableMetrics(r,a).subscribe(f=>{this.listOfMetricName=f.map(d=>d.id),this.listOfSelectedMetric=this.jobLocalService.metricsCacheMap.get(this.cacheMetricKey)||[],this.updateUnselectedMetricList(),this.cdr.markForCheck()})}updateMetric(r){this.listOfSelectedMetric=[...this.listOfSelectedMetric,r],this.jobLocalService.metricsCacheMap.set(this.cacheMetricKey,this.listOfSelectedMetric),this.updateUnselectedMetricList()}closeMetric(r){this.listOfSelectedMetric=this.listOfSelectedMetric.filter(a=>a!==r),this.jobLocalService.metricsCacheMap.set(this.cacheMetricKey,this.listOfSelectedMetric),this.updateUnselectedMetricList()}updateUnselectedMetricList(){this.listOfUnselectedMetric=this.listOfMetricName.filter(r=>-1===this.listOfSelectedMetric.indexOf(r))}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(In),t.Y36(Jt.R),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-chart"]],viewQuery:function(r,a){if(1&r&&t.Gf(fn,5),2&r){let f;t.iGM(f=t.CRH())&&(a.listOfJobChartComponent=f)}},decls:6,vars:3,consts:[[1,"metric-selector"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"metric-area"],[3,"title","closed",4,"ngFor","ngForOf"],["nzSize","small","nzShowSearch","",3,"ngModel","nzPlaceHolder","ngModelChange"],["nzCustomContent","",3,"nzLabel","nzValue",4,"ngFor","ngForOf"],["nzCustomContent","",3,"nzLabel","nzValue"],[3,"title"],[3,"title","closed"]],template:function(r,a){if(1&r&&(t.TgZ(0,"div",0),t.YNc(1,zi,2,0,"span",1),t.YNc(2,Mi,3,3,"ng-template",null,2,t.W1O),t.qZA(),t.TgZ(4,"div",3),t.YNc(5,Zi,1,1,"flink-job-chart",4),t.qZA()),2&r){const f=t.MAs(3);t.xp6(1),t.Q6J("ngIf",0===a.listOfMetricName.length)("ngIfElse",f),t.xp6(4),t.Q6J("ngForOf",a.listOfSelectedMetric)}},directives:[B.O5,X.Vq,dt.JJ,dt.On,B.sg,X.Ip,fn],styles:["nz-select[_ngcontent-%COMP%]{width:300px}.metric-selector[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]{display:block;padding:16px}"],changeDetection:0}),n})();var vr=O(41894),hn=O(40870);function Si(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,r.node.detail.metrics["write-records"],"1.0-0")," ")}}function Ni(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,r.node.detail.metrics["read-records"],"1.0-0")," ")}}function Ji(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,r.node.detail.metrics["write-bytes"])," ")}}function Di(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw(2);t.xp6(1),t.hij(" ",t.lcZ(2,1,r.node.detail.metrics["read-bytes"])," ")}}function qi(n,s){1&n&&t._UZ(0,"i",7)}const Fi=function(n){return{state:n}},Pi=function(n){return{tasks:n}};function Ei(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"div",1),t._uU(2),t.qZA(),t._UZ(3,"nz-divider"),t.TgZ(4,"div",2),t.TgZ(5,"div",3),t.TgZ(6,"dl"),t.TgZ(7,"dd"),t._uU(8,"State"),t.qZA(),t.TgZ(9,"dt"),t._UZ(10,"flink-dynamic-host",4),t.qZA(),t.TgZ(11,"dd"),t._uU(12,"Parallelism"),t.qZA(),t.TgZ(13,"dt"),t._uU(14),t.qZA(),t.TgZ(15,"dd"),t._uU(16,"Start Time"),t.qZA(),t.TgZ(17,"dt"),t._uU(18),t.ALo(19,"humanizeDate"),t.qZA(),t.TgZ(20,"dd"),t._uU(21,"End Time"),t.qZA(),t.TgZ(22,"dt"),t._uU(23),t.ALo(24,"humanizeDate"),t.qZA(),t.TgZ(25,"dd"),t._uU(26,"Duration"),t.qZA(),t.TgZ(27,"dt"),t._uU(28),t.ALo(29,"humanizeDuration"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(30,"div",3),t.TgZ(31,"dl"),t.TgZ(32,"dd"),t._uU(33,"Task"),t.qZA(),t.TgZ(34,"dt"),t._UZ(35,"flink-dynamic-host",4),t.qZA(),t.TgZ(36,"dd"),t._uU(37,"Records Sent"),t.qZA(),t.TgZ(38,"dt"),t.YNc(39,Si,3,4,"span",5),t.qZA(),t.TgZ(40,"dd"),t._uU(41,"Records Received"),t.qZA(),t.TgZ(42,"dt"),t.YNc(43,Ni,3,4,"span",5),t.qZA(),t.TgZ(44,"dd"),t._uU(45,"Bytes Sent"),t.qZA(),t.TgZ(46,"dt"),t.YNc(47,Ji,3,3,"span",5),t.qZA(),t.TgZ(48,"dd"),t._uU(49,"Bytes Received"),t.qZA(),t.TgZ(50,"dt"),t.YNc(51,Di,3,3,"span",5),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(52,qi,1,0,"ng-template",null,6,t.W1O),t.BQk()),2&n){const r=t.MAs(53),a=t.oxw();t.xp6(2),t.hij(" ",a.node.description," "),t.xp6(3),t.Q6J("nzSpan",12),t.xp6(5),t.Q6J("data",t.VKq(27,Fi,a.node.detail.status))("component",a.stateBadgeComponent),t.xp6(4),t.hij(" ",a.node.detail.parallelism," "),t.xp6(4),t.hij(" ",t.xi3(19,19,a.node.detail["start-time"],"yyyy-MM-dd HH:mm:ss")," "),t.xp6(5),t.hij(" ",t.xi3(24,22,a.node.detail["end-time"],"yyyy-MM-dd HH:mm:ss")," "),t.xp6(5),t.hij(" ",t.lcZ(29,25,a.node.detail.duration)," "),t.xp6(2),t.Q6J("nzSpan",12),t.xp6(5),t.Q6J("data",t.VKq(29,Pi,a.node.detail.tasks))("component",a.taskCountComponent),t.xp6(4),t.Q6J("ngIf",a.node.detail.metrics["write-records-complete"])("ngIfElse",r),t.xp6(4),t.Q6J("ngIf",a.node.detail.metrics["read-records-complete"])("ngIfElse",r),t.xp6(4),t.Q6J("ngIf",a.node.detail.metrics["write-bytes-complete"])("ngIfElse",r),t.xp6(4),t.Q6J("ngIf",a.node.detail.metrics["read-bytes-complete"])("ngIfElse",r)}}let Ln=(()=>{class n{constructor(r,a,f){var d,_;this.jobLocalService=r,this.cdr=a,this.moduleConfig=f,this.destroy$=new rt.xQ,this.stateBadgeComponent=(null===(d=f.customComponents)||void 0===d?void 0:d.stateBadgeComponent)||st.C.customComponents.stateBadgeComponent,this.taskCountComponent=(null===(_=f.customComponents)||void 0===_?void 0:_.taskCountBadgeComponent)||st.C.customComponents.taskCountBadgeComponent}ngOnInit(){this.jobLocalService.selectedVertexChanges().pipe((0,it.R)(this.destroy$)).subscribe(r=>{this.node=r,null!=this.node&&null!=this.node.description&&this.node.description.indexOf("<br/>")>0&&(this.node.description=this.node.description.replace(/<br\/>/g,"\n")),this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Jt.R),t.Y36(t.sBO),t.Y36(st.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-detail"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"name"],["nz-row","",1,"wrapper"],["nz-col","",3,"nzSpan"],[3,"data","component"],[4,"ngIf","ngIfElse"],["loadingTemplate",""],["nz-icon","","nzType","loading"]],template:function(r,a){1&r&&t.YNc(0,Ei,54,31,"ng-container",0),2&r&&t.Q6J("ngIf",a.node)},directives:[B.O5,Se.g,vr.SK,vr.t3,un,F.Ls],pipes:[hn.c,le.w,B.JJ,Xt.E],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;height:100%}[_nghost-%COMP%]     .ant-divider-horizontal{margin:0}[_nghost-%COMP%]   .name[_ngcontent-%COMP%]{overflow:auto;max-height:120px;padding:8px 12px;font-size:12px;white-space:pre-wrap;word-break:break-word}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]{flex:1}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr;grid-gap:.75rem 2rem;margin-bottom:0;padding:24px;font-size:12px}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{font-weight:500}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{position:relative;font-weight:400}[_nghost-%COMP%]   .wrapper[_ngcontent-%COMP%]   dl[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]:before{content:":";position:absolute;left:-1rem}'],changeDetection:0}),n})();var Rt=O(41777),Ii=O(36053),Li=O(37141);let Bi=(()=>{class n{constructor(r,a,f,d,_){var v;this.activatedRoute=r,this.router=a,this.jobLocalService=f,this.jobChartService=d,this.moduleConfig=_,this.listOfNavigation=[],this.fullScreen=!1,this.destroy$=new rt.xQ,this.listOfNavigation=_.routerTabs||st.C.routerTabs,this.cachePath=null===(v=this.listOfNavigation[0])||void 0===v?void 0:v.path}ngOnInit(){const r=this.activatedRoute.params.pipe((0,xt.U)(a=>a.vertexId));(0,Ii.aj)([this.jobLocalService.jobDetailChanges().pipe((0,xt.U)(a=>a.plan.nodes)),r]).pipe((0,it.R)(this.destroy$)).subscribe(([a,f])=>{this.activatedRoute.firstChild?this.cachePath=this.activatedRoute.firstChild.snapshot.data.path:this.router.navigate([this.cachePath],{relativeTo:this.activatedRoute}).then(),a&&f&&this.jobLocalService.setSelectedVertex(a.find(d=>d.id===f)||null)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.jobLocalService.setSelectedVertex(null)}closeDrawer(){this.fullScreen?(this.fullScreen=!1,this.jobChartService.resize()):this.router.navigate(["../../"],{relativeTo:this.activatedRoute}).then()}fullDrawer(){this.fullScreen=!0,this.jobChartService.resize()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(at.gz),t.Y36(at.F0),t.Y36(Jt.R),t.Y36(yt),t.Y36(st.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer"]],hostVars:3,hostBindings:function(r,a){2&r&&(t.d8E("@drawer",void 0),t.ekj("full-width",a.fullScreen))},decls:7,vars:2,consts:[[3,"listOfNavigation","size"],[1,"drawer-content"],[1,"handler","close",3,"click"],["nz-icon","","nzType","right"],[1,"handler","full",3,"click"],["nz-icon","","nzType","left"]],template:function(r,a){1&r&&(t._UZ(0,"flink-navigation",0),t.TgZ(1,"div",1),t._UZ(2,"router-outlet"),t.qZA(),t.TgZ(3,"a",2),t.NdJ("click",function(){return a.closeDrawer()}),t._UZ(4,"i",3),t.qZA(),t.TgZ(5,"a",4),t.NdJ("click",function(){return a.fullDrawer()}),t._UZ(6,"i",5),t.qZA()),2&r&&t.Q6J("listOfNavigation",a.listOfNavigation)("size","small")},directives:[Li.J,at.lC,F.Ls],styles:[".handler[_ngcontent-%COMP%]{position:absolute;top:50%;z-index:2;display:block;padding:12px 0;border:1px solid #f0f0f0;background:#fafafa;font-size:14px;transform:translateY(-50%)}.handler.close[_ngcontent-%COMP%]{left:-16px;margin-top:-25px}.handler.full[_ngcontent-%COMP%]{left:-16px;margin-top:25px}.handler[_ngcontent-%COMP%]:hover{background:#1890ff;color:#fff}[_nghost-%COMP%]{position:absolute;top:0;right:0;z-index:10;display:block;width:60%;height:100%;border-left:solid 1px #f0f0f0;background:#fff}.full-width[_nghost-%COMP%]{width:100%;border-left:none}.full-width[_nghost-%COMP%]   .handler.close[_ngcontent-%COMP%]{left:-1px}.full-width[_nghost-%COMP%]   .handler.full[_ngcontent-%COMP%]{display:none}[_nghost-%COMP%]     .ant-tabs-bar{margin:0}[_nghost-%COMP%]     .ant-tabs-tab:first-of-type{margin:0 0 0 16px}.drawer-content[_ngcontent-%COMP%]{overflow:auto;height:calc(100% - 38px)}"],data:{animation:[(0,Rt.X$)("drawer",[(0,Rt.eR)("void => *",[(0,Rt.oB)({transform:"translateX(100%)"}),(0,Rt.jt)(100,(0,Rt.oB)({transform:"translateX(0)"}))]),(0,Rt.eR)("* => void",[(0,Rt.oB)({transform:"translateX(0)"}),(0,Rt.jt)(100,(0,Rt.oB)({transform:"translateX(100%)"}))])])]},changeDetection:0}),n})();var Ui=O(70028),Ri=O(70344),Qi=O.n(Ri),Vi=O(25332),Hi=(O(31829),O(89515)),wr=O(60711),bt="$";function pn(){}function yr(n,s){var r=new pn;if(n instanceof pn)n.each(function(v,x){r.set(x,v)});else if(Array.isArray(n)){var d,a=-1,f=n.length;if(null==s)for(;++a<f;)r.set(a,n[a]);else for(;++a<f;)r.set(s(d=n[a],a,n),d)}else if(n)for(var _ in n)r.set(_,n[_]);return r}pn.prototype=yr.prototype={constructor:pn,has:function(n){return bt+n in this},get:function(n){return this[bt+n]},set:function(n,s){return this[bt+n]=s,this},remove:function(n){var s=bt+n;return s in this&&delete this[s]},clear:function(){for(var n in this)n[0]===bt&&delete this[n]},keys:function(){var n=[];for(var s in this)s[0]===bt&&n.push(s.slice(1));return n},values:function(){var n=[];for(var s in this)s[0]===bt&&n.push(this[s]);return n},entries:function(){var n=[];for(var s in this)s[0]===bt&&n.push({key:s.slice(1),value:this[s]});return n},size:function(){var n=0;for(var s in this)s[0]===bt&&++n;return n},empty:function(){for(var n in this)if(n[0]===bt)return!1;return!0},each:function(n){for(var s in this)s[0]===bt&&n(this[s],s.slice(1),this)}};const dn=yr;function Y(){}var Qt=dn.prototype;function mn(){}function br(n){return null==n?mn:function(){return this.querySelector(n)}}function Vt(){return[]}function Ht(n){return new Array(n.length)}function Yt(n,s){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=s}function _e(n,s,r,a,f,d){for(var v,_=0,x=s.length,T=d.length;_<T;++_)(v=s[_])?(v.__data__=d[_],a[_]=v):r[_]=new Yt(n,d[_]);for(;_<x;++_)(v=s[_])&&(f[_]=v)}function Pe(n,s,r,a,f,d,_){var v,x,Q,T={},z=s.length,E=d.length,I=new Array(z);for(v=0;v<z;++v)(x=s[v])&&(I[v]=Q="$"+_.call(x,x.__data__,v,s),Q in T?f[v]=x:T[Q]=x);for(v=0;v<E;++v)(x=T[Q="$"+_.call(n,d[v],v,d)])?(a[v]=x,x.__data__=d[v],T[Q]=null):r[v]=new Yt(n,d[v]);for(v=0;v<z;++v)(x=s[v])&&T[I[v]]===x&&(f[v]=x)}function vn(n,s){return n<s?-1:n>s?1:n>=s?0:NaN}Y.prototype=function Wi(n,s){var r=new Y;if(n instanceof Y)n.each(function(d){r.add(d)});else if(n){var a=-1,f=n.length;if(null==s)for(;++a<f;)r.add(n[a]);else for(;++a<f;)r.add(s(n[a],a,n))}return r}.prototype={constructor:Y,has:Qt.has,add:function(n){return this[bt+(n+="")]=n,this},remove:Qt.remove,clear:Qt.clear,values:Qt.keys,size:Qt.size,empty:Qt.empty,each:Qt.each},Yt.prototype={constructor:Yt,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,s){return this._parent.insertBefore(n,s)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};var wn="http://www.w3.org/1999/xhtml";const kr={svg:"http://www.w3.org/2000/svg",xhtml:wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Mr(n){var s=n+="",r=s.indexOf(":");return r>=0&&"xmlns"!==(s=n.slice(0,r))&&(n=n.slice(r+1)),kr.hasOwnProperty(s)?{space:kr[s],local:n}:n}function Zr(n){return function(){this.removeAttribute(n)}}function Or(n){return function(){this.removeAttributeNS(n.space,n.local)}}function Un(n,s){return function(){this.setAttribute(n,s)}}function yn(n,s){return function(){this.setAttributeNS(n.space,n.local,s)}}function Sr(n,s){return function(){var r=s.apply(this,arguments);null==r?this.removeAttribute(n):this.setAttribute(n,r)}}function Rn(n,s){return function(){var r=s.apply(this,arguments);null==r?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,r)}}function Ue(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function Qn(n){return function(){this.style.removeProperty(n)}}function Dt(n,s,r){return function(){this.style.setProperty(n,s,r)}}function gt(n,s,r){return function(){var a=s.apply(this,arguments);null==a?this.style.removeProperty(n):this.style.setProperty(n,a,r)}}function no(n,s){return n.style.getPropertyValue(s)||Ue(n).getComputedStyle(n,null).getPropertyValue(s)}function ro(n){return function(){delete this[n]}}function ee(n,s){return function(){this[n]=s}}function Nr(n,s){return function(){var r=s.apply(this,arguments);null==r?delete this[n]:this[n]=r}}function Re(n){return n.trim().split(/^|\s+/)}function ne(n){return n.classList||new bn(n)}function bn(n){this._node=n,this._names=Re(n.getAttribute("class")||"")}function Jr(n,s){for(var r=ne(n),a=-1,f=s.length;++a<f;)r.add(s[a])}function Cn(n,s){for(var r=ne(n),a=-1,f=s.length;++a<f;)r.remove(s[a])}function io(n){return function(){Jr(this,n)}}function Dr(n){return function(){Cn(this,n)}}function oo(n,s){return function(){(s.apply(this,arguments)?Jr:Cn)(this,n)}}function qr(){this.textContent=""}function Vn(n){return function(){this.textContent=n}}function Fr(n){return function(){var s=n.apply(this,arguments);this.textContent=null==s?"":s}}function Qe(){this.innerHTML=""}function fe(n){return function(){this.innerHTML=n}}function Ve(n){return function(){var s=n.apply(this,arguments);this.innerHTML=null==s?"":s}}function $t(){this.nextSibling&&this.parentNode.appendChild(this)}function ye(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ft(n){return function(){var s=this.ownerDocument,r=this.namespaceURI;return r===wn&&s.documentElement.namespaceURI===wn?s.createElement(n):s.createElementNS(r,n)}}function so(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function Pr(n){var s=Mr(n);return(s.local?so:Ft)(s)}function co(){return null}function Ir(){var n=this.parentNode;n&&n.removeChild(this)}function Hn(){var n=this.cloneNode(!1),s=this.parentNode;return s?s.insertBefore(n,this.nextSibling):n}function xe(){var n=this.cloneNode(!0),s=this.parentNode;return s?s.insertBefore(n,this.nextSibling):n}bn.prototype={add:function(n){this._names.indexOf(n)<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var s=this._names.indexOf(n);s>=0&&(this._names.splice(s,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};var re={},Mt=null;function Br(n,s,r){return n=be(n,s,r),function(a){var f=a.relatedTarget;(!f||f!==this&&!(8&f.compareDocumentPosition(this)))&&n.call(this,a)}}function be(n,s,r){return function(a){var f=Mt;Mt=a;try{n.call(this,this.__data__,s,r)}finally{Mt=f}}}function lt(n){return n.trim().split(/^|\s+/).map(function(s){var r="",a=s.indexOf(".");return a>=0&&(r=s.slice(a+1),s=s.slice(0,a)),{type:s,name:r}})}function Yn(n){return function(){var s=this.__on;if(s){for(var d,r=0,a=-1,f=s.length;r<f;++r)d=s[r],n.type&&d.type!==n.type||d.name!==n.name?s[++a]=d:this.removeEventListener(d.type,d.listener,d.capture);++a?s.length=a:delete this.__on}}}function $n(n,s,r){var a=re.hasOwnProperty(n.type)?Br:be;return function(f,d,_){var x,v=this.__on,T=a(s,d,_);if(v)for(var z=0,E=v.length;z<E;++z)if((x=v[z]).type===n.type&&x.name===n.name)return this.removeEventListener(x.type,x.listener,x.capture),this.addEventListener(x.type,x.listener=T,x.capture=r),void(x.value=s);this.addEventListener(n.type,T,r),x={type:n.type,name:n.name,value:s,listener:T,capture:r},v?v.push(x):this.__on=[x]}}function $e(n,s,r){var a=Ue(n),f=a.CustomEvent;"function"==typeof f?f=new f(s,r):(f=a.document.createEvent("Event"),r?(f.initEvent(s,r.bubbles,r.cancelable),f.detail=r.detail):f.initEvent(s,!1,!1)),n.dispatchEvent(f)}function Ur(n,s){return function(){return $e(this,n,s)}}function Et(n,s){return function(){return $e(this,n,s.apply(this,arguments))}}"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(re={mouseenter:"mouseover",mouseleave:"mouseout"}));var Tn=[null];function ct(n,s){this._groups=n,this._parents=s}function Rr(){return new ct([[document.documentElement]],Tn)}ct.prototype=Rr.prototype={constructor:ct,select:function qe(n){"function"!=typeof n&&(n=br(n));for(var s=this._groups,r=s.length,a=new Array(r),f=0;f<r;++f)for(var x,T,d=s[f],_=d.length,v=a[f]=new Array(_),z=0;z<_;++z)(x=d[z])&&(T=n.call(x,x.__data__,z,d))&&("__data__"in x&&(T.__data__=x.__data__),v[z]=T);return new ct(a,this._parents)},selectAll:function ji(n){"function"!=typeof n&&(n=function Gi(n){return null==n?Vt:function(){return this.querySelectorAll(n)}}(n));for(var s=this._groups,r=s.length,a=[],f=[],d=0;d<r;++d)for(var x,_=s[d],v=_.length,T=0;T<v;++T)(x=_[T])&&(a.push(n.call(x,x.__data__,T,_)),f.push(x));return new ct(a,f)},filter:function _n(n){"function"!=typeof n&&(n=function Cr(n){return function(){return this.matches(n)}}(n));for(var s=this._groups,r=s.length,a=new Array(r),f=0;f<r;++f)for(var x,d=s[f],_=d.length,v=a[f]=[],T=0;T<_;++T)(x=d[T])&&n.call(x,x.__data__,T,d)&&v.push(x);return new ct(a,this._parents)},data:function te(n,s){if(!n)return Q=new Array(this.size()),T=-1,this.each(function(ei){Q[++T]=ei}),Q;var r=s?Pe:_e,a=this._parents,f=this._groups;"function"!=typeof n&&(n=function Tr(n){return function(){return n}}(n));for(var d=f.length,_=new Array(d),v=new Array(d),x=new Array(d),T=0;T<d;++T){var z=a[T],E=f[T],I=E.length,Q=n.call(z,z&&z.__data__,T,a),Tt=Q.length,At=v[T]=new Array(Tt),St=_[T]=new Array(Tt);r(z,E,At,St,x[T]=new Array(I),Q,s);for(var On,ti,Nt=0,Te=0;Nt<Tt;++Nt)if(On=At[Nt]){for(Nt>=Te&&(Te=Nt+1);!(ti=St[Te])&&++Te<Tt;);On._next=ti||null}}return(_=new ct(_,a))._enter=v,_._exit=x,_},enter:function Fe(){return new ct(this._enter||this._groups.map(Ht),this._parents)},exit:function Ee(){return new ct(this._exit||this._groups.map(Ht),this._parents)},join:function Ie(n,s,r){var a=this.enter(),f=this,d=this.exit();return a="function"==typeof n?n(a):a.append(n+""),null!=s&&(f=s(f)),null==r?d.remove():r(d),a&&f?a.merge(f).order():f},merge:function Le(n){for(var s=this._groups,r=n._groups,a=s.length,d=Math.min(a,r.length),_=new Array(a),v=0;v<d;++v)for(var I,x=s[v],T=r[v],z=x.length,E=_[v]=new Array(z),Q=0;Q<z;++Q)(I=x[Q]||T[Q])&&(E[Q]=I);for(;v<a;++v)_[v]=s[v];return new ct(_,this._parents)},order:function ve(){for(var n=this._groups,s=-1,r=n.length;++s<r;)for(var _,a=n[s],f=a.length-1,d=a[f];--f>=0;)(_=a[f])&&(d&&4^_.compareDocumentPosition(d)&&d.parentNode.insertBefore(_,d),d=_);return this},sort:function Ar(n){function s(E,I){return E&&I?n(E.__data__,I.__data__):!E-!I}n||(n=vn);for(var r=this._groups,a=r.length,f=new Array(a),d=0;d<a;++d){for(var T,_=r[d],v=_.length,x=f[d]=new Array(v),z=0;z<v;++z)(T=_[z])&&(x[z]=T);x.sort(s)}return new ct(f,this._parents).order()},call:function Be(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this},nodes:function Xi(){var n=new Array(this.size()),s=-1;return this.each(function(){n[++s]=this}),n},node:function zr(){for(var n=this._groups,s=0,r=n.length;s<r;++s)for(var a=n[s],f=0,d=a.length;f<d;++f){var _=a[f];if(_)return _}return null},size:function Ki(){var n=0;return this.each(function(){++n}),n},empty:function to(){return!this.node()},each:function Bn(n){for(var s=this._groups,r=0,a=s.length;r<a;++r)for(var v,f=s[r],d=0,_=f.length;d<_;++d)(v=f[d])&&n.call(v,v.__data__,d,f);return this},attr:function xn(n,s){var r=Mr(n);if(arguments.length<2){var a=this.node();return r.local?a.getAttributeNS(r.space,r.local):a.getAttribute(r)}return this.each((null==s?r.local?Or:Zr:"function"==typeof s?r.local?Rn:Sr:r.local?yn:Un)(r,s))},style:function eo(n,s,r){return arguments.length>1?this.each((null==s?Qn:"function"==typeof s?gt:Dt)(n,s,null==r?"":r)):no(this.node(),n)},property:function we(n,s){return arguments.length>1?this.each((null==s?ro:"function"==typeof s?Nr:ee)(n,s)):this.node()[n]},classed:function Ho(n,s){var r=Re(n+"");if(arguments.length<2){for(var a=ne(this.node()),f=-1,d=r.length;++f<d;)if(!a.contains(r[f]))return!1;return!0}return this.each(("function"==typeof s?oo:s?io:Dr)(r,s))},text:function ao(n){return arguments.length?this.each(null==n?qr:("function"==typeof n?Fr:Vn)(n)):this.node().textContent},html:function qt(n){return arguments.length?this.each(null==n?Qe:("function"==typeof n?Ve:fe)(n)):this.node().innerHTML},raise:function mt(){return this.each($t)},lower:function He(){return this.each(ye)},append:function lo(n){var s="function"==typeof n?n:Pr(n);return this.select(function(){return this.appendChild(s.apply(this,arguments))})},insert:function Er(n,s){var r="function"==typeof n?n:Pr(n),a=null==s?co:"function"==typeof s?s:br(s);return this.select(function(){return this.insertBefore(r.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function uo(){return this.each(Ir)},clone:function Lr(n){return this.select(n?xe:Hn)},datum:function Ye(n){return arguments.length?this.property("__data__",n):this.node().__data__},on:function Wn(n,s,r){var f,_,a=lt(n+""),d=a.length;if(!(arguments.length<2)){for(v=s?$n:Yn,null==r&&(r=!1),f=0;f<d;++f)this.each(v(a[f],s,r));return this}var v=this.node().__on;if(v)for(var z,x=0,T=v.length;x<T;++x)for(f=0,z=v[x];f<d;++f)if((_=a[f]).type===z.type&&_.name===z.name)return z.value},dispatch:function Gn(n,s){return this.each(("function"==typeof s?Et:Ur)(n,s))}};const jn=Rr;function Xn(n){return"string"==typeof n?new ct([[document.querySelector(n)]],[document.documentElement]):new ct([[n]],Tn)}function Qr(){var n=function T(){return"n"},s=function z(){return[0,0]},r=function E(){return" "},a=document.body,f=ei(),d=null,_=null,v=null;function x(J){d=function Io(J){var _t=J.node();return _t?"svg"===_t.tagName.toLowerCase()?_t:_t.ownerSVGElement:null}(J),d&&(_=d.createSVGPoint(),a.appendChild(f))}x.show=function(){var J=Array.prototype.slice.call(arguments);J[J.length-1]instanceof SVGElement&&(v=J.pop());var Me,_t=r.apply(this,J),ft=s.apply(this,J),Gt=n.apply(this,J),ke=Ae(),nn=Q.length,Lo=document.documentElement.scrollTop||a.scrollTop,Bo=document.documentElement.scrollLeft||a.scrollLeft;for(ke.html(_t).style("opacity",1).style("pointer-events","all");nn--;)ke.classed(Q[nn],!1);return Me=I.get(Gt).apply(this),ke.classed(Gt,!0).style("top",Me.top+ft[0]+Lo+"px").style("left",Me.left+ft[1]+Bo+"px"),x},x.hide=function(){return Ae().style("opacity",0).style("pointer-events","none"),x},x.attr=function(J,_t){if(arguments.length<2&&"string"==typeof J)return Ae().attr(J);var ft=Array.prototype.slice.call(arguments);return jn.prototype.attr.apply(Ae(),ft),x},x.style=function(J,_t){if(arguments.length<2&&"string"==typeof J)return Ae().style(J);var ft=Array.prototype.slice.call(arguments);return jn.prototype.style.apply(Ae(),ft),x},x.direction=function(J){return arguments.length?(n=null==J?J:ni(J),x):n},x.offset=function(J){return arguments.length?(s=null==J?J:ni(J),x):s},x.html=function(J){return arguments.length?(r=null==J?J:ni(J),x):r},x.rootElement=function(J){return arguments.length?(a=null==J?J:ni(J),x):a},x.destroy=function(){return f&&(Ae().remove(),f=null),x};var I=dn({n:function Tt(){var J=ze(this);return{top:J.n.y-f.offsetHeight,left:J.n.x-f.offsetWidth/2}},s:function At(){var J=ze(this);return{top:J.s.y,left:J.s.x-f.offsetWidth/2}},e:function St(){var J=ze(this);return{top:J.e.y-f.offsetHeight/2,left:J.e.x}},w:function oe(){var J=ze(this);return{top:J.w.y-f.offsetHeight/2,left:J.w.x-f.offsetWidth}},nw:function Nt(){var J=ze(this);return{top:J.nw.y-f.offsetHeight,left:J.nw.x-f.offsetWidth}},ne:function Te(){var J=ze(this);return{top:J.ne.y-f.offsetHeight,left:J.ne.x}},sw:function On(){var J=ze(this);return{top:J.sw.y,left:J.sw.x-f.offsetWidth}},se:function ti(){var J=ze(this);return{top:J.se.y,left:J.se.x}}}),Q=I.keys();function ei(){var J=Xn(document.createElement("div"));return J.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),J.node()}function Ae(){return null==f&&(f=ei(),a.appendChild(f)),Xn(f)}function ze(J){for(var _t=v||J;null==_t.getScreenCTM&&null!=_t.parentNode;)_t=_t.parentNode;var ft={},Gt=_t.getScreenCTM(),ke=_t.getBBox(),nn=ke.width,Me=ke.height,Bo=ke.y;return _.x=ke.x,_.y=Bo,ft.nw=_.matrixTransform(Gt),_.x+=nn,ft.ne=_.matrixTransform(Gt),_.y+=Me,ft.se=_.matrixTransform(Gt),_.x-=nn,ft.sw=_.matrixTransform(Gt),_.y-=Me/2,ft.w=_.matrixTransform(Gt),_.x+=nn,ft.e=_.matrixTransform(Gt),_.x-=nn/2,_.y-=Me/2,ft.n=_.matrixTransform(Gt),_.y+=Me,ft.s=_.matrixTransform(Gt),ft}function ni(J){return"function"==typeof J?J:function(){return J}}return x}const fo=["flameGraphContainer"];let Vr=(()=>{class n{draw(){if(this.data){const r=this.flameGraphContainer.nativeElement,a=Qi()().width(r.clientWidth),d=Object.assign(Object.assign({},Ui),{tip:Qr}).tip().direction("s").offset([8,0]).attr("class","d3-flame-graph-tip").html(function(_){return`${_.data.name} (${(0,Hi.WU)(".3f")(100*(_.x1-_.x0))}%, ${_.data.value} samples)`});a.tooltip(d),"off_cpu"==this.graphType&&a.setColorMapper(Vi.offCpuColorMapper),(0,wr.Z)(r).selectAll("*").remove(),(0,wr.Z)(r).datum(this.data).call(a)}}}return n.\u0275fac=function(r){return new(r||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-flame-graph"]],viewQuery:function(r,a){if(1&r&&t.Gf(fo,7),2&r){let f;t.iGM(f=t.CRH())&&(a.flameGraphContainer=f.first)}},inputs:{data:"data",graphType:"graphType"},decls:4,vars:1,consts:[[1,"background"],["flameGraphContainer",""]],template:function(r,a){1&r&&(t.TgZ(0,"div",0),t._UZ(1,"div",null,1),t._uU(3),t.qZA()),2&r&&(t.xp6(3),t.hij(" ",a.draw(),"\n"))},encapsulation:2,changeDetection:0}),n})();function ho(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1," Operator is not running. Cannot sample back pressure.\n"),t.qZA())}function Kn(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"The task has already been terminated"),t.qZA())}function An(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1," The flame graph feature is currently disabled (enable it by setting rest.flamegraph.enabled: true) "),t.qZA())}function Hr(n,s){1&n&&(t.TgZ(0,"span"),t._uU(1,"We are waiting for the first samples to create a flame graph"),t.qZA())}function Yo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeDuration"),t.qZA()),2&n){const r=t.oxw();t.xp6(1),t.hij(" Measurement: ",t.lcZ(2,1,r.now-r.flameGraph.endTimestamp)," ago ")}}function $o(n,s){1&n&&t._UZ(0,"nz-spin")}let Yr=(()=>{class n{constructor(r,a,f){this.jobService=r,this.jobLocalService=a,this.cdr=f,this.isLoading=!0,this.now=Date.now(),this.flameGraph={},this.graphType="on_cpu",this.destroy$=new rt.xQ}ngOnInit(){this.requestFlameGraph()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}requestFlameGraph(){this.jobLocalService.jobWithVertexChanges().pipe((0,hr.b)(r=>this.selectedVertex=r.vertex),(0,jt.zg)(r=>this.jobService.loadOperatorFlameGraph(r.job.jid,r.vertex.id,this.graphType)),(0,it.R)(this.destroy$)).subscribe(r=>{this.now=Date.now(),this.flameGraph.endTimestamp!==r.endTimestamp&&(this.isLoading=!1,this.flameGraph=r,this.flameGraph.graphType=this.graphType),this.cdr.markForCheck()},()=>{this.isLoading=!1,this.cdr.markForCheck()})}selectFrameGraphType(){this.destroy$.next(),this.flameGraph={},this.requestFlameGraph()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Je.O),t.Y36(Jt.R),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-flamegraph"]],decls:18,vars:9,consts:[[4,"ngIf"],["nzButtonStyle","solid",3,"ngModel","ngModelChange"],["nz-radio-button","","nzValue","on_cpu","title","Includes Thread.State.[RUNNABLE, NEW]",3,"click"],["nz-radio-button","","nzValue","off_cpu","title","Includes Thread.State.[WAITING, TIMED_WAITING, BLOCKED]",3,"click"],["nz-radio-button","","nzValue","full","title","Includes stack traces of threads in all states",3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"flame-graph-area"],[3,"data","graphType"],[2,"padding-top","100px"]],template:function(r,a){1&r&&(t.YNc(0,ho,2,0,"span",0),t._uU(1," Type:\n"),t.TgZ(2,"nz-radio-group",1),t.NdJ("ngModelChange",function(d){return a.graphType=d}),t.TgZ(3,"label",2),t.NdJ("click",function(){return a.selectFrameGraphType()}),t._uU(4," On-CPU "),t.qZA(),t.TgZ(5,"label",3),t.NdJ("click",function(){return a.selectFrameGraphType()}),t._uU(6," Off-CPU "),t.qZA(),t.TgZ(7,"label",4),t.NdJ("click",function(){return a.selectFrameGraphType()}),t._uU(8," Mixed "),t.qZA(),t.qZA(),t.ynx(9,5),t.YNc(10,Kn,2,0,"span",6),t.YNc(11,An,2,0,"span",6),t.YNc(12,Hr,2,0,"span",6),t.YNc(13,Yo,3,3,"span",7),t.BQk(),t.TgZ(14,"div",8),t._UZ(15,"flink-flame-graph",9),t.qZA(),t.TgZ(16,"div",10),t.YNc(17,$o,1,0,"nz-spin",0),t.qZA()),2&r&&(t.Q6J("ngIf","RUNNING"!==(null==a.selectedVertex||null==a.selectedVertex.detail?null:a.selectedVertex.detail.status)),t.xp6(2),t.Q6J("ngModel",a.graphType),t.xp6(7),t.Q6J("ngSwitch",a.flameGraph.endTimestamp),t.xp6(1),t.Q6J("ngSwitchCase",-1),t.xp6(1),t.Q6J("ngSwitchCase",-2),t.xp6(1),t.Q6J("ngSwitchCase",-3),t.xp6(3),t.Q6J("data",a.flameGraph.data)("graphType",a.graphType),t.xp6(2),t.Q6J("ngIf",a.isLoading))},directives:[B.O5,L.Dg,dt.JJ,dt.On,L.Of,L.Bq,B.RF,B.n9,B.ED,Vr,K.W],pipes:[le.w],styles:["nz-select[_ngcontent-%COMP%]{width:300px}.metric-selector[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]{display:block;padding:16px}nz-radio-group[_ngcontent-%COMP%]{margin-right:16px}"],changeDetection:0}),n})();var tr=O(30567),Ct=O(97910),po=O(16672),er=O(5416),zn=O(23753);const go=["trigger"];var We=(()=>{return(n=We||(We={})).Vertical="vertical",n.Horizontal="horizontal",We;var n})();let nr=(()=>{class n{constructor(r){this.document=r,this.destroy$=new rt.xQ,this.isMoving=!1,this.left=0,this.top=0,this.resizeMin=0,this.mode=We.Vertical,this.leftChange=new t.vpe,this.topChange=new t.vpe,this.resizeEnd=new t.vpe}startMove(){this.isMoving=!0}getResizeTop(r){const f=(v=>{let x=0;do{(0,Pn.k)(v.offsetTop)||(x+=v.offsetTop)}while(v=v.offsetParent);return x})(this.baseElement.nativeElement);let _=r.pageY-f;return _>900&&(_=900),_<this.resizeMin&&(_=this.resizeMin),_}getResizeLeft(r){const f=(v=>{let x=0;do{(0,Pn.k)(v.offsetLeft)||(x+=v.offsetLeft)}while(v=v.offsetParent);return x})(this.baseElement.nativeElement),d=this.baseElement.nativeElement.getBoundingClientRect().width-200;let _=r.pageX-f;return _>d&&(_=d),_<this.resizeMin&&(_=this.resizeMin),_}ngOnInit(){(0,zn.R)(this.document,"mouseup").pipe((0,it.R)(this.destroy$)).subscribe(r=>{this.isMoving=!1,r.target===this.trigger.nativeElement&&(r.stopPropagation(),this.resizeEnd.emit({left:this.left,top:this.top}))}),(0,zn.R)(this.document,"mousemove").pipe((0,it.R)(this.destroy$)).subscribe(r=>{!this.isMoving||(r.preventDefault(),this.mode===We.Vertical?(this.left=this.getResizeLeft(r),this.leftChange.emit(this.left)):(this.top=this.getResizeTop(r),this.topChange.emit(this.top)))})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(B.K0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-resize"]],viewQuery:function(r,a){if(1&r&&t.Gf(go,7),2&r){let f;t.iGM(f=t.CRH())&&(a.trigger=f.first)}},inputs:{left:"left",top:"top",baseElement:"baseElement",resizeMin:"resizeMin",mode:"mode"},outputs:{leftChange:"leftChange",topChange:"topChange",resizeEnd:"resizeEnd"},decls:4,vars:12,consts:[[1,"resize",3,"mousedown"],["trigger",""],[1,"resize-handle"],["nz-icon","","nzType","ellipsis"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0,1),t.NdJ("mousedown",function(){return a.startMove()}),t.TgZ(2,"div",2),t._UZ(3,"i",3),t.qZA(),t.qZA()),2&r&&(t.Udp("left","vertical"===a.mode?a.left:0,"px")("top","vertical"===a.mode?0:a.top,"px"),t.ekj("vertical","vertical"===a.mode)("horizontal","horizontal"===a.mode),t.xp6(2),t.ekj("horizontal","horizontal"===a.mode)("vertical","vertical"===a.mode))},directives:[mr.w,F.Ls],styles:[".resize[_ngcontent-%COMP%]{position:absolute;top:0;left:0;z-index:10;background:transparent}.resize.vertical[_ngcontent-%COMP%]{width:7px;height:100%;border-left:1px solid #f0f0f0;cursor:col-resize}.resize.horizontal[_ngcontent-%COMP%]{width:100%;height:7px;cursor:row-resize;transform:translateY(-3.5px)}.resize-handle[_ngcontent-%COMP%]{position:relative;top:-2px;left:50%;width:30px;height:10px;margin-right:15px;border:1px solid #e8e8e8;border-radius:2px;background:#fbfbfb;line-height:10px;text-align:center;pointer-events:none}.resize-handle.vertical[_ngcontent-%COMP%]{top:50%;left:auto;margin-top:-15px;margin-right:auto;margin-left:5px;transform:rotate(90deg);transform-origin:left top}.resize-handle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;top:-2px}"],changeDetection:0}),n})();function mo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.detail.metrics["read-bytes"])," ")}}function _o(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.detail.metrics["read-records"],"1.0-0")," ")}}function rr(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.detail.metrics["write-bytes"])," ")}}function vo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.detail.metrics["write-records"],"1.0-0")," ")}}function wo(n,s){if(1&n){const r=t.EpF();t.TgZ(0,"tr",9),t.NdJ("click",function(){const d=t.CHM(r).$implicit;return t.oxw().clickNode(d)}),t.TgZ(1,"td",10),t.TgZ(2,"a",11),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"td"),t._UZ(5,"flink-job-badge",12),t.qZA(),t.TgZ(6,"td"),t.YNc(7,mo,3,3,"span",13),t.qZA(),t.TgZ(8,"td"),t.YNc(9,_o,3,4,"span",13),t.qZA(),t.TgZ(10,"td"),t.YNc(11,rr,3,3,"span",13),t.qZA(),t.TgZ(12,"td"),t.YNc(13,vo,3,4,"span",13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"humanizeDate"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"humanizeDuration"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"humanizeDate"),t.qZA(),t.TgZ(25,"td",14),t._UZ(26,"flink-task-badge",15),t.qZA(),t.qZA()}if(2&n){const r=s.$implicit,a=t.oxw(),f=t.MAs(30);t.ekj("selected",(null==a.selectedNode?null:a.selectedNode.id)===r.id),t.xp6(1),t.ekj("selected",(null==a.selectedNode?null:a.selectedNode.id)===r.id),t.xp6(1),t.Q6J("nzTooltipTitle",null==r.detail?null:r.detail.name),t.xp6(1),t.hij(" ",null==r.detail?null:r.detail.name," "),t.xp6(2),t.Q6J("state",null==r.detail?null:r.detail.status),t.xp6(2),t.Q6J("ngIf",(null==r.detail?null:r.detail.metrics)&&r.detail.metrics["read-bytes-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",(null==r.detail?null:r.detail.metrics)&&r.detail.metrics["read-records-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",(null==r.detail?null:r.detail.metrics)&&r.detail.metrics["write-bytes-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",(null==r.detail?null:r.detail.metrics)&&r.detail.metrics["write-records-complete"])("ngIfElse",f),t.xp6(2),t.Oqu(r.parallelism),t.xp6(2),t.Oqu(t.xi3(18,22,r.detail["start-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.lcZ(21,25,null==r.detail?null:r.detail.duration)),t.xp6(3),t.Oqu(t.xi3(24,27,r.detail["end-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(2),t.ekj("selected",(null==a.selectedNode?null:a.selectedNode.id)===r.id),t.xp6(1),t.Q6J("tasks",null==r.detail?null:r.detail.tasks)}}function yo(n,s){1&n&&(t.TgZ(0,"span",16),t._uU(1,"loading..."),t.qZA())}const $r=function(n){return{x:n}};function ut(n){return(s,r)=>n(s)>n(r)?1:-1}let ir=(()=>{class n{constructor(r){this.elementRef=r,this.trackById=(a,f)=>f.id,this.sortStatusFn=ut(a=>{var f;return null===(f=a.detail)||void 0===f?void 0:f.status}),this.sortReadBytesFn=ut(a=>{var f,d;return null===(d=null===(f=a.detail)||void 0===f?void 0:f.metrics)||void 0===d?void 0:d["read-bytes"]}),this.sortReadRecordsFn=ut(a=>{var f,d;return null===(d=null===(f=a.detail)||void 0===f?void 0:f.metrics)||void 0===d?void 0:d["read-records"]}),this.sortWriteBytesFn=ut(a=>{var f,d;return null===(d=null===(f=a.detail)||void 0===f?void 0:f.metrics)||void 0===d?void 0:d["write-bytes"]}),this.sortWriteRecordsFn=ut(a=>{var f,d;return null===(d=null===(f=a.detail)||void 0===f?void 0:f.metrics)||void 0===d?void 0:d["write-records"]}),this.sortParallelismFn=ut(a=>a.parallelism),this.sortStartTimeFn=ut(a=>{var f;return null===(f=a.detail)||void 0===f?void 0:f["start-time"]}),this.sortDurationFn=ut(a=>{var f;return null===(f=a.detail)||void 0===f?void 0:f.duration}),this.sortEndTimeFn=ut(a=>{var f;return null===(f=a.detail)||void 0===f?void 0:f["end-time"]}),this.innerNodes=[],this.left=390,this.nodeClick=new t.vpe}set nodes(r){this.innerNodes=r}get nodes(){return this.innerNodes}clickNode(r){this.nodeClick.emit(r)}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(t.SBq))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-list"]],inputs:{selectedNode:"selectedNode",nodes:"nodes"},outputs:{nodeClick:"nodeClick"},decls:31,vars:22,consts:[[1,"no-border","small",3,"nzSize","nzData","nzScroll","nzFrontPagination","nzShowPagination"],["table",""],["nzLeft","",3,"nzWidth"],["nzWidth","120px",3,"nzSortFn"],["nzWidth","150px",3,"nzSortFn"],["nzWidth","100px","nzRight",""],["class","clickable",3,"selected","click",4,"ngFor","ngForOf","ngForTrackBy"],[3,"left","baseElement","resizeMin","leftChange"],["loadingTemplate",""],[1,"clickable",3,"click"],["nzLeft","",1,"name"],["nzTooltipPlacement","topLeft","nz-tooltip","",3,"nzTooltipTitle"],[3,"state"],[4,"ngIf","ngIfElse"],["nzRight",""],[3,"tasks"],[1,"text-secondary"]],template:function(r,a){if(1&r&&(t.TgZ(0,"nz-table",0,1),t.TgZ(2,"thead"),t.TgZ(3,"tr"),t.TgZ(4,"th",2),t._uU(5,"Name"),t.qZA(),t.TgZ(6,"th",3),t._uU(7,"Status"),t.qZA(),t.TgZ(8,"th",4),t._uU(9,"Bytes Received"),t.qZA(),t.TgZ(10,"th",4),t._uU(11,"Records Received"),t.qZA(),t.TgZ(12,"th",4),t._uU(13,"Bytes Sent"),t.qZA(),t.TgZ(14,"th",3),t._uU(15,"Records Sent"),t.qZA(),t.TgZ(16,"th",3),t._uU(17,"Parallelism"),t.qZA(),t.TgZ(18,"th",4),t._uU(19,"Start Time"),t.qZA(),t.TgZ(20,"th",4),t._uU(21,"Duration"),t.qZA(),t.TgZ(22,"th",4),t._uU(23,"End Time"),t.qZA(),t.TgZ(24,"th",5),t._uU(25,"Tasks"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"tbody"),t.YNc(27,wo,27,30,"tr",6),t.qZA(),t.qZA(),t.TgZ(28,"flink-resize",7),t.NdJ("leftChange",function(d){return a.left=d}),t.qZA(),t.YNc(29,yo,2,0,"ng-template",null,8,t.W1O)),2&r){const f=t.MAs(1);t.Q6J("nzSize","small")("nzData",a.nodes)("nzScroll",t.VKq(20,$r,1360+a.left+"px"))("nzFrontPagination",!1)("nzShowPagination",!1),t.xp6(4),t.Q6J("nzWidth",a.left+"px"),t.xp6(2),t.Q6J("nzSortFn",a.sortStatusFn),t.xp6(2),t.Q6J("nzSortFn",a.sortReadBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortReadRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortParallelismFn),t.xp6(2),t.Q6J("nzSortFn",a.sortStartTimeFn),t.xp6(2),t.Q6J("nzSortFn",a.sortDurationFn),t.xp6(2),t.Q6J("nzSortFn",a.sortEndTimeFn),t.xp6(5),t.Q6J("ngForOf",f.data)("ngForTrackBy",a.trackById),t.xp6(1),t.Q6J("left",a.left)("baseElement",a.elementRef)("resizeMin",390)}},directives:[D.N8,D.Om,D.$Z,D.Uo,D._C,D.qn,D.qD,D.p0,B.sg,vt.SY,po.A,B.O5,er.K,nr],pipes:[Xt.E,B.JJ,hn.c,le.w],styles:["[_nghost-%COMP%]{position:relative;display:flex;flex:1}[_nghost-%COMP%]   .text-secondary[_ngcontent-%COMP%]{color:#00000073;font-size:12px}.name[_ngcontent-%COMP%]{overflow:hidden}.name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{position:absolute;top:0;left:8px;display:inline-block;overflow:hidden;width:calc(100% - 12px);line-height:34px;text-overflow:ellipsis;white-space:nowrap}.selected[_ngcontent-%COMP%]{background:#e6f7ff;color:#000000d9}.selected[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#e6f7ff}"],changeDetection:0}),n})();function xo(n,s){1&n&&t._UZ(0,"nz-alert",4)}function bo(n,s){if(1&n){const r=t.EpF();t.ynx(0),t.TgZ(1,"flink-job-overview-list",5),t.NdJ("nodeClick",function(f){return t.CHM(r),t.oxw().onNodeClick(f)}),t.qZA(),t.TgZ(2,"flink-resize",6),t.NdJ("topChange",function(f){return t.CHM(r),t.oxw().top=f})("resizeEnd",function(){return t.CHM(r),t.oxw().onResizeEnd()}),t.qZA(),t.BQk()}if(2&n){const r=t.oxw();t.xp6(1),t.Q6J("nodes",r.nodes)("selectedNode",r.selectedNode),t.xp6(1),t.Q6J("top",r.top)("mode","horizontal")("baseElement",r.elementRef)("resizeMin",280)}}let Co=(()=>{class n{constructor(r,a,f,d,_,v){this.router=r,this.activatedRoute=a,this.elementRef=f,this.metricService=d,this.jobLocalService=_,this.cdr=v,this.nodes=[],this.links=[],this.top=500,this.destroy$=new rt.xQ}ngOnInit(){this.jobLocalService.jobDetailChanges().pipe((0,dr.h)(r=>r.jid===this.activatedRoute.parent.parent.snapshot.params.jid),(0,it.R)(this.destroy$)).subscribe(r=>{this.jobId!==r.plan.jid||0===this.nodes.length?(this.nodes=r.plan.nodes,this.links=r.plan.links,this.jobId=r.plan.jid,this.dagreComponent.flush(this.nodes,this.links,!0).then(),this.refreshNodesWithMetrics()):(this.nodes=r.plan.nodes,this.refreshNodesWithMetrics()),this.cdr.markForCheck()}),this.jobLocalService.selectedVertexChanges().pipe((0,it.R)(this.destroy$)).subscribe(r=>{r?this.dagreComponent.focusNode(r):this.selectedNode&&(this.timeoutId=setTimeout(()=>this.dagreComponent.redrawGraph())),this.selectedNode=r,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),clearTimeout(this.timeoutId)}onNodeClick(r){this.selectedNode&&this.selectedNode.id===r.id||this.router.navigate([r.id],{relativeTo:this.activatedRoute}).then()}onResizeEnd(){this.selectedNode?this.dagreComponent.focusNode(this.selectedNode,!0):this.dagreComponent.moveToCenter(),this.cdr.markForCheck()}refreshNodesWithMetrics(){this.mergeWithBackPressure(this.nodes).pipe((0,jt.zg)(r=>this.mergeWithWatermarks(r)),(0,it.R)(this.destroy$)).subscribe(r=>{r.forEach(a=>{this.dagreComponent.updateNode(a.id,a),this.cdr.markForCheck()})})}mergeWithBackPressure(r){return(0,tr.D)(r.map(a=>this.metricService.loadAggregatedMetrics(this.jobId,a.id,["backPressuredTimeMsPerSecond","busyTimeMsPerSecond"]).pipe((0,xt.U)(f=>Object.assign(Object.assign({},a),{backPressuredPercentage:Math.min(Math.round(f.backPressuredTimeMsPerSecond/10),100),busyPercentage:Math.min(Math.round(f.busyTimeMsPerSecond/10),100)}))))).pipe((0,Ut.K)(()=>(0,se.of)(r)))}mergeWithWatermarks(r){return(0,tr.D)(r.map(a=>this.metricService.loadWatermarks(this.jobId,a.id).pipe((0,xt.U)(f=>Object.assign(Object.assign({},a),{lowWatermark:f.lowWatermark}))))).pipe((0,Ut.K)(()=>(0,se.of)(r)))}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(at.F0),t.Y36(at.gz),t.Y36(t.SBq),t.Y36(In),t.Y36(Jt.R),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview"]],viewQuery:function(r,a){if(1&r&&t.Gf(Ct.B,7),2&r){let f;t.iGM(f=t.CRH())&&(a.dagreComponent=f.first)}},decls:5,vars:5,consts:[["nzShowIcon","","nzType","info","nzMessage","Job is not running yet.",4,"ngIf"],[1,"container"],[3,"xCenter","nodeClick"],[4,"ngIf"],["nzShowIcon","","nzType","info","nzMessage","Job is not running yet."],[3,"nodes","selectedNode","nodeClick"],[3,"top","mode","baseElement","resizeMin","topChange","resizeEnd"]],template:function(r,a){1&r&&(t.YNc(0,xo,1,0,"nz-alert",0),t.TgZ(1,"div",1),t.TgZ(2,"flink-dagre",2),t.NdJ("nodeClick",function(d){return a.onNodeClick(d)}),t.qZA(),t._UZ(3,"router-outlet"),t.qZA(),t.YNc(4,bo,3,6,"ng-container",3)),2&r&&(t.Q6J("ngIf",0===a.nodes.length),t.xp6(1),t.Udp("height",a.top,"px"),t.xp6(1),t.Q6J("xCenter",4),t.xp6(2),t.Q6J("ngIf",a.nodes.length>0))},directives:[B.O5,cn.r,Ct.B,at.lC,ir,nr],styles:[".container[_ngcontent-%COMP%]{position:relative;flex:0 1 auto;width:100%;border-bottom:solid 1px #f0f0f0}nz-radio-group[_ngcontent-%COMP%]{position:absolute;top:15px;right:24px;z-index:1;opacity:.7;transition:opacity ease-in .28s}nz-radio-group[_ngcontent-%COMP%]:hover{opacity:1}flink-dagre[_ngcontent-%COMP%]{position:absolute;left:0;width:100%;height:100%}flink-job-overview-drawer[_ngcontent-%COMP%]{position:absolute;right:0;width:60%;height:100%;border-left:solid 1px #f0f0f0;background:#fff}[_nghost-%COMP%]{position:relative;display:flex;flex:1;flex-flow:column nowrap}"],changeDetection:0}),n})();var ie=(()=>{return(n=ie||(ie={})).CREATED="CREATED",n.SCHEDULED="SCHEDULED",n.DEPLOYING="DEPLOYING",n.INITIALIZING="INITIALIZING",n.RUNNING="RUNNING",ie;var n})(),To=O(71470);function Ao(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["read-bytes"])," ")}}function zo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.xi3(2,1,r.metrics["read-records"],"1.0-0")," ")}}function Wo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["write-bytes"])," ")}}function ko(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.xi3(2,1,r.metrics["write-records"],"1.0-0")," ")}}function Mo(n,s){1&n&&(t.ynx(0),t._uU(1,"-"),t.BQk())}function Zo(n,s){if(1&n&&t._UZ(0,"flink-dynamic-host",21),2&n){const r=s.$implicit,a=t.oxw(4);t.Q6J("data",r)("component",a.durationBadgeComponent)}}function Oo(n,s){if(1&n&&t.YNc(0,Zo,1,2,"flink-dynamic-host",22),2&n){const r=t.oxw().ngIf,a=t.oxw(2);t.Q6J("ngForOf",a.convertStatusDuration(r["status-duration"]))}}function So(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["read-bytes"])," ")}}function or(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.metrics["read-records"],"1.0-0")," ")}}function Go(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["write-bytes"])," ")}}function jo(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.metrics["write-records"],"1.0-0")," ")}}function Wr(n,s){1&n&&(t.ynx(0),t._uU(1,"-"),t.BQk())}function No(n,s){if(1&n&&t._UZ(0,"flink-dynamic-host",21),2&n){const r=s.$implicit,a=t.oxw(6);t.Q6J("data",r)("component",a.durationBadgeComponent)}}function ar(n,s){if(1&n&&t.YNc(0,No,1,2,"flink-dynamic-host",22),2&n){const r=t.oxw().$implicit,a=t.oxw(4);t.Q6J("ngForOf",a.convertStatusDuration(r["status-duration"]))}}const Ge=function(n){return{state:n}};function Jo(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",24),t._uU(3),t.qZA(),t.TgZ(4,"td"),t.YNc(5,So,3,3,"span",18),t.qZA(),t.TgZ(6,"td"),t.YNc(7,or,3,4,"span",18),t.qZA(),t.TgZ(8,"td"),t.YNc(9,Go,3,3,"span",18),t.qZA(),t.TgZ(10,"td"),t.YNc(11,jo,3,4,"span",18),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"humanizeDate"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"humanizeDuration"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"humanizeDate"),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"humanizeDuration"),t.ALo(28,"humanizeDuration"),t.ALo(29,"humanizeDuration"),t.qZA(),t.TgZ(30,"td"),t.YNc(31,Wr,2,0,"ng-container",18),t.YNc(32,ar,1,1,"ng-template",null,19,t.W1O),t.qZA(),t.TgZ(34,"td",20),t._UZ(35,"flink-dynamic-host",21),t.qZA(),t._UZ(36,"td",20),t.qZA(),t.BQk()),2&n){const r=s.$implicit,a=t.MAs(33),f=t.oxw(2).ngIf,d=t.oxw(2),_=t.MAs(38);t.xp6(2),t.Q6J("nzIndentSize",8),t.xp6(1),t.Oqu(f.subtask),t.xp6(2),t.Q6J("ngIf",r.metrics["read-bytes-complete"])("ngIfElse",_),t.xp6(2),t.Q6J("ngIf",r.metrics["read-records-complete"])("ngIfElse",_),t.xp6(2),t.Q6J("ngIf",r.metrics["write-bytes-complete"])("ngIfElse",_),t.xp6(2),t.Q6J("ngIf",r.metrics["write-records-complete"])("ngIfElse",_),t.xp6(2),t.Oqu(r.attempt+1),t.xp6(2),t.Oqu(r.host),t.xp6(2),t.Oqu(t.xi3(18,22,r.start_time,"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.lcZ(21,25,r.duration)),t.xp6(3),t.Oqu(t.xi3(24,27,r["end-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.lnq(" ",t.lcZ(27,30,r.metrics["accumulated-backpressured-time"])," / ",t.lcZ(28,32,r.metrics["accumulated-idle-time"])," / ",t.lcZ(29,34,r.metrics["accumulated-busy-time"])," "),t.xp6(5),t.Q6J("ngIf",!r["status-duration"])("ngIfElse",a),t.xp6(4),t.Q6J("data",t.VKq(36,Ge,r.status))("component",d.stateBadgeComponent)}}function Do(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Jo,37,38,"ng-container",23),t.BQk()),2&n){const r=t.oxw().ngIf,a=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",r["other-concurrent-attempts"])("ngForTrackBy",a.trackBySubtaskAttempt)}}const Gr=function(n){return{subtask:n}};function qo(n,s){if(1&n){const r=t.EpF();t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",17),t.NdJ("nzExpandChange",function(f){const _=t.CHM(r).ngIf;return t.oxw(2).onExpandChange(_,f)}),t._uU(3),t.qZA(),t.TgZ(4,"td"),t.YNc(5,Ao,3,3,"span",18),t.qZA(),t.TgZ(6,"td"),t.YNc(7,zo,3,4,"span",18),t.qZA(),t.TgZ(8,"td"),t.YNc(9,Wo,3,3,"span",18),t.qZA(),t.TgZ(10,"td"),t.YNc(11,ko,3,4,"span",18),t.qZA(),t.TgZ(12,"td"),t._uU(13),t.qZA(),t.TgZ(14,"td"),t._uU(15),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"humanizeDate"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"humanizeDuration"),t.qZA(),t.TgZ(22,"td"),t._uU(23),t.ALo(24,"humanizeDate"),t.qZA(),t.TgZ(25,"td"),t._uU(26),t.ALo(27,"humanizeDuration"),t.ALo(28,"humanizeDuration"),t.ALo(29,"humanizeDuration"),t.qZA(),t.TgZ(30,"td"),t.YNc(31,Mo,2,0,"ng-container",18),t.YNc(32,Oo,1,1,"ng-template",null,19,t.W1O),t.qZA(),t.TgZ(34,"td",20),t._UZ(35,"flink-dynamic-host",21),t.qZA(),t.TgZ(36,"td",20),t._UZ(37,"flink-dynamic-host",21),t.qZA(),t.qZA(),t.YNc(38,Do,2,2,"ng-container",16),t.BQk()}if(2&n){const r=s.ngIf,a=t.MAs(33),f=t.oxw(2),d=t.MAs(38);t.xp6(2),t.Q6J("nzShowExpand",(null==r["other-concurrent-attempts"]?null:r["other-concurrent-attempts"].length)>0)("nzExpand",f.expandSet.has(r.subtask)),t.xp6(1),t.hij(" ",r.subtask," "),t.xp6(2),t.Q6J("ngIf",r.metrics["read-bytes-complete"])("ngIfElse",d),t.xp6(2),t.Q6J("ngIf",r.metrics["read-records-complete"])("ngIfElse",d),t.xp6(2),t.Q6J("ngIf",r.metrics["write-bytes-complete"])("ngIfElse",d),t.xp6(2),t.Q6J("ngIf",r.metrics["write-records-complete"])("ngIfElse",d),t.xp6(2),t.Oqu(r.attempt+1),t.xp6(2),t.Oqu(r.host),t.xp6(2),t.Oqu(t.xi3(18,26,r.start_time,"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.lcZ(21,29,r.duration)),t.xp6(3),t.Oqu(t.xi3(24,31,r["end-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.lnq(" ",t.lcZ(27,34,r.metrics["accumulated-backpressured-time"])," / ",t.lcZ(28,36,r.metrics["accumulated-idle-time"])," / ",t.lcZ(29,38,r.metrics["accumulated-busy-time"])," "),t.xp6(5),t.Q6J("ngIf",!r["status-duration"])("ngIfElse",a),t.xp6(4),t.Q6J("data",t.VKq(40,Ge,r.status))("component",f.stateBadgeComponent),t.xp6(2),t.Q6J("data",t.VKq(42,Gr,r))("component",f.actionComponent),t.xp6(1),t.Q6J("ngIf",f.expandSet.has(r.subtask))}}function Ce(n,s){if(1&n&&t.YNc(0,qo,39,44,"ng-container",16),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowType(r))}}function je(n,s){1&n&&(t.TgZ(0,"span",25),t._uU(1,"loading..."),t.qZA())}const Xe=function(){return{x:"2210px",y:"calc(100% - 36px)"}};function Zt(n){return(s,r)=>n(s)>n(r)?1:-1}let kn=(()=>{class n{constructor(r,a,f,d){var _,v,x;this.jobService=r,this.jobLocalService=a,this.cdr=f,this.moduleConfig=d,this.trackBySubtask=(T,z)=>z.subtask,this.trackBySubtaskAttempt=(T,z)=>`${z.subtask}-${z.attempt}`,this.sortReadBytesFn=Zt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["read-bytes"]}),this.sortReadRecordsFn=Zt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["read-records"]}),this.sortWriteBytesFn=Zt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["write-bytes"]}),this.sortWriteRecordsFn=Zt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["write-records"]}),this.sortAttemptFn=Zt(T=>T.attempt),this.sortHostFn=Zt(T=>T.host),this.sortStartTimeFn=Zt(T=>T.start_time),this.sortDurationFn=Zt(T=>T.duration),this.sortEndTimeFn=Zt(T=>T["end-time"]),this.sortStatusFn=Zt(T=>T.status),this.expandSet=new Set,this.listOfTask=[],this.isLoading=!0,this.narrowType=(0,wt.t)(),this.destroy$=new rt.xQ,this.actionComponent=(null===(_=d.customComponents)||void 0===_?void 0:_.subtaskActionComponent)||st.C.customComponents.subtaskActionComponent,this.durationBadgeComponent=(null===(v=d.customComponents)||void 0===v?void 0:v.durationBadgeComponent)||st.C.customComponents.durationBadgeComponent,this.stateBadgeComponent=(null===(x=d.customComponents)||void 0===x?void 0:x.stateBadgeComponent)||st.C.customComponents.stateBadgeComponent}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,jt.zg)(r=>this.jobService.loadSubTasks(r.job.jid,r.vertex.id).pipe((0,Ut.K)(()=>(0,se.of)(void 0)))),(0,it.R)(this.destroy$)).subscribe(r=>{this.listOfTask=(null==r?void 0:r.subtasks)||[],this.aggregated=null==r?void 0:r.aggregated,this.isLoading=!1,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}collapseAll(){this.expandSet.clear(),this.cdr.markForCheck()}onExpandChange(r,a){a?this.expandSet.add(r.subtask):this.expandSet.delete(r.subtask),this.cdr.markForCheck()}convertStatusDuration(r){return[ie.CREATED,ie.SCHEDULED,ie.DEPLOYING,ie.INITIALIZING,ie.RUNNING].map(f=>({state:f,duration:r[f]}))}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Je.O),t.Y36(Jt.R),t.Y36(t.sBO),t.Y36(st.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-subtasks"]],decls:39,vars:24,consts:[[3,"nzTabBarGutter","nzSize"],["nzTitle","Subtask Metrics"],["nzSize","small",3,"nzLoading","nzData","nzScroll","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMinBufferPx","nzVirtualMaxBufferPx","nzVirtualForTrackBy"],["nzWidth","120px","nzLeft",""],["nzWidth","140px",3,"nzSortFn","nzSortOrderChange"],["nzWidth","150px",3,"nzSortFn","nzSortOrderChange"],["nzWidth","120px",3,"nzSortFn","nzSortOrderChange"],["nzWidth","100px",3,"nzSortFn","nzSortOrderChange"],["nzWidth","200px",3,"nzSortFn","nzSortOrderChange"],["nzWidth","320px"],["nzWidth","120px","nzRight","",3,"nzSortFn","nzSortOrderChange"],["nzWidth","50px","nzRight",""],["nz-virtual-scroll",""],["nzTitle","Aggregated Metrics"],[3,"isLoading","aggregated"],["loadingTemplate",""],[4,"ngIf"],["nzLeft","",3,"nzShowExpand","nzExpand","nzExpandChange"],[4,"ngIf","ngIfElse"],["badges",""],["nzRight",""],[3,"data","component"],[3,"data","component",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf","ngForTrackBy"],["nzLeft","",3,"nzIndentSize"],[1,"text-secondary"]],template:function(r,a){1&r&&(t.TgZ(0,"nz-tabset",0),t.TgZ(1,"nz-tab",1),t.TgZ(2,"nz-table",2),t.TgZ(3,"thead"),t.TgZ(4,"tr"),t.TgZ(5,"th",3),t._uU(6,"ID"),t.qZA(),t.TgZ(7,"th",4),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(8," Bytes Received "),t.qZA(),t.TgZ(9,"th",5),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(10," Records Received "),t.qZA(),t.TgZ(11,"th",6),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(12," Bytes Sent "),t.qZA(),t.TgZ(13,"th",6),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(14," Records Sent "),t.qZA(),t.TgZ(15,"th",7),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(16," Attempt "),t.qZA(),t.TgZ(17,"th",8),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(18,"Host"),t.qZA(),t.TgZ(19,"th",5),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(20," Start Time "),t.qZA(),t.TgZ(21,"th",5),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(22," Duration "),t.qZA(),t.TgZ(23,"th",5),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(24," End Time "),t.qZA(),t.TgZ(25,"th",9),t._uU(26,"Accumulated Time (Backpressured/Idle/Busy)"),t.qZA(),t.TgZ(27,"th",9),t._uU(28,"Status Durations"),t.qZA(),t.TgZ(29,"th",10),t.NdJ("nzSortOrderChange",function(){return a.collapseAll()}),t._uU(30," Status "),t.qZA(),t.TgZ(31,"th",11),t._uU(32,"More"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(33,"tbody"),t.YNc(34,Ce,1,1,"ng-template",12),t.qZA(),t.qZA(),t.qZA(),t.TgZ(35,"nz-tab",13),t._UZ(36,"flink-table-aggregated-metrics",14),t.qZA(),t.qZA(),t.YNc(37,je,2,0,"ng-template",null,15,t.W1O)),2&r&&(t.Q6J("nzTabBarGutter",16)("nzSize","small"),t.xp6(2),t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfTask)("nzScroll",t.DdM(23,Xe))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",36)("nzVirtualMinBufferPx",720)("nzVirtualMaxBufferPx",720)("nzVirtualForTrackBy",a.trackBySubtask),t.xp6(5),t.Q6J("nzSortFn",a.sortReadBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortReadRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortAttemptFn),t.xp6(2),t.Q6J("nzSortFn",a.sortHostFn),t.xp6(2),t.Q6J("nzSortFn",a.sortStartTimeFn),t.xp6(2),t.Q6J("nzSortFn",a.sortDurationFn),t.xp6(2),t.Q6J("nzSortFn",a.sortEndTimeFn),t.xp6(6),t.Q6J("nzSortFn",a.sortStatusFn),t.xp6(7),t.Q6J("isLoading",a.isLoading)("aggregated",a.aggregated))},directives:[H.xH,H.xw,D.N8,D.Om,D.$Z,D.Uo,D._C,D.qn,D.qD,D.p0,D.zu,B.O5,D.h7,B.sg,un,To.B],pipes:[Xt.E,B.JJ,hn.c,le.w],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}[_nghost-%COMP%]   .text-secondary[_ngcontent-%COMP%]{color:#00000073;font-size:12px}[_nghost-%COMP%]   nz-tabset[_ngcontent-%COMP%]{height:100%}[_nghost-%COMP%]     .ant-table-row-indent{padding-left:0!important}[_nghost-%COMP%]     .ant-table-row-indent+.ant-table-row-expand-icon{margin-top:2px}[_nghost-%COMP%]     .ant-table-cell{font-size:12px}[_nghost-%COMP%]     .ant-tabs-content{height:100%}[_nghost-%COMP%]     .ant-tabs-content .ant-tabs-tabpane{height:100%}[_nghost-%COMP%]     .ant-tabs-nav{margin-bottom:0}[_nghost-%COMP%]     .ant-tabs-small>.ant-tabs-nav .ant-tabs-tab{margin:0 0 0 16px;font-size:12px}[_nghost-%COMP%]     ::-webkit-scrollbar{display:none}[_nghost-%COMP%]     nz-table, [_nghost-%COMP%]     nz-spin, [_nghost-%COMP%]     cdk-virtual-scroll-viewport, [_nghost-%COMP%]     nz-table-inner-scroll, [_nghost-%COMP%]     .ant-spin-container, [_nghost-%COMP%]     .ant-table{height:100%}"],changeDetection:0}),n})();function Ke(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["read-bytes"])," ")}}function Mn(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["read-records"])," ")}}function he(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"humanizeBytes"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["write-bytes"])," ")}}function Zn(n,s){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const r=t.oxw().ngIf;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.metrics["write-records"])," ")}}const tn=function(n){return{tasks:n}},jr=function(n){return{state:n}},Ot=function(n){return{taskManager:n}};function Fo(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td",11),t.TgZ(3,"span",12),t._uU(4),t.qZA(),t.qZA(),t.TgZ(5,"td"),t.YNc(6,Ke,3,3,"span",13),t.qZA(),t.TgZ(7,"td"),t.YNc(8,Mn,3,3,"span",13),t.qZA(),t.TgZ(9,"td"),t.YNc(10,he,3,3,"span",13),t.qZA(),t.TgZ(11,"td"),t.YNc(12,Zn,3,3,"span",13),t.qZA(),t.TgZ(13,"td"),t._uU(14),t.ALo(15,"humanizeDate"),t.qZA(),t.TgZ(16,"td"),t._uU(17),t.ALo(18,"humanizeDate"),t.qZA(),t.TgZ(19,"td"),t._uU(20),t.ALo(21,"humanizeDuration"),t.qZA(),t.TgZ(22,"td"),t._UZ(23,"flink-dynamic-host",14),t.qZA(),t.TgZ(24,"td",15),t._UZ(25,"flink-dynamic-host",14),t.qZA(),t.TgZ(26,"td",15),t._UZ(27,"flink-dynamic-host",14),t.qZA(),t.qZA(),t.BQk()),2&n){const r=s.ngIf,a=t.oxw(2),f=t.MAs(28);t.xp6(4),t.Oqu(r.host),t.xp6(2),t.Q6J("ngIf",r.metrics["read-bytes-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",r.metrics["read-records-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",r.metrics["write-bytes-complete"])("ngIfElse",f),t.xp6(2),t.Q6J("ngIf",r.metrics["write-records-complete"])("ngIfElse",f),t.xp6(2),t.Oqu(t.xi3(15,18,r["start-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.xi3(18,21,r["end-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.lcZ(21,24,r.duration)),t.xp6(3),t.Q6J("data",t.VKq(26,tn,r["status-counts"]))("component",a.taskCountBadgeComponent),t.xp6(2),t.Q6J("data",t.VKq(28,jr,r.status))("component",a.stateBadgeComponent),t.xp6(2),t.Q6J("data",t.VKq(30,Ot,r))("component",a.actionComponent)}}function en(n,s){if(1&n&&t.YNc(0,Fo,28,32,"ng-container",10),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowLogData(r))}}function It(n,s){1&n&&t._UZ(0,"i",16)}const Xo=function(){return{x:"1550px",y:"calc( 100% - 36px )"}};function Wt(n){return(s,r)=>n(s)>n(r)?1:-1}let Po=(()=>{class n{constructor(r,a,f,d){var _,v,x;this.jobService=r,this.jobLocalService=a,this.cdr=f,this.moduleConfig=d,this.trackByHost=(T,z)=>z.host,this.sortReadBytesFn=Wt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["read-bytes"]}),this.sortReadRecordsFn=Wt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["read-records"]}),this.sortWriteBytesFn=Wt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["write-bytes"]}),this.sortWriteRecordsFn=Wt(T=>{var z;return null===(z=T.metrics)||void 0===z?void 0:z["write-records"]}),this.sortHostFn=Wt(T=>T.host),this.sortStartTimeFn=Wt(T=>T["start-time"]),this.sortDurationFn=Wt(T=>T.duration),this.sortEndTimeFn=Wt(T=>T["end-time"]),this.sortStatusFn=Wt(T=>T.status),this.listOfTaskManager=[],this.isLoading=!0,this.virtualItemSize=36,this.narrowLogData=(0,wt.t)(),this.destroy$=new rt.xQ,this.actionComponent=(null===(_=d.customComponents)||void 0===_?void 0:_.taskManagerActionComponent)||st.C.customComponents.taskManagerActionComponent,this.taskCountBadgeComponent=(null===(v=d.customComponents)||void 0===v?void 0:v.taskCountBadgeComponent)||st.C.customComponents.taskCountBadgeComponent,this.stateBadgeComponent=(null===(x=d.customComponents)||void 0===x?void 0:x.stateBadgeComponent)||st.C.customComponents.stateBadgeComponent}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,jt.zg)(r=>this.jobService.loadTaskManagers(r.job.jid,r.vertex.id).pipe((0,xt.U)(a=>a.taskmanagers),(0,Ut.K)(()=>(0,se.of)([])))),(0,it.R)(this.destroy$)).subscribe(r=>{this.listOfTaskManager=r,this.isLoading=!1,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Je.O),t.Y36(Jt.R),t.Y36(t.sBO),t.Y36(st.s))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-taskmanagers"]],decls:29,vars:19,consts:[["nzSize","small",3,"nzLoading","nzData","nzScroll","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMinBufferPx","nzVirtualMaxBufferPx","nzVirtualForTrackBy"],["nzWidth","160px","nzLeft","",3,"nzSortFn"],["nzWidth","150px",3,"nzSortFn"],["nzWidth","120px",3,"nzSortFn"],["nzWidth","200px",3,"nzSortFn"],["nzWidth","120px"],["nzWidth","100px","nzRight","",3,"nzSortFn"],["nzWidth","50px","nzRight",""],["nz-virtual-scroll",""],["loadingTemplate",""],[4,"ngIf"],["nzLeft",""],[1,"ellipsis-cell"],[4,"ngIf","ngIfElse"],[3,"data","component"],["nzRight",""],["nz-icon","","nzType","loading"]],template:function(r,a){1&r&&(t.TgZ(0,"nz-table",0),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th",1),t._uU(4,"Host"),t.qZA(),t.TgZ(5,"th",2),t._uU(6,"Bytes received"),t.qZA(),t.TgZ(7,"th",2),t._uU(8,"Records received"),t.qZA(),t.TgZ(9,"th",3),t._uU(10,"Bytes sent"),t.qZA(),t.TgZ(11,"th",2),t._uU(12,"Records sent"),t.qZA(),t.TgZ(13,"th",4),t._uU(14,"Start Time"),t.qZA(),t.TgZ(15,"th",4),t._uU(16,"End Time"),t.qZA(),t.TgZ(17,"th",2),t._uU(18,"Duration"),t.qZA(),t.TgZ(19,"th",5),t._uU(20,"Tasks"),t.qZA(),t.TgZ(21,"th",6),t._uU(22,"Status"),t.qZA(),t.TgZ(23,"th",7),t._uU(24,"More"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"tbody"),t.YNc(26,en,1,1,"ng-template",8),t.qZA(),t.qZA(),t.YNc(27,It,1,0,"ng-template",null,9,t.W1O)),2&r&&(t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfTaskManager)("nzScroll",t.DdM(18,Xo))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",a.virtualItemSize)("nzVirtualMinBufferPx",300)("nzVirtualMaxBufferPx",300)("nzVirtualForTrackBy",a.trackByHost),t.xp6(3),t.Q6J("nzSortFn",a.sortHostFn),t.xp6(2),t.Q6J("nzSortFn",a.sortReadBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortReadRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteBytesFn),t.xp6(2),t.Q6J("nzSortFn",a.sortWriteRecordsFn),t.xp6(2),t.Q6J("nzSortFn",a.sortStartTimeFn),t.xp6(2),t.Q6J("nzSortFn",a.sortEndTimeFn),t.xp6(2),t.Q6J("nzSortFn",a.sortDurationFn),t.xp6(4),t.Q6J("nzSortFn",a.sortStatusFn))},directives:[D.N8,D.Om,D.$Z,D.Uo,D._C,D.qn,D.qD,D.p0,D.zu,B.O5,un,F.Ls],pipes:[Xt.E,B.JJ,hn.c,le.w],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100%}[_nghost-%COMP%]   .ellipsis-cell[_ngcontent-%COMP%]{display:block;overflow:hidden;width:100%;text-overflow:ellipsis;white-space:nowrap}[_nghost-%COMP%]     .ant-table-cell{font-size:12px}[_nghost-%COMP%]     ::-webkit-scrollbar{display:none}[_nghost-%COMP%]     nz-table, [_nghost-%COMP%]     nz-spin, [_nghost-%COMP%]     cdk-virtual-scroll-viewport, [_nghost-%COMP%]     nz-table-inner-scroll, [_nghost-%COMP%]     .ant-spin-container, [_nghost-%COMP%]     .ant-table{height:100%}"]}),n})(),Eo=(()=>{class n{constructor(r){this.configService=r}transform(r){return isNaN(r)||r<=this.configService.LONG_MIN_VALUE?"No Watermark (Watermarks are only available if EventTime is used)":r}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(_r.E,16))},n.\u0275pipe=t.Yjl({name:"humanizeWatermark",type:n,pure:!0}),n})();function sr(n,s){if(1&n&&(t.ynx(0),t.TgZ(1,"tr"),t.TgZ(2,"td"),t._uU(3),t.qZA(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"humanizeWatermark"),t.qZA(),t.qZA(),t.BQk()),2&n){const r=s.ngIf;t.xp6(3),t.Oqu(r.subTaskIndex),t.xp6(2),t.Oqu(t.lcZ(6,2,r.watermark))}}function Xr(n,s){if(1&n&&t.YNc(0,sr,7,4,"ng-container",3),2&n){const r=s.$implicit,a=t.oxw();t.Q6J("ngIf",a.narrowLogData(r))}}const Kr=function(){return{y:"calc( 100% - 36px )"}},o=[{path:"",component:Co,children:[{path:":vertexId",component:Bi,children:[{path:"detail",component:Ln,data:{path:"detail"}},{path:"subtasks",component:kn,data:{path:"subtasks"}},{path:"taskmanagers",component:Po,data:{path:"taskmanagers"}},{path:"watermarks",component:(()=>{class n{constructor(r,a,f){this.jobLocalService=r,this.metricsService=a,this.cdr=f,this.trackBySubtaskIndex=(d,_)=>_.subTaskIndex,this.listOfWaterMark=[],this.isLoading=!0,this.virtualItemSize=36,this.narrowLogData=(0,wt.t)(),this.destroy$=new rt.xQ}ngOnInit(){this.jobLocalService.jobWithVertexChanges().pipe((0,jt.zg)(r=>this.metricsService.loadWatermarks(r.job.jid,r.vertex.id).pipe((0,xt.U)(a=>{const f=[];for(const d in a.watermarks)f.push({subTaskIndex:+d,watermark:a.watermarks[d]});return f}),(0,Ut.K)(()=>(0,se.of)([])))),(0,it.R)(this.destroy$)).subscribe(r=>{this.isLoading=!1,this.listOfWaterMark=r,this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(r){return new(r||n)(t.Y36(Jt.R),t.Y36(In),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["flink-job-overview-drawer-watermarks"]],decls:9,vars:10,consts:[["nzSize","small",1,"no-border","small","full-height",3,"nzLoading","nzData","nzScroll","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMinBufferPx","nzVirtualMaxBufferPx","nzVirtualForTrackBy"],["nzWidth","50%"],["nz-virtual-scroll",""],[4,"ngIf"]],template:function(r,a){1&r&&(t.TgZ(0,"nz-table",0),t.TgZ(1,"thead"),t.TgZ(2,"tr"),t.TgZ(3,"th",1),t._uU(4,"SubTask"),t.qZA(),t.TgZ(5,"th",1),t._uU(6,"Watermark"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"tbody"),t.YNc(8,Xr,1,1,"ng-template",2),t.qZA(),t.qZA()),2&r&&t.Q6J("nzLoading",a.isLoading)("nzData",a.listOfWaterMark)("nzScroll",t.DdM(9,Kr))("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",a.virtualItemSize)("nzVirtualMinBufferPx",300)("nzVirtualMaxBufferPx",300)("nzVirtualForTrackBy",a.trackBySubtaskIndex)},directives:[D.N8,D.Om,D.$Z,D.Uo,D._C,D.p0,D.zu,B.O5],pipes:[Eo],styles:["[_nghost-%COMP%]     .ant-table-cell{font-size:12px}[_nghost-%COMP%]     ::-webkit-scrollbar{display:none}[_nghost-%COMP%]     nz-table, [_nghost-%COMP%]     nz-spin, [_nghost-%COMP%]     cdk-virtual-scroll-viewport, [_nghost-%COMP%]     nz-table-inner-scroll, [_nghost-%COMP%]     .ant-spin-container, [_nghost-%COMP%]     .ant-table{height:100%}"],changeDetection:0}),n})(),data:{path:"watermarks"}},{path:"accumulators",component:ci,data:{path:"accumulators"}},{path:"metrics",component:Oi,data:{path:"metrics"}},{path:"backpressure",component:xi,data:{path:"backpressure"}},{path:"flamegraph",component:Yr,data:{path:"flamegraph"}}]}]}];let c=(()=>{class n{}return n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[at.Bz.forChild(o)],at.Bz]}),n})(),h=(()=>{class n{}return n.\u0275fac=function(r){return new(r||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[B.ez,dt.u5,Jn.G,c,D.HQ,vt.cg,L.aF,K.j,F.PV,Dn.U5,X.LV,cn.L,Se.S,H.we,Ne.b1,G.Qp]]}),n})()},73925:(Nn,j,O)=>{"use strict";function B(){return dt=>dt}O.d(j,{t:()=>B})},25332:Nn=>{self,Nn.exports=(()=>{"use strict";var j={d:(F,G)=>{for(var L in G)j.o(G,L)&&!j.o(F,L)&&Object.defineProperty(F,L,{enumerable:!0,get:G[L]})},o:(F,G)=>Object.prototype.hasOwnProperty.call(F,G),r:F=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(F,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(F,"__esModule",{value:!0})}},O={};function cn(F,G){return F.highlight?G:`rgb(${function Jn(F,G,L){const X=L,K=1-X;return[Math.round(F[0]*X+G[0]*K),Math.round(F[1]*X+G[1]*K),Math.round(F[2]*X+G[2]*K)]}([0,255,40],[196,245,233],F.data.value/F.value).join()})`}function Se(F,G){if(F.highlight)return G;const X=function dt(F){let G=0;if(F){const L=F.split("`");L.length>1&&(F=L[L.length-1]),G=function B(F){let L=0,X=0,K=1;if(F){for(let H=0;H<F.length&&!(H>6);H++)L+=K*(F.charCodeAt(H)%10),X+=9*K,K*=.7;X>0&&(L/=X)}return L}(F=F.split("(")[0])}return G}(F.data.n||F.data.name);return"rgb("+(0+Math.round(55*(1-X)))+","+(0+Math.round(230*(1-X)))+","+(200+Math.round(55*X))+")"}function Ne(F,G){let L=G;const{v8_jit:X,javascript:K,optimized:D}=F.data.extras||{};if(X&&!K&&(L="#dadada"),K){let H=(D||0)/F.value,vt=255,at=0,rt=0;H<.4?(H*=2.5,vt=240-200*H):H<.9?(H=2*(H-.4),vt=0,rt=200-200*H,at=100*H):(H=10*(H-.9),vt=0,rt=0,at=100+150*H),L=`rgb(${vt} , ${at}, ${rt})`}return L}function Dn(F,G){if(F.highlight)return G;let L=220,X=220,K=220;const D=F.delta||F.data.d||F.data.delta,H=Math.abs(D);let vt=F.value||F.data.v||F.data.value;vt<=H&&(vt=H);const at=H/vt;return D===vt?(L=255,X=190,K=90):D>0?(K=Math.round(235*(1-at)),X=K):D<0&&(L=Math.round(235*(1-at)),X=L),"rgb("+L+","+X+","+K+")"}return j.r(O),j.d(O,{allocationColorMapper:()=>cn,differentialColorMapper:()=>Dn,nodeJsColorMapper:()=>Ne,offCpuColorMapper:()=>Se}),O})()},31829:Nn=>{self,Nn.exports=(()=>{"use strict";var j={d:(o,c)=>{for(var h in c)j.o(c,h)&&!j.o(o,h)&&Object.defineProperty(o,h,{enumerable:!0,get:c[h]})},o:(o,c)=>Object.prototype.hasOwnProperty.call(o,c),r:o=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})}},O={};function B(){}function dt(o){return null==o?B:function(){return this.querySelector(o)}}function cn(o){return null==o?[]:Array.isArray(o)?o:Array.from(o)}function Se(){return[]}function Ne(o){return null==o?Se:function(){return this.querySelectorAll(o)}}function G(o){return function(){return this.matches(o)}}function L(o){return function(c){return c.matches(o)}}j.r(O),j.d(O,{defaultFlamegraphTooltip:()=>Ko});var X=Array.prototype.find;function D(){return this.firstElementChild}var vt=Array.prototype.filter;function at(){return Array.from(this.children)}function Ut(o){return new Array(o.length)}function wt(o,c){this.ownerDocument=o.ownerDocument,this.namespaceURI=o.namespaceURI,this._next=null,this._parent=o,this.__data__=c}function t(o){return function(){return o}}function Je(o,c,h,n,s,r){for(var f,a=0,d=c.length,_=r.length;a<_;++a)(f=c[a])?(f.__data__=r[a],n[a]=f):h[a]=new wt(o,r[a]);for(;a<d;++a)(f=c[a])&&(s[a]=f)}function Jt(o,c,h,n,s,r,a){var f,d,z,_=new Map,v=c.length,x=r.length,T=new Array(v);for(f=0;f<v;++f)(d=c[f])&&(T[f]=z=a.call(d,d.__data__,f,c)+"",_.has(z)?s[f]=d:_.set(z,d));for(f=0;f<x;++f)z=a.call(o,r[f],f,r)+"",(d=_.get(z))?(n[f]=d,d.__data__=r[f],_.delete(z)):h[f]=new wt(o,r[f]);for(f=0;f<v;++f)(d=c[f])&&_.get(T[f])===d&&(s[f]=d)}function oi(o){return o.__data__}function si(o){return"object"==typeof o&&"length"in o?o:Array.from(o)}function pr(o,c){return o<c?-1:o>c?1:o>=c?0:NaN}wt.prototype={constructor:wt,appendChild:function(o){return this._parent.insertBefore(o,this._next)},insertBefore:function(o,c){return this._parent.insertBefore(o,c)},querySelector:function(o){return this._parent.querySelector(o)},querySelectorAll:function(o){return this._parent.querySelectorAll(o)}};var ce="http://www.w3.org/1999/xhtml";const qn={svg:"http://www.w3.org/2000/svg",xhtml:ce,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ue(o){var c=o+="",h=c.indexOf(":");return h>=0&&"xmlns"!==(c=o.slice(0,h))&&(o=o.slice(h+1)),qn.hasOwnProperty(c)?{space:qn[c],local:o}:o}function di(o){return function(){this.removeAttribute(o)}}function gi(o){return function(){this.removeAttributeNS(o.space,o.local)}}function mi(o,c){return function(){this.setAttribute(o,c)}}function _i(o,c){return function(){this.setAttributeNS(o.space,o.local,c)}}function vi(o,c){return function(){var h=c.apply(this,arguments);null==h?this.removeAttribute(o):this.setAttribute(o,h)}}function wi(o,c){return function(){var h=c.apply(this,arguments);null==h?this.removeAttributeNS(o.space,o.local):this.setAttributeNS(o.space,o.local,h)}}function Fn(o){return o.ownerDocument&&o.ownerDocument.defaultView||o.document&&o||o.defaultView}function xi(o){return function(){this.style.removeProperty(o)}}function bi(o,c,h){return function(){this.style.setProperty(o,c,h)}}function dr(o,c,h){return function(){var n=c.apply(this,arguments);null==n?this.style.removeProperty(o):this.style.setProperty(o,n,h)}}function yt(o,c){return o.style.getPropertyValue(c)||Fn(o).getComputedStyle(o,null).getPropertyValue(c)}function gr(o){return function(){delete this[o]}}function mr(o,c){return function(){this[o]=c}}function Ti(o,c){return function(){var h=c.apply(this,arguments);null==h?delete this[o]:this[o]=h}}function Xt(o){return o.trim().split(/^|\s+/)}function De(o){return o.classList||new En(o)}function En(o){this._node=o,this._names=Xt(o.getAttribute("class")||"")}function fn(o,c){for(var h=De(o),n=-1,s=c.length;++n<s;)h.add(c[n])}function xt(o,c){for(var h=De(o),n=-1,s=c.length;++n<s;)h.remove(c[n])}function Ai(o){return function(){fn(this,o)}}function _r(o){return function(){xt(this,o)}}function In(o,c){return function(){(c.apply(this,arguments)?fn:xt)(this,o)}}function ki(){this.textContent=""}function Mi(o){return function(){this.textContent=o}}function Zi(o){return function(){var c=o.apply(this,arguments);this.textContent=null==c?"":c}}function vr(){this.innerHTML=""}function hn(o){return function(){this.innerHTML=o}}function Si(o){return function(){var c=o.apply(this,arguments);this.innerHTML=null==c?"":c}}function Ji(){this.nextSibling&&this.parentNode.appendChild(this)}function qi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Pi(o){return function(){var c=this.ownerDocument,h=this.namespaceURI;return h===ce&&c.documentElement.namespaceURI===ce?c.createElement(o):c.createElementNS(h,o)}}function Ei(o){return function(){return this.ownerDocument.createElementNS(o.space,o.local)}}function Ln(o){var c=ue(o);return(c.local?Ei:Pi)(c)}function Ii(){return null}function Bi(){var o=this.parentNode;o&&o.removeChild(this)}function Ri(){var o=this.cloneNode(!1),c=this.parentNode;return c?c.insertBefore(o,this.nextSibling):o}function Qi(){var o=this.cloneNode(!0),c=this.parentNode;return c?c.insertBefore(o,this.nextSibling):o}function wr(o){return o.trim().split(/^|\s+/).map(function(c){var h="",n=c.indexOf(".");return n>=0&&(h=c.slice(n+1),c=c.slice(0,n)),{type:c,name:h}})}function bt(o){return function(){var c=this.__on;if(c){for(var r,h=0,n=-1,s=c.length;h<s;++h)r=c[h],o.type&&r.type!==o.type||r.name!==o.name?c[++n]=r:this.removeEventListener(r.type,r.listener,r.options);++n?c.length=n:delete this.__on}}}function pn(o,c,h){return function(){var s,n=this.__on,r=function Hi(o){return function(c){o.call(this,c,this.__data__)}}(c);if(n)for(var a=0,f=n.length;a<f;++a)if((s=n[a]).type===o.type&&s.name===o.name)return this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=r,s.options=h),void(s.value=c);this.addEventListener(o.type,r,h),s={type:o.type,name:o.name,value:c,listener:r,options:h},n?n.push(s):this.__on=[s]}}function dn(o,c,h){var n=Fn(o),s=n.CustomEvent;"function"==typeof s?s=new s(c,h):(s=n.document.createEvent("Event"),h?(s.initEvent(c,h.bubbles,h.cancelable),s.detail=h.detail):s.initEvent(c,!1,!1)),o.dispatchEvent(s)}function Vo(o,c){return function(){return dn(this,o,c)}}function Yi(o,c){return function(){return dn(this,o,c.apply(this,arguments))}}En.prototype={add:function(o){this._names.indexOf(o)<0&&(this._names.push(o),this._node.setAttribute("class",this._names.join(" ")))},remove:function(o){var c=this._names.indexOf(o);c>=0&&(this._names.splice(c,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(o){return this._names.indexOf(o)>=0}};var gn=[null];function Y(o,c){this._groups=o,this._parents=c}function Qt(){return new Y([[document.documentElement]],gn)}Y.prototype=Qt.prototype={constructor:Y,select:function Jn(o){"function"!=typeof o&&(o=dt(o));for(var c=this._groups,h=c.length,n=new Array(h),s=0;s<h;++s)for(var d,_,r=c[s],a=r.length,f=n[s]=new Array(a),v=0;v<a;++v)(d=r[v])&&(_=o.call(d,d.__data__,v,r))&&("__data__"in d&&(_.__data__=d.__data__),f[v]=_);return new Y(n,this._parents)},selectAll:function F(o){o="function"==typeof o?function Dn(o){return function(){return cn(o.apply(this,arguments))}}(o):Ne(o);for(var c=this._groups,h=c.length,n=[],s=[],r=0;r<h;++r)for(var d,a=c[r],f=a.length,_=0;_<f;++_)(d=a[_])&&(n.push(o.call(d,d.__data__,_,a)),s.push(d));return new Y(n,s)},selectChild:function H(o){return this.select(null==o?D:function K(o){return function(){return X.call(this.children,o)}}("function"==typeof o?o:L(o)))},selectChildren:function se(o){return this.selectAll(null==o?at:function rt(o){return function(){return vt.call(this.children,o)}}("function"==typeof o?o:L(o)))},filter:function jt(o){"function"!=typeof o&&(o=G(o));for(var c=this._groups,h=c.length,n=new Array(h),s=0;s<h;++s)for(var d,r=c[s],a=r.length,f=n[s]=[],_=0;_<a;++_)(d=r[_])&&o.call(d,d.__data__,_,r)&&f.push(d);return new Y(n,this._parents)},data:function ai(o,c){if(!arguments.length)return Array.from(this,oi);var h=c?Jt:Je,n=this._parents,s=this._groups;"function"!=typeof o&&(o=t(o));for(var r=s.length,a=new Array(r),f=new Array(r),d=new Array(r),_=0;_<r;++_){var v=n[_],x=s[_],T=x.length,z=si(o.call(v,v&&v.__data__,_,n)),E=z.length,I=f[_]=new Array(E),Q=a[_]=new Array(E);h(v,x,I,Q,d[_]=new Array(T),z,c);for(var oe,Nt,At=0,St=0;At<E;++At)if(oe=I[At]){for(At>=St&&(St=At+1);!(Nt=Q[St])&&++St<E;);oe._next=Nt||null}}return(a=new Y(a,n))._enter=f,a._exit=d,a},enter:function it(){return new Y(this._enter||this._groups.map(Ut),this._parents)},exit:function li(){return new Y(this._exit||this._groups.map(Ut),this._parents)},join:function fr(o,c,h){var n=this.enter(),s=this,r=this.exit();return"function"==typeof o?(n=o(n))&&(n=n.selection()):n=n.append(o+""),null!=c&&(s=c(s))&&(s=s.selection()),null==h?r.remove():h(r),n&&s?n.merge(s).order():s},merge:function ci(o){for(var c=o.selection?o.selection():o,h=this._groups,n=c._groups,s=h.length,a=Math.min(s,n.length),f=new Array(s),d=0;d<a;++d)for(var z,_=h[d],v=n[d],x=_.length,T=f[d]=new Array(x),E=0;E<x;++E)(z=_[E]||v[E])&&(T[E]=z);for(;d<s;++d)f[d]=h[d];return new Y(f,this._parents)},selection:function Wi(){return this},order:function hr(){for(var o=this._groups,c=-1,h=o.length;++c<h;)for(var a,n=o[c],s=n.length-1,r=n[s];--s>=0;)(a=n[s])&&(r&&4^a.compareDocumentPosition(r)&&r.parentNode.insertBefore(a,r),r=a);return this},sort:function st(o){function c(x,T){return x&&T?o(x.__data__,T.__data__):!x-!T}o||(o=pr);for(var h=this._groups,n=h.length,s=new Array(n),r=0;r<n;++r){for(var _,a=h[r],f=a.length,d=s[r]=new Array(f),v=0;v<f;++v)(_=a[v])&&(d[v]=_);d.sort(c)}return new Y(s,this._parents).order()},call:function ui(){var o=arguments[0];return arguments[0]=this,o.apply(null,arguments),this},nodes:function un(){return Array.from(this)},node:function le(){for(var o=this._groups,c=0,h=o.length;c<h;++c)for(var n=o[c],s=0,r=n.length;s<r;++s){var a=n[s];if(a)return a}return null},size:function fi(){let o=0;for(const c of this)++o;return o},empty:function hi(){return!this.node()},each:function pi(o){for(var c=this._groups,h=0,n=c.length;h<n;++h)for(var f,s=c[h],r=0,a=s.length;r<a;++r)(f=s[r])&&o.call(f,f.__data__,r,s);return this},attr:function yi(o,c){var h=ue(o);if(arguments.length<2){var n=this.node();return h.local?n.getAttributeNS(h.space,h.local):n.getAttribute(h)}return this.each((null==c?h.local?gi:di:"function"==typeof c?h.local?wi:vi:h.local?_i:mi)(h,c))},style:function Ci(o,c,h){return arguments.length>1?this.each((null==c?xi:"function"==typeof c?dr:bi)(o,c,null==h?"":h)):yt(this.node(),o)},property:function Pn(o,c){return arguments.length>1?this.each((null==c?gr:"function"==typeof c?Ti:mr)(o,c)):this.node()[o]},classed:function zi(o,c){var h=Xt(o+"");if(arguments.length<2){for(var n=De(this.node()),s=-1,r=h.length;++s<r;)if(!n.contains(h[s]))return!1;return!0}return this.each(("function"==typeof c?In:c?Ai:_r)(h,c))},text:function Oi(o){return arguments.length?this.each(null==o?ki:("function"==typeof o?Zi:Mi)(o)):this.node().textContent},html:function Ni(o){return arguments.length?this.each(null==o?vr:("function"==typeof o?Si:hn)(o)):this.node().innerHTML},raise:function Di(){return this.each(Ji)},lower:function Fi(){return this.each(qi)},append:function Rt(o){var c="function"==typeof o?o:Ln(o);return this.select(function(){return this.appendChild(c.apply(this,arguments))})},insert:function Li(o,c){var h="function"==typeof o?o:Ln(o),n=null==c?Ii:"function"==typeof c?c:dt(c);return this.select(function(){return this.insertBefore(h.apply(this,arguments),n.apply(this,arguments)||null)})},remove:function Ui(){return this.each(Bi)},clone:function Vi(o){return this.select(o?Qi:Ri)},datum:function Qo(o){return arguments.length?this.property("__data__",o):this.node().__data__},on:function yr(o,c,h){var s,a,n=wr(o+""),r=n.length;if(!(arguments.length<2)){for(f=c?pn:bt,s=0;s<r;++s)this.each(f(n[s],c,h));return this}var f=this.node().__on;if(f)for(var v,d=0,_=f.length;d<_;++d)for(s=0,v=f[d];s<r;++s)if((a=n[s]).type===v.type&&a.name===v.name)return v.value},dispatch:function $i(o,c){return this.each(("function"==typeof c?Yi:Vo)(o,c))},[Symbol.iterator]:function*xr(){for(var o=this._groups,c=0,h=o.length;c<h;++c)for(var a,n=o[c],s=0,r=n.length;s<r;++s)(a=n[s])&&(yield a)}};const Kt=Qt;var br={value:()=>{}};function qe(){for(var n,o=0,c=arguments.length,h={};o<c;++o){if(!(n=arguments[o]+"")||n in h||/[\s.]/.test(n))throw new Error("illegal type: "+n);h[n]=[]}return new Vt(h)}function Vt(o){this._=o}function Gi(o,c){return o.trim().split(/^|\s+/).map(function(h){var n="",s=h.indexOf(".");if(s>=0&&(n=h.slice(s+1),h=h.slice(0,s)),h&&!c.hasOwnProperty(h))throw new Error("unknown type: "+h);return{type:h,name:n}})}function ji(o,c){for(var s,h=0,n=o.length;h<n;++h)if((s=o[h]).name===c)return s.value}function Cr(o,c,h){for(var n=0,s=o.length;n<s;++n)if(o[n].name===c){o[n]=br,o=o.slice(0,n).concat(o.slice(n+1));break}return null!=h&&o.push({name:c,value:h}),o}Vt.prototype=qe.prototype={constructor:Vt,on:function(o,c){var s,h=this._,n=Gi(o+"",h),r=-1,a=n.length;if(!(arguments.length<2)){if(null!=c&&"function"!=typeof c)throw new Error("invalid callback: "+c);for(;++r<a;)if(s=(o=n[r]).type)h[s]=Cr(h[s],o.name,c);else if(null==c)for(s in h)h[s]=Cr(h[s],o.name,null);return this}for(;++r<a;)if((s=(o=n[r]).type)&&(s=ji(h[s],o.name)))return s},copy:function(){var o={},c=this._;for(var h in c)o[h]=c[h].slice();return new Vt(o)},call:function(o,c){if((s=arguments.length-2)>0)for(var s,r,h=new Array(s),n=0;n<s;++n)h[n]=arguments[n+2];if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(n=0,s=(r=this._[o]).length;n<s;++n)r[n].value.apply(c,h)},apply:function(o,c,h){if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(var n=this._[o],s=0,r=n.length;s<r;++s)n[s].value.apply(c,h)}};const _n=qe;var me,_e,Ht=0,Fe=0,Yt=0,Pe=0,te=0,Ee=0,Ie="object"==typeof performance&&performance.now?performance:Date,Le="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(o){setTimeout(o,17)};function ve(){return te||(Le(Ar),te=Ie.now()+Ee)}function Ar(){te=0}function vn(){this._call=this._time=this._next=null}function Be(o,c,h){var n=new vn;return n.restart(o,c,h),n}function zr(){te=(Pe=Ie.now())+Ee,Ht=Fe=0;try{!function Xi(){ve(),++Ht;for(var c,o=me;o;)(c=te-o._time)>=0&&o._call.call(void 0,c),o=o._next;--Ht}()}finally{Ht=0,function to(){for(var o,h,c=me,n=1/0;c;)c._call?(n>c._time&&(n=c._time),o=c,c=c._next):(h=c._next,c._next=null,c=o?o._next=h:me=h);_e=o,Bn(n)}(),te=0}}function Ki(){var o=Ie.now(),c=o-Pe;c>1e3&&(Ee-=c,Pe=o)}function Bn(o){Ht||(Fe&&(Fe=clearTimeout(Fe)),o-te>24?(o<1/0&&(Fe=setTimeout(zr,o-Ie.now()-Ee)),Yt&&(Yt=clearInterval(Yt))):(Yt||(Pe=Ie.now(),Yt=setInterval(Ki,1e3)),Ht=1,Le(zr)))}function wn(o,c,h){var n=new vn;return n.restart(s=>{n.stop(),o(s+c)},c=null==c?0:+c,h),n}vn.prototype=Be.prototype={constructor:vn,restart:function(o,c,h){if("function"!=typeof o)throw new TypeError("callback is not a function");h=(null==h?ve():+h)+(null==c?0:+c),!this._next&&_e!==this&&(_e?_e._next=this:me=this,_e=this),this._call=o,this._time=h,Bn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Bn())}};var kr=_n("start","end","cancel","interrupt"),Mr=[];function Ue(o,c,h,n,s,r){var a=o.__transition;if(a){if(h in a)return}else o.__transition={};!function eo(o,c,h){var s,n=o.__transition;function r(_){h.state=1,h.timer.restart(a,h.delay,h.time),h.delay<=_&&a(_-h.delay)}function a(_){var v,x,T,z;if(1!==h.state)return d();for(v in n)if((z=n[v]).name===h.name){if(3===z.state)return wn(a);4===z.state?(z.state=6,z.timer.stop(),z.on.call("interrupt",o,o.__data__,z.index,z.group),delete n[v]):+v<c&&(z.state=6,z.timer.stop(),z.on.call("cancel",o,o.__data__,z.index,z.group),delete n[v])}if(wn(function(){3===h.state&&(h.state=4,h.timer.restart(f,h.delay,h.time),f(_))}),h.state=2,h.on.call("start",o,o.__data__,h.index,h.group),2===h.state){for(h.state=3,s=new Array(T=h.tween.length),v=0,x=-1;v<T;++v)(z=h.tween[v].value.call(o,o.__data__,h.index,h.group))&&(s[++x]=z);s.length=x+1}}function f(_){for(var v=_<h.duration?h.ease.call(null,_/h.duration):(h.timer.restart(d),h.state=5,1),x=-1,T=s.length;++x<T;)s[x].call(o,v);5===h.state&&(h.on.call("end",o,o.__data__,h.index,h.group),d())}function d(){for(var _ in h.state=6,h.timer.stop(),delete n[c],n)return;delete o.__transition}n[c]=h,h.timer=Be(r,0,h.time)}(o,h,{name:c,index:n,group:s,on:kr,tween:Mr,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function Qn(o,c){var h=gt(o,c);if(h.state>0)throw new Error("too late; already scheduled");return h}function Dt(o,c){var h=gt(o,c);if(h.state>3)throw new Error("too late; already running");return h}function gt(o,c){var h=o.__transition;if(!h||!(h=h[c]))throw new Error("transition not found");return h}function ee(o,c){return o=+o,c=+c,function(h){return o*(1-h)+c*h}}var ne,Nr=180/Math.PI,we={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Re(o,c,h,n,s,r){var a,f,d;return(a=Math.sqrt(o*o+c*c))&&(o/=a,c/=a),(d=o*h+c*n)&&(h-=o*d,n-=c*d),(f=Math.sqrt(h*h+n*n))&&(h/=f,n/=f,d/=f),o*n<c*h&&(o=-o,c=-c,d=-d,a=-a),{translateX:s,translateY:r,rotate:Math.atan2(c,o)*Nr,skewX:Math.atan(d)*Nr,scaleX:a,scaleY:f}}function Cn(o,c,h,n){function s(_){return _.length?_.pop()+" ":""}return function(_,v){var x=[],T=[];return _=o(_),v=o(v),function r(_,v,x,T,z,E){if(_!==x||v!==T){var I=z.push("translate(",null,c,null,h);E.push({i:I-4,x:ee(_,x)},{i:I-2,x:ee(v,T)})}else(x||T)&&z.push("translate("+x+c+T+h)}(_.translateX,_.translateY,v.translateX,v.translateY,x,T),function a(_,v,x,T){_!==v?(_-v>180?v+=360:v-_>180&&(_+=360),T.push({i:x.push(s(x)+"rotate(",null,n)-2,x:ee(_,v)})):v&&x.push(s(x)+"rotate("+v+n)}(_.rotate,v.rotate,x,T),function f(_,v,x,T){_!==v?T.push({i:x.push(s(x)+"skewX(",null,n)-2,x:ee(_,v)}):v&&x.push(s(x)+"skewX("+v+n)}(_.skewX,v.skewX,x,T),function d(_,v,x,T,z,E){if(_!==x||v!==T){var I=z.push(s(z)+"scale(",null,",",null,")");E.push({i:I-4,x:ee(_,x)},{i:I-2,x:ee(v,T)})}else(1!==x||1!==T)&&z.push(s(z)+"scale("+x+","+T+")")}(_.scaleX,_.scaleY,v.scaleX,v.scaleY,x,T),_=v=null,function(z){for(var Q,E=-1,I=T.length;++E<I;)x[(Q=T[E]).i]=Q.x(z);return x.join("")}}}var io=Cn(function bn(o){const c=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(o+"");return c.isIdentity?we:Re(c.a,c.b,c.c,c.d,c.e,c.f)},"px, ","px)","deg)"),Dr=Cn(function Jr(o){return null!=o&&(ne||(ne=document.createElementNS("http://www.w3.org/2000/svg","g")),ne.setAttribute("transform",o),o=ne.transform.baseVal.consolidate())?Re((o=o.matrix).a,o.b,o.c,o.d,o.e,o.f):we},", ",")",")");function oo(o,c){var h,n;return function(){var s=Dt(this,o),r=s.tween;if(r!==h)for(var a=0,f=(n=h=r).length;a<f;++a)if(n[a].name===c){(n=n.slice()).splice(a,1);break}s.tween=n}}function Ho(o,c,h){var n,s;if("function"!=typeof h)throw new Error;return function(){var r=Dt(this,o),a=r.tween;if(a!==n){s=(n=a).slice();for(var f={name:c,value:h},d=0,_=s.length;d<_;++d)if(s[d].name===c){s[d]=f;break}d===_&&s.push(f)}r.tween=s}}function Vn(o,c,h){var n=o._id;return o.each(function(){var s=Dt(this,n);(s.value||(s.value={}))[c]=h.apply(this,arguments)}),function(s){return gt(s,n).value[c]}}function Fr(o,c,h){o.prototype=c.prototype=h,h.constructor=o}function ao(o,c){var h=Object.create(o.prototype);for(var n in c)h[n]=c[n];return h}function Qe(){}var Ve=1/.7,qt="\\s*([+-]?\\d+)\\s*",$t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",mt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ye=/^#([0-9a-f]{3,8})$/,He=new RegExp("^rgb\\("+[qt,qt,qt]+"\\)$"),Ft=new RegExp("^rgb\\("+[mt,mt,mt]+"\\)$"),so=new RegExp("^rgba\\("+[qt,qt,qt,$t]+"\\)$"),Pr=new RegExp("^rgba\\("+[mt,mt,mt,$t]+"\\)$"),lo=new RegExp("^hsl\\("+[$t,mt,mt]+"\\)$"),co=new RegExp("^hsla\\("+[$t,mt,mt,$t]+"\\)$"),Er={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ir(){return this.rgb().formatHex()}function Hn(){return this.rgb().formatRgb()}function xe(o){var c,h;return o=(o+"").trim().toLowerCase(),(c=ye.exec(o))?(h=c[1].length,c=parseInt(c[1],16),6===h?Lr(c):3===h?new ot(c>>8&15|c>>4&240,c>>4&15|240&c,(15&c)<<4|15&c,1):8===h?Ye(c>>24&255,c>>16&255,c>>8&255,(255&c)/255):4===h?Ye(c>>12&15|c>>8&240,c>>8&15|c>>4&240,c>>4&15|240&c,((15&c)<<4|15&c)/255):null):(c=He.exec(o))?new ot(c[1],c[2],c[3],1):(c=Ft.exec(o))?new ot(255*c[1]/100,255*c[2]/100,255*c[3]/100,1):(c=so.exec(o))?Ye(c[1],c[2],c[3],c[4]):(c=Pr.exec(o))?Ye(255*c[1]/100,255*c[2]/100,255*c[3]/100,c[4]):(c=lo.exec(o))?Yn(c[1],c[2]/100,c[3]/100,1):(c=co.exec(o))?Yn(c[1],c[2]/100,c[3]/100,c[4]):Er.hasOwnProperty(o)?Lr(Er[o]):"transparent"===o?new ot(NaN,NaN,NaN,0):null}function Lr(o){return new ot(o>>16&255,o>>8&255,255&o,1)}function Ye(o,c,h,n){return n<=0&&(o=c=h=NaN),new ot(o,c,h,n)}function re(o){return o instanceof Qe||(o=xe(o)),o?new ot((o=o.rgb()).r,o.g,o.b,o.opacity):new ot}function Mt(o,c,h,n){return 1===arguments.length?re(o):new ot(o,c,h,null==n?1:n)}function ot(o,c,h,n){this.r=+o,this.g=+c,this.b=+h,this.opacity=+n}function Br(){return"#"+lt(this.r)+lt(this.g)+lt(this.b)}function be(){var o=this.opacity;return(1===(o=isNaN(o)?1:Math.max(0,Math.min(1,o)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===o?")":", "+o+")")}function lt(o){return((o=Math.max(0,Math.min(255,Math.round(o)||0)))<16?"0":"")+o.toString(16)}function Yn(o,c,h,n){return n<=0?o=c=h=NaN:h<=0||h>=1?o=c=NaN:c<=0&&(o=NaN),new Pt(o,c,h,n)}function $n(o){if(o instanceof Pt)return new Pt(o.h,o.s,o.l,o.opacity);if(o instanceof Qe||(o=xe(o)),!o)return new Pt;if(o instanceof Pt)return o;var c=(o=o.rgb()).r/255,h=o.g/255,n=o.b/255,s=Math.min(c,h,n),r=Math.max(c,h,n),a=NaN,f=r-s,d=(r+s)/2;return f?(a=c===r?(h-n)/f+6*(h<n):h===r?(n-c)/f+2:(c-h)/f+4,f/=d<.5?r+s:2-r-s,a*=60):f=d>0&&d<1?0:a,new Pt(a,f,d,o.opacity)}function Pt(o,c,h,n){this.h=+o,this.s=+c,this.l=+h,this.opacity=+n}function $e(o,c,h){return 255*(o<60?c+(h-c)*o/60:o<180?h:o<240?c+(h-c)*(240-o)/60:c)}function Ur(o,c,h,n,s){var r=o*o,a=r*o;return((1-3*o+3*r-a)*c+(4-6*r+3*a)*h+(1+3*o+3*r-3*a)*n+a*s)/6}Fr(Qe,xe,{copy:function(o){return Object.assign(new this.constructor,this,o)},displayable:function(){return this.rgb().displayable()},hex:Ir,formatHex:Ir,formatHsl:function uo(){return $n(this).formatHsl()},formatRgb:Hn,toString:Hn}),Fr(ot,Mt,ao(Qe,{brighter:function(o){return o=null==o?Ve:Math.pow(Ve,o),new ot(this.r*o,this.g*o,this.b*o,this.opacity)},darker:function(o){return o=null==o?.7:Math.pow(.7,o),new ot(this.r*o,this.g*o,this.b*o,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Br,formatHex:Br,formatRgb:be,toString:be})),Fr(Pt,function Wn(o,c,h,n){return 1===arguments.length?$n(o):new Pt(o,c,h,null==n?1:n)},ao(Qe,{brighter:function(o){return o=null==o?Ve:Math.pow(Ve,o),new Pt(this.h,this.s,this.l*o,this.opacity)},darker:function(o){return o=null==o?.7:Math.pow(.7,o),new Pt(this.h,this.s,this.l*o,this.opacity)},rgb:function(){var o=this.h%360+360*(this.h<0),c=isNaN(o)||isNaN(this.s)?0:this.s,h=this.l,n=h+(h<.5?h:1-h)*c,s=2*h-n;return new ot($e(o>=240?o-240:o+120,s,n),$e(o,s,n),$e(o<120?o+240:o-120,s,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var o=this.opacity;return(1===(o=isNaN(o)?1:Math.max(0,Math.min(1,o)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===o?")":", "+o+")")}}));const Tn=o=>()=>o;function Xn(o){return 1==(o=+o)?Qr:function(c,h){return h-c?function Rr(o,c,h){return o=Math.pow(o,h),c=Math.pow(c,h)-o,h=1/h,function(n){return Math.pow(o+n*c,h)}}(c,h,o):Tn(isNaN(c)?h:c)}}function Qr(o,c){var h=c-o;return h?function ct(o,c){return function(h){return o+h*c}}(o,h):Tn(isNaN(o)?c:o)}const fo=function o(c){var h=Xn(c);function n(s,r){var a=h((s=Mt(s)).r,(r=Mt(r)).r),f=h(s.g,r.g),d=h(s.b,r.b),_=Qr(s.opacity,r.opacity);return function(v){return s.r=a(v),s.g=f(v),s.b=d(v),s.opacity=_(v),s+""}}return n.gamma=o,n}(1);function Vr(o){return function(c){var a,f,h=c.length,n=new Array(h),s=new Array(h),r=new Array(h);for(a=0;a<h;++a)f=Mt(c[a]),n[a]=f.r||0,s[a]=f.g||0,r[a]=f.b||0;return n=o(n),s=o(s),r=o(r),f.opacity=1,function(d){return f.r=n(d),f.g=s(d),f.b=r(d),f+""}}}Vr(function Et(o){var c=o.length-1;return function(h){var n=h<=0?h=0:h>=1?(h=1,c-1):Math.floor(h*c),s=o[n],r=o[n+1];return Ur((h-n/c)*c,n>0?o[n-1]:2*s-r,s,r,n<c-1?o[n+2]:2*r-s)}}),Vr(function Gn(o){var c=o.length;return function(h){var n=Math.floor(((h%=1)<0?++h:h)*c);return Ur((h-n/c)*c,o[(n+c-1)%c],o[n%c],o[(n+1)%c],o[(n+2)%c])}});var An=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hr=new RegExp(An.source,"g");function Yr(o,c){var n,s,r,h=An.lastIndex=Hr.lastIndex=0,a=-1,f=[],d=[];for(o+="",c+="";(n=An.exec(o))&&(s=Hr.exec(c));)(r=s.index)>h&&(r=c.slice(h,r),f[a]?f[a]+=r:f[++a]=r),(n=n[0])===(s=s[0])?f[a]?f[a]+=s:f[++a]=s:(f[++a]=null,d.push({i:a,x:ee(n,s)})),h=Hr.lastIndex;return h<c.length&&(r=c.slice(h),f[a]?f[a]+=r:f[++a]=r),f.length<2?d[0]?function $o(o){return function(c){return o(c)+""}}(d[0].x):function Yo(o){return function(){return o}}(c):(c=d.length,function(_){for(var x,v=0;v<c;++v)f[(x=d[v]).i]=x.x(_);return f.join("")})}function tr(o,c){var h;return("number"==typeof c?ee:c instanceof xe?fo:(h=xe(c))?(c=h,fo):Yr)(o,c)}function Ct(o){return function(){this.removeAttribute(o)}}function po(o){return function(){this.removeAttributeNS(o.space,o.local)}}function er(o,c,h){var n,r,s=h+"";return function(){var a=this.getAttribute(o);return a===s?null:a===n?r:r=c(n=a,h)}}function zn(o,c,h){var n,r,s=h+"";return function(){var a=this.getAttributeNS(o.space,o.local);return a===s?null:a===n?r:r=c(n=a,h)}}function go(o,c,h){var n,s,r;return function(){var a,d,f=h(this);return null==f?void this.removeAttribute(o):(a=this.getAttribute(o))===(d=f+"")?null:a===n&&d===s?r:(s=d,r=c(n=a,f))}}function We(o,c,h){var n,s,r;return function(){var a,d,f=h(this);return null==f?void this.removeAttributeNS(o.space,o.local):(a=this.getAttributeNS(o.space,o.local))===(d=f+"")?null:a===n&&d===s?r:(s=d,r=c(n=a,f))}}function mo(o,c){return function(h){this.setAttribute(o,c.call(this,h))}}function _o(o,c){return function(h){this.setAttributeNS(o.space,o.local,c.call(this,h))}}function rr(o,c){var h,n;function s(){var r=c.apply(this,arguments);return r!==n&&(h=(n=r)&&_o(o,r)),h}return s._value=c,s}function vo(o,c){var h,n;function s(){var r=c.apply(this,arguments);return r!==n&&(h=(n=r)&&mo(o,r)),h}return s._value=c,s}function yo(o,c){return function(){Qn(this,o).delay=+c.apply(this,arguments)}}function $r(o,c){return c=+c,function(){Qn(this,o).delay=c}}function ir(o,c){return function(){Dt(this,o).duration=+c.apply(this,arguments)}}function xo(o,c){return c=+c,function(){Dt(this,o).duration=c}}function Co(o,c){if("function"!=typeof c)throw new Error;return function(){Dt(this,o).ease=c}}function Mo(o,c,h){var n,s,r=function ko(o){return(o+"").trim().split(/^|\s+/).every(function(c){var h=c.indexOf(".");return h>=0&&(c=c.slice(0,h)),!c||"start"===c})}(c)?Qn:Dt;return function(){var a=r(this,o),f=a.on;f!==n&&(s=(n=f).copy()).on(c,h),a.on=s}}var jo=Kt.prototype.constructor;function ar(o){return function(){this.style.removeProperty(o)}}function qo(o,c,h){return function(n){this.style.setProperty(o,c.call(this,n),h)}}function Ce(o,c,h){var n,s;function r(){var a=c.apply(this,arguments);return a!==s&&(n=(s=a)&&qo(o,a,h)),n}return r._value=c,r}function Ke(o){return function(c){this.textContent=o.call(this,c)}}function Mn(o){var c,h;function n(){var s=o.apply(this,arguments);return s!==h&&(c=(h=s)&&Ke(s)),c}return n._value=o,n}var jr=0;function Ot(o,c,h,n){this._groups=o,this._parents=c,this._name=h,this._id=n}function en(){return++jr}var It=Kt.prototype;Ot.prototype=function Fo(o){return Kt().transition(o)}.prototype={constructor:Ot,select:function or(o){var c=this._name,h=this._id;"function"!=typeof o&&(o=dt(o));for(var n=this._groups,s=n.length,r=new Array(s),a=0;a<s;++a)for(var v,x,f=n[a],d=f.length,_=r[a]=new Array(d),T=0;T<d;++T)(v=f[T])&&(x=o.call(v,v.__data__,T,f))&&("__data__"in v&&(x.__data__=v.__data__),_[T]=x,Ue(_[T],c,h,T,_,gt(v,h)));return new Ot(r,this._parents,c,h)},selectAll:function Go(o){var c=this._name,h=this._id;"function"!=typeof o&&(o=Ne(o));for(var n=this._groups,s=n.length,r=[],a=[],f=0;f<s;++f)for(var v,d=n[f],_=d.length,x=0;x<_;++x)if(v=d[x]){for(var z,T=o.call(v,v.__data__,x,d),E=gt(v,h),I=0,Q=T.length;I<Q;++I)(z=T[I])&&Ue(z,c,h,I,T,E);r.push(T),a.push(v)}return new Ot(r,a,c,h)},selectChild:It.selectChild,selectChildren:It.selectChildren,filter:function zo(o){"function"!=typeof o&&(o=G(o));for(var c=this._groups,h=c.length,n=new Array(h),s=0;s<h;++s)for(var d,r=c[s],a=r.length,f=n[s]=[],_=0;_<a;++_)(d=r[_])&&o.call(d,d.__data__,_,r)&&f.push(d);return new Ot(n,this._parents,this._name,this._id)},merge:function Wo(o){if(o._id!==this._id)throw new Error;for(var c=this._groups,h=o._groups,n=c.length,r=Math.min(n,h.length),a=new Array(n),f=0;f<r;++f)for(var T,d=c[f],_=h[f],v=d.length,x=a[f]=new Array(v),z=0;z<v;++z)(T=d[z]||_[z])&&(x[z]=T);for(;f<n;++f)a[f]=c[f];return new Ot(a,this._parents,this._name,this._id)},selection:function Wr(){return new jo(this._groups,this._parents)},transition:function Zn(){for(var o=this._name,c=this._id,h=en(),n=this._groups,s=n.length,r=0;r<s;++r)for(var d,a=n[r],f=a.length,_=0;_<f;++_)if(d=a[_]){var v=gt(d,c);Ue(d,o,h,_,a,{time:v.time+v.delay+v.duration,delay:0,duration:v.duration,ease:v.ease})}return new Ot(n,this._parents,o,h)},call:It.call,nodes:It.nodes,node:It.node,size:It.size,empty:It.empty,each:It.each,on:function Zo(o,c){var h=this._id;return arguments.length<2?gt(this.node(),h).on.on(o):this.each(Mo(h,o,c))},attr:function nr(o,c){var h=ue(o),n="transform"===h?Dr:tr;return this.attrTween(o,"function"==typeof c?(h.local?We:go)(h,n,Vn(this,"attr."+o,c)):null==c?(h.local?po:Ct)(h):(h.local?zn:er)(h,n,c))},attrTween:function wo(o,c){var h="attr."+o;if(arguments.length<2)return(h=this.tween(h))&&h._value;if(null==c)return this.tween(h,null);if("function"!=typeof c)throw new Error;var n=ue(o);return this.tween(h,(n.local?rr:vo)(n,c))},style:function Gr(o,c,h){var n="transform"==(o+="")?io:tr;return null==c?this.styleTween(o,function No(o,c){var h,n,s;return function(){var r=yt(this,o),a=(this.style.removeProperty(o),yt(this,o));return r===a?null:r===h&&a===n?s:s=c(h=r,n=a)}}(o,n)).on("end.style."+o,ar(o)):"function"==typeof c?this.styleTween(o,function Jo(o,c,h){var n,s,r;return function(){var a=yt(this,o),f=h(this),d=f+"";return null==f&&(this.style.removeProperty(o),d=f=yt(this,o)),a===d?null:a===n&&d===s?r:(s=d,r=c(n=a,f))}}(o,n,Vn(this,"style."+o,c))).each(function Do(o,c){var h,n,s,f,r="style."+c,a="end."+r;return function(){var d=Dt(this,o),_=d.on,v=null==d.value[r]?f||(f=ar(c)):void 0;(_!==h||s!==v)&&(n=(h=_).copy()).on(a,s=v),d.on=n}}(this._id,o)):this.styleTween(o,function Ge(o,c,h){var n,r,s=h+"";return function(){var a=yt(this,o);return a===s?null:a===n?r:r=c(n=a,h)}}(o,n,c),h).on("end.style."+o,null)},styleTween:function je(o,c,h){var n="style."+(o+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==c)return this.tween(n,null);if("function"!=typeof c)throw new Error;return this.tween(n,Ce(o,c,null==h?"":h))},text:function kn(o){return this.tween("text","function"==typeof o?function Zt(o){return function(){var c=o(this);this.textContent=null==c?"":c}}(Vn(this,"text",o)):function Xe(o){return function(){this.textContent=o}}(null==o?"":o+""))},textTween:function he(o){var c="text";if(arguments.length<1)return(c=this.tween(c))&&c._value;if(null==o)return this.tween(c,null);if("function"!=typeof o)throw new Error;return this.tween(c,Mn(o))},remove:function So(){return this.on("end.remove",function Oo(o){return function(){var c=this.parentNode;for(var h in this.__transition)if(+h!==o)return;c&&c.removeChild(this)}}(this._id))},tween:function qr(o,c){var h=this._id;if(o+="",arguments.length<2){for(var a,n=gt(this.node(),h).tween,s=0,r=n.length;s<r;++s)if((a=n[s]).name===o)return a.value;return null}return this.each((null==c?oo:Ho)(h,o,c))},delay:function ut(o){var c=this._id;return arguments.length?this.each(("function"==typeof o?yo:$r)(c,o)):gt(this.node(),c).delay},duration:function bo(o){var c=this._id;return arguments.length?this.each(("function"==typeof o?ir:xo)(c,o)):gt(this.node(),c).duration},ease:function ie(o){var c=this._id;return arguments.length?this.each(Co(c,o)):gt(this.node(),c).ease},easeVarying:function Ao(o){if("function"!=typeof o)throw new Error;return this.each(function To(o,c){return function(){var h=c.apply(this,arguments);if("function"!=typeof h)throw new Error;Dt(this,o).ease=h}}(this._id,o))},end:function tn(){var o,c,h=this,n=h._id,s=h.size();return new Promise(function(r,a){var f={value:a},d={value:function(){0==--s&&r()}};h.each(function(){var _=Dt(this,n),v=_.on;v!==o&&((c=(o=v).copy())._.cancel.push(f),c._.interrupt.push(f),c._.end.push(d)),_.on=c}),0===s&&r()})},[Symbol.iterator]:It[Symbol.iterator]};var Eo={time:null,delay:0,duration:250,ease:function Po(o){return((o*=2)<=1?o*o*o:(o-=2)*o*o+2)/2}};function sr(o,c){for(var h;!(h=o.__transition)||!(h=h[c]);)if(!(o=o.parentNode))throw new Error(`transition ${c} not found`);return h}function Kr(o){return o.data.name}function Ko(){var o=function mn(o){return"string"==typeof o?new Y([[document.querySelector(o)]],[document.documentElement]):new Y([[o]],gn)}("body"),c=null,h=Kr,n=Kr,s=!1;function r(){c=o.append("div").style("display","none").style("position","absolute").style("opacity",0).style("pointer-events","none").attr("class","d3-flame-graph-tip")}return r.show=function(a){return c.style("display","block").style("left",event.pageX+5+"px").style("top",event.pageY+5+"px").transition().duration(200).style("opacity",1).style("pointer-events","all"),s?c.html(h(a)):c.text(n(a)),r},r.hide=function(){return c.style("display","none").transition().duration(200).style("opacity",0).style("pointer-events","none"),r},r.text=function(a){return arguments.length?(n=a,s=!1,r):n},r.html=function(a){return arguments.length?(h=a,s=!0,r):h},r.destroy=function(){c.remove()},r}return Kt.prototype.interrupt=function ro(o){return this.each(function(){!function no(o,c){var n,s,a,h=o.__transition,r=!0;if(h){for(a in c=null==c?null:c+"",h)(n=h[a]).name===c?(s=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(s?"interrupt":"cancel",o,o.__data__,n.index,n.group),delete h[a]):r=!1;r&&delete o.__transition}}(this,o)})},Kt.prototype.transition=function Xr(o){var c,h;o instanceof Ot?(c=o._id,o=o._name):(c=en(),(h=Eo).time=ve(),o=null==o?null:o+"");for(var n=this._groups,s=n.length,r=0;r<s;++r)for(var d,a=n[r],f=a.length,_=0;_<f;++_)(d=a[_])&&Ue(d,o,c,_,a,h||sr(d,c));return new Ot(n,this._parents,o,c)},O})()},70344:Nn=>{self,Nn.exports=(()=>{"use strict";var j={d:(e,i)=>{for(var l in i)j.o(i,l)&&!j.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:i[l]})},o:(e,i)=>Object.prototype.hasOwnProperty.call(e,i)},O={};function B(){}function dt(e){return null==e?B:function(){return this.querySelector(e)}}function cn(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function Se(){return[]}function Ne(e){return null==e?Se:function(){return this.querySelectorAll(e)}}function G(e){return function(){return this.matches(e)}}function L(e){return function(i){return i.matches(e)}}j.d(O,{default:()=>rs});var X=Array.prototype.find;function D(){return this.firstElementChild}var vt=Array.prototype.filter;function at(){return Array.from(this.children)}function Ut(e){return new Array(e.length)}function wt(e,i){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=i}function t(e){return function(){return e}}function Je(e,i,l,u,p,m){for(var w,g=0,y=i.length,C=m.length;g<C;++g)(w=i[g])?(w.__data__=m[g],u[g]=w):l[g]=new wt(e,m[g]);for(;g<y;++g)(w=i[g])&&(p[g]=w)}function Jt(e,i,l,u,p,m,g){var w,y,q,C=new Map,A=i.length,k=m.length,M=new Array(A);for(w=0;w<A;++w)(y=i[w])&&(M[w]=q=g.call(y,y.__data__,w,i)+"",C.has(q)?p[w]=y:C.set(q,y));for(w=0;w<k;++w)q=g.call(e,m[w],w,m)+"",(y=C.get(q))?(u[w]=y,y.__data__=m[w],C.delete(q)):l[w]=new wt(e,m[w]);for(w=0;w<A;++w)(y=i[w])&&C.get(M[w])===y&&(p[w]=y)}function oi(e){return e.__data__}function si(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function pr(e,i){return e<i?-1:e>i?1:e>=i?0:NaN}wt.prototype={constructor:wt,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,i){return this._parent.insertBefore(e,i)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var ce="http://www.w3.org/1999/xhtml";const qn={svg:"http://www.w3.org/2000/svg",xhtml:ce,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ue(e){var i=e+="",l=i.indexOf(":");return l>=0&&"xmlns"!==(i=e.slice(0,l))&&(e=e.slice(l+1)),qn.hasOwnProperty(i)?{space:qn[i],local:e}:e}function di(e){return function(){this.removeAttribute(e)}}function gi(e){return function(){this.removeAttributeNS(e.space,e.local)}}function mi(e,i){return function(){this.setAttribute(e,i)}}function _i(e,i){return function(){this.setAttributeNS(e.space,e.local,i)}}function vi(e,i){return function(){var l=i.apply(this,arguments);null==l?this.removeAttribute(e):this.setAttribute(e,l)}}function wi(e,i){return function(){var l=i.apply(this,arguments);null==l?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,l)}}function Fn(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function xi(e){return function(){this.style.removeProperty(e)}}function bi(e,i,l){return function(){this.style.setProperty(e,i,l)}}function dr(e,i,l){return function(){var u=i.apply(this,arguments);null==u?this.style.removeProperty(e):this.style.setProperty(e,u,l)}}function yt(e,i){return e.style.getPropertyValue(i)||Fn(e).getComputedStyle(e,null).getPropertyValue(i)}function gr(e){return function(){delete this[e]}}function mr(e,i){return function(){this[e]=i}}function Ti(e,i){return function(){var l=i.apply(this,arguments);null==l?delete this[e]:this[e]=l}}function Xt(e){return e.trim().split(/^|\s+/)}function De(e){return e.classList||new En(e)}function En(e){this._node=e,this._names=Xt(e.getAttribute("class")||"")}function fn(e,i){for(var l=De(e),u=-1,p=i.length;++u<p;)l.add(i[u])}function xt(e,i){for(var l=De(e),u=-1,p=i.length;++u<p;)l.remove(i[u])}function Ai(e){return function(){fn(this,e)}}function _r(e){return function(){xt(this,e)}}function In(e,i){return function(){(i.apply(this,arguments)?fn:xt)(this,e)}}function ki(){this.textContent=""}function Mi(e){return function(){this.textContent=e}}function Zi(e){return function(){var i=e.apply(this,arguments);this.textContent=null==i?"":i}}function vr(){this.innerHTML=""}function hn(e){return function(){this.innerHTML=e}}function Si(e){return function(){var i=e.apply(this,arguments);this.innerHTML=null==i?"":i}}function Ji(){this.nextSibling&&this.parentNode.appendChild(this)}function qi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Pi(e){return function(){var i=this.ownerDocument,l=this.namespaceURI;return l===ce&&i.documentElement.namespaceURI===ce?i.createElement(e):i.createElementNS(l,e)}}function Ei(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ln(e){var i=ue(e);return(i.local?Ei:Pi)(i)}function Ii(){return null}function Bi(){var e=this.parentNode;e&&e.removeChild(this)}function Ri(){var e=this.cloneNode(!1),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function Qi(){var e=this.cloneNode(!0),i=this.parentNode;return i?i.insertBefore(e,this.nextSibling):e}function wr(e){return e.trim().split(/^|\s+/).map(function(i){var l="",u=i.indexOf(".");return u>=0&&(l=i.slice(u+1),i=i.slice(0,u)),{type:i,name:l}})}function bt(e){return function(){var i=this.__on;if(i){for(var m,l=0,u=-1,p=i.length;l<p;++l)m=i[l],e.type&&m.type!==e.type||m.name!==e.name?i[++u]=m:this.removeEventListener(m.type,m.listener,m.options);++u?i.length=u:delete this.__on}}}function pn(e,i,l){return function(){var p,u=this.__on,m=function Hi(e){return function(i){e.call(this,i,this.__data__)}}(i);if(u)for(var g=0,w=u.length;g<w;++g)if((p=u[g]).type===e.type&&p.name===e.name)return this.removeEventListener(p.type,p.listener,p.options),this.addEventListener(p.type,p.listener=m,p.options=l),void(p.value=i);this.addEventListener(e.type,m,l),p={type:e.type,name:e.name,value:i,listener:m,options:l},u?u.push(p):this.__on=[p]}}function dn(e,i,l){var u=Fn(e),p=u.CustomEvent;"function"==typeof p?p=new p(i,l):(p=u.document.createEvent("Event"),l?(p.initEvent(i,l.bubbles,l.cancelable),p.detail=l.detail):p.initEvent(i,!1,!1)),e.dispatchEvent(p)}function Vo(e,i){return function(){return dn(this,e,i)}}function Yi(e,i){return function(){return dn(this,e,i.apply(this,arguments))}}En.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var i=this._names.indexOf(e);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var gn=[null];function Y(e,i){this._groups=e,this._parents=i}function Qt(){return new Y([[document.documentElement]],gn)}Y.prototype=Qt.prototype={constructor:Y,select:function Jn(e){"function"!=typeof e&&(e=dt(e));for(var i=this._groups,l=i.length,u=new Array(l),p=0;p<l;++p)for(var y,C,m=i[p],g=m.length,w=u[p]=new Array(g),A=0;A<g;++A)(y=m[A])&&(C=e.call(y,y.__data__,A,m))&&("__data__"in y&&(C.__data__=y.__data__),w[A]=C);return new Y(u,this._parents)},selectAll:function F(e){e="function"==typeof e?function Dn(e){return function(){return cn(e.apply(this,arguments))}}(e):Ne(e);for(var i=this._groups,l=i.length,u=[],p=[],m=0;m<l;++m)for(var y,g=i[m],w=g.length,C=0;C<w;++C)(y=g[C])&&(u.push(e.call(y,y.__data__,C,g)),p.push(y));return new Y(u,p)},selectChild:function H(e){return this.select(null==e?D:function K(e){return function(){return X.call(this.children,e)}}("function"==typeof e?e:L(e)))},selectChildren:function se(e){return this.selectAll(null==e?at:function rt(e){return function(){return vt.call(this.children,e)}}("function"==typeof e?e:L(e)))},filter:function jt(e){"function"!=typeof e&&(e=G(e));for(var i=this._groups,l=i.length,u=new Array(l),p=0;p<l;++p)for(var y,m=i[p],g=m.length,w=u[p]=[],C=0;C<g;++C)(y=m[C])&&e.call(y,y.__data__,C,m)&&w.push(y);return new Y(u,this._parents)},data:function ai(e,i){if(!arguments.length)return Array.from(this,oi);var l=i?Jt:Je,u=this._parents,p=this._groups;"function"!=typeof e&&(e=t(e));for(var m=p.length,g=new Array(m),w=new Array(m),y=new Array(m),C=0;C<m;++C){var A=u[C],k=p[C],M=k.length,q=si(e.call(A,A&&A.__data__,C,u)),R=q.length,tt=w[C]=new Array(R),ht=g[C]=new Array(R);l(A,k,tt,ht,y[C]=new Array(M),q,i);for(var Ze,et,zt=0,kt=0;zt<R;++zt)if(Ze=tt[zt]){for(zt>=kt&&(kt=zt+1);!(et=ht[kt])&&++kt<R;);Ze._next=et||null}}return(g=new Y(g,u))._enter=w,g._exit=y,g},enter:function it(){return new Y(this._enter||this._groups.map(Ut),this._parents)},exit:function li(){return new Y(this._exit||this._groups.map(Ut),this._parents)},join:function fr(e,i,l){var u=this.enter(),p=this,m=this.exit();return"function"==typeof e?(u=e(u))&&(u=u.selection()):u=u.append(e+""),null!=i&&(p=i(p))&&(p=p.selection()),null==l?m.remove():l(m),u&&p?u.merge(p).order():p},merge:function ci(e){for(var i=e.selection?e.selection():e,l=this._groups,u=i._groups,p=l.length,g=Math.min(p,u.length),w=new Array(p),y=0;y<g;++y)for(var q,C=l[y],A=u[y],k=C.length,M=w[y]=new Array(k),R=0;R<k;++R)(q=C[R]||A[R])&&(M[R]=q);for(;y<p;++y)w[y]=l[y];return new Y(w,this._parents)},selection:function Wi(){return this},order:function hr(){for(var e=this._groups,i=-1,l=e.length;++i<l;)for(var g,u=e[i],p=u.length-1,m=u[p];--p>=0;)(g=u[p])&&(m&&4^g.compareDocumentPosition(m)&&m.parentNode.insertBefore(g,m),m=g);return this},sort:function st(e){function i(k,M){return k&&M?e(k.__data__,M.__data__):!k-!M}e||(e=pr);for(var l=this._groups,u=l.length,p=new Array(u),m=0;m<u;++m){for(var C,g=l[m],w=g.length,y=p[m]=new Array(w),A=0;A<w;++A)(C=g[A])&&(y[A]=C);y.sort(i)}return new Y(p,this._parents).order()},call:function ui(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function un(){return Array.from(this)},node:function le(){for(var e=this._groups,i=0,l=e.length;i<l;++i)for(var u=e[i],p=0,m=u.length;p<m;++p){var g=u[p];if(g)return g}return null},size:function fi(){let e=0;for(const i of this)++e;return e},empty:function hi(){return!this.node()},each:function pi(e){for(var i=this._groups,l=0,u=i.length;l<u;++l)for(var w,p=i[l],m=0,g=p.length;m<g;++m)(w=p[m])&&e.call(w,w.__data__,m,p);return this},attr:function yi(e,i){var l=ue(e);if(arguments.length<2){var u=this.node();return l.local?u.getAttributeNS(l.space,l.local):u.getAttribute(l)}return this.each((null==i?l.local?gi:di:"function"==typeof i?l.local?wi:vi:l.local?_i:mi)(l,i))},style:function Ci(e,i,l){return arguments.length>1?this.each((null==i?xi:"function"==typeof i?dr:bi)(e,i,null==l?"":l)):yt(this.node(),e)},property:function Pn(e,i){return arguments.length>1?this.each((null==i?gr:"function"==typeof i?Ti:mr)(e,i)):this.node()[e]},classed:function zi(e,i){var l=Xt(e+"");if(arguments.length<2){for(var u=De(this.node()),p=-1,m=l.length;++p<m;)if(!u.contains(l[p]))return!1;return!0}return this.each(("function"==typeof i?In:i?Ai:_r)(l,i))},text:function Oi(e){return arguments.length?this.each(null==e?ki:("function"==typeof e?Zi:Mi)(e)):this.node().textContent},html:function Ni(e){return arguments.length?this.each(null==e?vr:("function"==typeof e?Si:hn)(e)):this.node().innerHTML},raise:function Di(){return this.each(Ji)},lower:function Fi(){return this.each(qi)},append:function Rt(e){var i="function"==typeof e?e:Ln(e);return this.select(function(){return this.appendChild(i.apply(this,arguments))})},insert:function Li(e,i){var l="function"==typeof e?e:Ln(e),u=null==i?Ii:"function"==typeof i?i:dt(i);return this.select(function(){return this.insertBefore(l.apply(this,arguments),u.apply(this,arguments)||null)})},remove:function Ui(){return this.each(Bi)},clone:function Vi(e){return this.select(e?Qi:Ri)},datum:function Qo(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function yr(e,i,l){var p,g,u=wr(e+""),m=u.length;if(!(arguments.length<2)){for(w=i?pn:bt,p=0;p<m;++p)this.each(w(u[p],i,l));return this}var w=this.node().__on;if(w)for(var A,y=0,C=w.length;y<C;++y)for(p=0,A=w[y];p<m;++p)if((g=u[p]).type===A.type&&g.name===A.name)return A.value},dispatch:function $i(e,i){return this.each(("function"==typeof i?Yi:Vo)(e,i))},[Symbol.iterator]:function*xr(){for(var e=this._groups,i=0,l=e.length;i<l;++i)for(var g,u=e[i],p=0,m=u.length;p<m;++p)(g=u[p])&&(yield g)}};const Kt=Qt;function mn(e){return"string"==typeof e?new Y([[document.querySelector(e)]],[document.documentElement]):new Y([[e]],gn)}function qe(e,i){if((l=(e=i?e.toExponential(i-1):e.toExponential()).indexOf("e"))<0)return null;var l,u=e.slice(0,l);return[u.length>1?u[0]+u.slice(2):u,+e.slice(l+1)]}function Vt(e){return(e=qe(Math.abs(e)))?e[1]:NaN}var Yt,Cr=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function _n(e){if(!(i=Cr.exec(e)))throw new Error("invalid format: "+e);var i;return new Ht({fill:i[1],align:i[2],sign:i[3],symbol:i[4],zero:i[5],width:i[6],comma:i[7],precision:i[8]&&i[8].slice(1),trim:i[9],type:i[10]})}function Ht(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function me(e,i){var l=qe(e,i);if(!l)return e+"";var u=l[0],p=l[1];return p<0?"0."+new Array(-p).join("0")+u:u.length>p+1?u.slice(0,p+1)+"."+u.slice(p+1):u+new Array(p-u.length+2).join("0")}_n.prototype=Ht.prototype,Ht.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const _e={"%":(e,i)=>(100*e).toFixed(i),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function br(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,i)=>e.toExponential(i),f:(e,i)=>e.toFixed(i),g:(e,i)=>e.toPrecision(i),o:e=>Math.round(e).toString(8),p:(e,i)=>me(100*e,i),r:me,s:function Tr(e,i){var l=qe(e,i);if(!l)return e+"";var u=l[0],p=l[1],m=p-(Yt=3*Math.max(-8,Math.min(8,Math.floor(p/3))))+1,g=u.length;return m===g?u:m>g?u+new Array(m-g+1).join("0"):m>0?u.slice(0,m)+"."+u.slice(m):"0."+new Array(1-m).join("0")+qe(e,Math.max(0,i+m-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Pe(e){return e}var Le,ve,Ar,te=Array.prototype.map,Ee=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"];function Ie(e){var i=void 0===e.grouping||void 0===e.thousands?Pe:function Gi(e,i){return function(l,u){for(var p=l.length,m=[],g=0,w=e[0],y=0;p>0&&w>0&&(y+w+1>u&&(w=Math.max(1,u-y)),m.push(l.substring(p-=w,p+w)),!((y+=w+1)>u));)w=e[g=(g+1)%e.length];return m.reverse().join(i)}}(te.call(e.grouping,Number),e.thousands+""),l=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",p=void 0===e.decimal?".":e.decimal+"",m=void 0===e.numerals?Pe:function ji(e){return function(i){return i.replace(/[0-9]/g,function(l){return e[+l]})}}(te.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",w=void 0===e.minus?"\u2212":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function C(k){var M=(k=_n(k)).fill,q=k.align,R=k.sign,tt=k.symbol,ht=k.zero,pe=k.width,zt=k.comma,kt=k.precision,Ze=k.trim,et=k.type;"n"===et?(zt=!0,et="g"):_e[et]||(void 0===kt&&(kt=12),Ze=!0,et="g"),(ht||"0"===M&&"="===q)&&(ht=!0,M="0",q="=");var Sn="$"===tt?l:"#"===tt&&/[boxX]/.test(et)?"0"+et.toLowerCase():"",Oe="$"===tt?u:/[%p]/.test(et)?g:"",ri=_e[et],Uo=/[defgprs%]/.test(et);function lr(V){var Bt,ta,an,ae=Sn,Lt=Oe;if("c"===et)Lt=ri(V)+Lt,V="";else{var sn=(V=+V)<0||1/V<0;if(V=isNaN(V)?y:ri(Math.abs(V),kt),Ze&&(V=function Fe(e){t:for(var p,i=e.length,l=1,u=-1;l<i;++l)switch(e[l]){case".":u=p=l;break;case"0":0===u&&(u=l),p=l;break;default:if(!+e[l])break t;u>0&&(u=0)}return u>0?e.slice(0,u)+e.slice(p+1):e}(V)),sn&&0==+V&&"+"!==R&&(sn=!1),ae=(sn?"("===R?R:w:"-"===R||"("===R?"":R)+ae,Lt=("s"===et?Ee[8+Yt/3]:"")+Lt+(sn&&"("===R?")":""),Uo)for(Bt=-1,ta=V.length;++Bt<ta;)if(48>(an=V.charCodeAt(Bt))||an>57){Lt=(46===an?p+V.slice(Bt+1):V.slice(Bt))+Lt,V=V.slice(0,Bt);break}}zt&&!ht&&(V=i(V,1/0));var cr=ae.length+V.length+Lt.length,de=cr<pe?new Array(pe-cr+1).join(M):"";switch(zt&&ht&&(V=i(de+V,de.length?pe-Lt.length:1/0),de=""),q){case"<":V=ae+V+Lt+de;break;case"=":V=ae+de+V+Lt;break;case"^":V=de.slice(0,cr=de.length>>1)+ae+V+Lt+de.slice(cr);break;default:V=de+ae+V+Lt}return m(V)}return kt=void 0===kt?6:/[gprs]/.test(et)?Math.max(1,Math.min(21,kt)):Math.max(0,Math.min(20,kt)),lr.toString=function(){return k+""},lr}return{format:C,formatPrefix:function A(k,M){var q=C(((k=_n(k)).type="f",k)),R=3*Math.max(-8,Math.min(8,Math.floor(Vt(M)/3))),tt=Math.pow(10,-R),ht=Ee[8+R/3];return function(pe){return q(tt*pe)+ht}}}}function Be(e,i){return null==e||null==i?NaN:e<i?-1:e>i?1:e>=i?0:NaN}function Xi(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Ki(){var e=1,i=1,l=0,u=!1;function p(g){var w=g.height+1;return g.x0=g.y0=l,g.x1=e,g.y1=i/w,g.eachBefore(function m(g,w){return function(y){y.children&&function zr(e,i,l,u,p){for(var g,m=e.children,w=-1,y=m.length,C=e.value&&(u-i)/e.value;++w<y;)(g=m[w]).y0=l,g.y1=p,g.x0=i,g.x1=i+=g.value*C}(y,y.x0,g*(y.depth+1)/w,y.x1,g*(y.depth+2)/w);var C=y.x0,A=y.y0,k=y.x1-l,M=y.y1-l;k<C&&(C=k=(C+k)/2),M<A&&(A=M=(A+M)/2),y.x0=C,y.y0=A,y.x1=k,y.y1=M}}(i,w)),u&&g.eachBefore(Xi),g}return p.round=function(g){return arguments.length?(u=!!g,p):u},p.size=function(g){return arguments.length?(e=+g[0],i=+g[1],p):[e,i]},p.padding=function(g){return arguments.length?(l=+g,p):l},p}function to(e){var i=0,l=e.children,u=l&&l.length;if(u)for(;--u>=0;)i+=l[u].value;else i=1;e.value=i}function gt(e,i){e instanceof Map?(e=[void 0,e],void 0===i&&(i=ro)):void 0===i&&(i=no);for(var u,m,g,w,y,l=new we(e),p=[l];u=p.pop();)if((g=i(u.data))&&(y=(g=Array.from(g)).length))for(u.children=g,w=y-1;w>=0;--w)p.push(m=g[w]=new we(g[w])),m.parent=u,m.depth=u.depth+1;return l.eachBefore(Nr)}function no(e){return e.children}function ro(e){return Array.isArray(e)?e[1]:null}function ee(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function Nr(e){var i=0;do{e.height=i}while((e=e.parent)&&e.height<++i)}function we(e){this.data=e,this.depth=this.height=0,this.parent=null}(function vn(e){return Le=Ie(e),ve=Le.format,Ar=Le.formatPrefix,Le})({thousands:",",grouping:[3],currency:["$",""]}),we.prototype=gt.prototype={constructor:we,count:function Bn(){return this.eachAfter(to)},each:function wn(e,i){let l=-1;for(const u of this)e.call(i,u,++l,this);return this},eachAfter:function Mr(e,i){for(var m,g,w,l=this,u=[l],p=[],y=-1;l=u.pop();)if(p.push(l),m=l.children)for(g=0,w=m.length;g<w;++g)u.push(m[g]);for(;l=p.pop();)e.call(i,l,++y,this);return this},eachBefore:function kr(e,i){for(var p,m,l=this,u=[l],g=-1;l=u.pop();)if(e.call(i,l,++g,this),p=l.children)for(m=p.length-1;m>=0;--m)u.push(p[m]);return this},find:function Zr(e,i){let l=-1;for(const u of this)if(e.call(i,u,++l,this))return u},sum:function Or(e){return this.eachAfter(function(i){for(var l=+e(i.data)||0,u=i.children,p=u&&u.length;--p>=0;)l+=u[p].value;i.value=l})},sort:function Un(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})},path:function yn(e){for(var i=this,l=function Sr(e,i){if(e===i)return e;var l=e.ancestors(),u=i.ancestors(),p=null;for(e=l.pop(),i=u.pop();e===i;)p=e,e=l.pop(),i=u.pop();return p}(i,e),u=[i];i!==l;)u.push(i=i.parent);for(var p=u.length;e!==l;)u.splice(p,0,e),e=e.parent;return u},ancestors:function Rn(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i},descendants:function xn(){return Array.from(this)},leaves:function Ue(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e},links:function Qn(){var e=this,i=[];return e.each(function(l){l!==e&&i.push({source:l.parent,target:l})}),i},copy:function eo(){return gt(this).eachBefore(ee)},[Symbol.iterator]:function*Dt(){var i,u,p,m,e=this,l=[e];do{for(i=l.reverse(),l=[];e=i.pop();)if(yield e,u=e.children)for(p=0,m=u.length;p<m;++p)l.push(u[p])}while(l.length)}};var Re=Math.sqrt(50),ne=Math.sqrt(10),bn=Math.sqrt(2);function Cn(e,i,l){var u=(i-e)/Math.max(0,l),p=Math.floor(Math.log(u)/Math.LN10),m=u/Math.pow(10,p);return p>=0?(m>=Re?10:m>=ne?5:m>=bn?2:1)*Math.pow(10,p):-Math.pow(10,-p)/(m>=Re?10:m>=ne?5:m>=bn?2:1)}function Dr(e){let i=e,l=e,u=e;function p(w,y,C=0,A=w.length){if(C<A){if(0!==l(y,y))return A;do{const k=C+A>>>1;u(w[k],y)<0?C=k+1:A=k}while(C<A)}return C}return 2!==e.length&&(i=(w,y)=>e(w)-y,l=Be,u=(w,y)=>Be(e(w),y)),{left:p,center:function g(w,y,C=0,A=w.length){const k=p(w,y,C,A-1);return k>C&&i(w[k-1],y)>-i(w[k],y)?k-1:k},right:function m(w,y,C=0,A=w.length){if(C<A){if(0!==l(y,y))return A;do{const k=C+A>>>1;u(w[k],y)<=0?C=k+1:A=k}while(C<A)}return C}}}const Vn=Dr(Be).right,Qe=(Dr(function oo(e){return null===e?NaN:+e}),Vn);function fe(e,i,l){e.prototype=i.prototype=l,l.constructor=e}function Ve(e,i){var l=Object.create(e.prototype);for(var u in i)l[u]=i[u];return l}function qt(){}var mt=1/.7,ye="\\s*([+-]?\\d+)\\s*",He="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ft="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",so=/^#([0-9a-f]{3,8})$/,Pr=new RegExp("^rgb\\("+[ye,ye,ye]+"\\)$"),lo=new RegExp("^rgb\\("+[Ft,Ft,Ft]+"\\)$"),co=new RegExp("^rgba\\("+[ye,ye,ye,He]+"\\)$"),Er=new RegExp("^rgba\\("+[Ft,Ft,Ft,He]+"\\)$"),Ir=new RegExp("^hsl\\("+[He,Ft,Ft]+"\\)$"),uo=new RegExp("^hsla\\("+[He,Ft,Ft,He]+"\\)$"),Hn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function xe(){return this.rgb().formatHex()}function Ye(){return this.rgb().formatRgb()}function re(e){var i,l;return e=(e+"").trim().toLowerCase(),(i=so.exec(e))?(l=i[1].length,i=parseInt(i[1],16),6===l?Mt(i):3===l?new lt(i>>8&15|i>>4&240,i>>4&15|240&i,(15&i)<<4|15&i,1):8===l?ot(i>>24&255,i>>16&255,i>>8&255,(255&i)/255):4===l?ot(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|240&i,((15&i)<<4|15&i)/255):null):(i=Pr.exec(e))?new lt(i[1],i[2],i[3],1):(i=lo.exec(e))?new lt(255*i[1]/100,255*i[2]/100,255*i[3]/100,1):(i=co.exec(e))?ot(i[1],i[2],i[3],i[4]):(i=Er.exec(e))?ot(255*i[1]/100,255*i[2]/100,255*i[3]/100,i[4]):(i=Ir.exec(e))?Pt(i[1],i[2]/100,i[3]/100,1):(i=uo.exec(e))?Pt(i[1],i[2]/100,i[3]/100,i[4]):Hn.hasOwnProperty(e)?Mt(Hn[e]):"transparent"===e?new lt(NaN,NaN,NaN,0):null}function Mt(e){return new lt(e>>16&255,e>>8&255,255&e,1)}function ot(e,i,l,u){return u<=0&&(e=i=l=NaN),new lt(e,i,l,u)}function Br(e){return e instanceof qt||(e=re(e)),e?new lt((e=e.rgb()).r,e.g,e.b,e.opacity):new lt}function be(e,i,l,u){return 1===arguments.length?Br(e):new lt(e,i,l,null==u?1:u)}function lt(e,i,l,u){this.r=+e,this.g=+i,this.b=+l,this.opacity=+u}function Yn(){return"#"+Wn(this.r)+Wn(this.g)+Wn(this.b)}function $n(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function Wn(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function Pt(e,i,l,u){return u<=0?e=i=l=NaN:l<=0||l>=1?e=i=NaN:i<=0&&(e=NaN),new Et(e,i,l,u)}function $e(e){if(e instanceof Et)return new Et(e.h,e.s,e.l,e.opacity);if(e instanceof qt||(e=re(e)),!e)return new Et;if(e instanceof Et)return e;var i=(e=e.rgb()).r/255,l=e.g/255,u=e.b/255,p=Math.min(i,l,u),m=Math.max(i,l,u),g=NaN,w=m-p,y=(m+p)/2;return w?(g=i===m?(l-u)/w+6*(l<u):l===m?(u-i)/w+2:(i-l)/w+4,w/=y<.5?m+p:2-m-p,g*=60):w=y>0&&y<1?0:g,new Et(g,w,y,e.opacity)}function Et(e,i,l,u){this.h=+e,this.s=+i,this.l=+l,this.opacity=+u}function Gn(e,i,l){return 255*(e<60?i+(l-i)*e/60:e<180?l:e<240?i+(l-i)*(240-e)/60:i)}function Tn(e,i,l,u,p){var m=e*e,g=m*e;return((1-3*e+3*m-g)*i+(4-6*m+3*g)*l+(1+3*e+3*m-3*g)*u+g*p)/6}fe(qt,re,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:xe,formatHex:xe,formatHsl:function Lr(){return $e(this).formatHsl()},formatRgb:Ye,toString:Ye}),fe(lt,be,Ve(qt,{brighter:function(e){return e=null==e?mt:Math.pow(mt,e),new lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Yn,formatHex:Yn,formatRgb:$n,toString:$n})),fe(Et,function Ur(e,i,l,u){return 1===arguments.length?$e(e):new Et(e,i,l,null==u?1:u)},Ve(qt,{brighter:function(e){return e=null==e?mt:Math.pow(mt,e),new Et(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?.7:Math.pow(.7,e),new Et(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),i=isNaN(e)||isNaN(this.s)?0:this.s,l=this.l,u=l+(l<.5?l:1-l)*i,p=2*l-u;return new lt(Gn(e>=240?e-240:e+120,p,u),Gn(e,p,u),Gn(e<120?e+240:e-120,p,u),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const jn=e=>()=>e;function Vr(e){return 1==(e=+e)?ho:function(i,l){return l-i?function Qr(e,i,l){return e=Math.pow(e,l),i=Math.pow(i,l)-e,l=1/l,function(u){return Math.pow(e+u*i,l)}}(i,l,e):jn(isNaN(i)?l:i)}}function ho(e,i){var l=i-e;return l?function Xn(e,i){return function(l){return e+l*i}}(e,l):jn(isNaN(e)?i:e)}const Kn=function e(i){var l=Vr(i);function u(p,m){var g=l((p=be(p)).r,(m=be(m)).r),w=l(p.g,m.g),y=l(p.b,m.b),C=ho(p.opacity,m.opacity);return function(A){return p.r=g(A),p.g=w(A),p.b=y(A),p.opacity=C(A),p+""}}return u.gamma=e,u}(1);function An(e){return function(i){var g,w,l=i.length,u=new Array(l),p=new Array(l),m=new Array(l);for(g=0;g<l;++g)w=be(i[g]),u[g]=w.r||0,p[g]=w.g||0,m[g]=w.b||0;return u=e(u),p=e(p),m=e(m),w.opacity=1,function(y){return w.r=u(y),w.g=p(y),w.b=m(y),w+""}}}function Yr(e,i){var g,l=i?i.length:0,u=e?Math.min(l,e.length):0,p=new Array(u),m=new Array(l);for(g=0;g<u;++g)p[g]=rr(e[g],i[g]);for(;g<l;++g)m[g]=i[g];return function(w){for(g=0;g<u;++g)m[g]=p[g](w);return m}}function tr(e,i){var l=new Date;return e=+e,i=+i,function(u){return l.setTime(e*(1-u)+i*u),l}}function Ct(e,i){return e=+e,i=+i,function(l){return e*(1-l)+i*l}}function po(e,i){var p,l={},u={};for(p in(null===e||"object"!=typeof e)&&(e={}),(null===i||"object"!=typeof i)&&(i={}),i)p in e?l[p]=rr(e[p],i[p]):u[p]=i[p];return function(m){for(p in l)u[p]=l[p](m);return u}}An(function ct(e){var i=e.length-1;return function(l){var u=l<=0?l=0:l>=1?(l=1,i-1):Math.floor(l*i),p=e[u],m=e[u+1];return Tn((l-u/i)*i,u>0?e[u-1]:2*p-m,p,m,u<i-1?e[u+2]:2*m-p)}}),An(function Rr(e){var i=e.length;return function(l){var u=Math.floor(((l%=1)<0?++l:l)*i);return Tn((l-u/i)*i,e[(u+i-1)%i],e[u%i],e[(u+1)%i],e[(u+2)%i])}});var er=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zn=new RegExp(er.source,"g");function nr(e,i){var u,p,m,l=er.lastIndex=zn.lastIndex=0,g=-1,w=[],y=[];for(e+="",i+="";(u=er.exec(e))&&(p=zn.exec(i));)(m=p.index)>l&&(m=i.slice(l,m),w[g]?w[g]+=m:w[++g]=m),(u=u[0])===(p=p[0])?w[g]?w[g]+=p:w[++g]=p:(w[++g]=null,y.push({i:g,x:Ct(u,p)})),l=zn.lastIndex;return l<i.length&&(m=i.slice(l),w[g]?w[g]+=m:w[++g]=m),w.length<2?y[0]?function We(e){return function(i){return e(i)+""}}(y[0].x):function go(e){return function(){return e}}(i):(i=y.length,function(C){for(var k,A=0;A<i;++A)w[(k=y[A]).i]=k.x(C);return w.join("")})}function mo(e,i){i||(i=[]);var p,l=e?Math.min(i.length,e.length):0,u=i.slice();return function(m){for(p=0;p<l;++p)u[p]=e[p]*(1-m)+i[p]*m;return u}}function rr(e,i){var u,l=typeof i;return null==i||"boolean"===l?jn(i):("number"===l?Ct:"string"===l?(u=re(i))?(i=u,Kn):nr:i instanceof re?Kn:i instanceof Date?tr:function _o(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}(i)?mo:Array.isArray(i)?Yr:"function"!=typeof i.valueOf&&"function"!=typeof i.toString||isNaN(i)?po:Ct)(e,i)}function vo(e,i){return e=+e,i=+i,function(l){return Math.round(e*(1-l)+i*l)}}function yo(e){return+e}var $r=[0,1];function ut(e){return e}function ir(e,i){return(i-=e=+e)?function(l){return(l-e)/i}:function wo(e){return function(){return e}}(isNaN(i)?NaN:.5)}function bo(e,i,l){var u=e[0],p=e[1],m=i[0],g=i[1];return p<u?(u=ir(p,u),m=l(g,m)):(u=ir(u,p),m=l(m,g)),function(w){return m(u(w))}}function Co(e,i,l){var u=Math.min(e.length,i.length)-1,p=new Array(u),m=new Array(u),g=-1;for(e[u]<e[0]&&(e=e.slice().reverse(),i=i.slice().reverse());++g<u;)p[g]=ir(e[g],e[g+1]),m[g]=l(i[g],i[g+1]);return function(w){var y=Qe(e,w,1,u)-1;return m[y](p[y](w))}}function ie(e,i){return i.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function To(){var u,p,m,w,y,C,e=$r,i=$r,l=rr,g=ut;function A(){var M=Math.min(e.length,i.length);return g!==ut&&(g=function xo(e,i){var l;return e>i&&(l=e,e=i,i=l),function(u){return Math.max(e,Math.min(i,u))}}(e[0],e[M-1])),w=M>2?Co:bo,y=C=null,k}function k(M){return null==M||isNaN(M=+M)?m:(y||(y=w(e.map(u),i,l)))(u(g(M)))}return k.invert=function(M){return g(p((C||(C=w(i,e.map(u),Ct)))(M)))},k.domain=function(M){return arguments.length?(e=Array.from(M,yo),A()):e.slice()},k.range=function(M){return arguments.length?(i=Array.from(M),A()):i.slice()},k.rangeRound=function(M){return i=Array.from(M),l=vo,A()},k.clamp=function(M){return arguments.length?(g=!!M||ut,A()):g!==ut},k.interpolate=function(M){return arguments.length?(l=M,A()):l},k.unknown=function(M){return arguments.length?(m=M,k):m},function(M,q){return u=M,p=q,A()}}function Ao(){return To()(ut,ut)}function zo(e,i){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(i).domain(e)}return this}function Oo(e,i,l,u){var m,p=function io(e,i,l){var u=Math.abs(i-e)/Math.max(0,l),p=Math.pow(10,Math.floor(Math.log(u)/Math.LN10)),m=u/p;return m>=Re?p*=10:m>=ne?p*=5:m>=bn&&(p*=2),i<e?-p:p}(e,i,l);switch((u=_n(null==u?",f":u)).type){case"s":var g=Math.max(Math.abs(e),Math.abs(i));return null==u.precision&&!isNaN(m=function ko(e,i){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Vt(i)/3)))-Vt(Math.abs(e)))}(p,g))&&(u.precision=m),Ar(u,g);case"":case"e":case"g":case"p":case"r":null==u.precision&&!isNaN(m=function Mo(e,i){return e=Math.abs(e),i=Math.abs(i)-e,Math.max(0,Vt(i)-Vt(e))+1}(p,Math.max(Math.abs(e),Math.abs(i))))&&(u.precision=m-("e"===u.type));break;case"f":case"%":null==u.precision&&!isNaN(m=function Zo(e){return Math.max(0,-Vt(Math.abs(e)))}(p))&&(u.precision=m-2*("%"===u.type))}return ve(u)}function So(e){var i=e.domain;return e.ticks=function(l){var u=i();return function Jr(e,i,l){var u,m,g,w,p=-1;if(l=+l,(e=+e)==(i=+i)&&l>0)return[e];if((u=i<e)&&(m=e,e=i,i=m),0===(w=Cn(e,i,l))||!isFinite(w))return[];if(w>0){let y=Math.round(e/w),C=Math.round(i/w);for(y*w<e&&++y,C*w>i&&--C,g=new Array(m=C-y+1);++p<m;)g[p]=(y+p)*w}else{w=-w;let y=Math.round(e*w),C=Math.round(i*w);for(y/w<e&&++y,C/w>i&&--C,g=new Array(m=C-y+1);++p<m;)g[p]=(y+p)/w}return u&&g.reverse(),g}(u[0],u[u.length-1],null==l?10:l)},e.tickFormat=function(l,u){var p=i();return Oo(p[0],p[p.length-1],null==l?10:l,u)},e.nice=function(l){null==l&&(l=10);var y,C,u=i(),p=0,m=u.length-1,g=u[p],w=u[m],A=10;for(w<g&&(C=g,g=w,w=C,C=p,p=m,m=C);A-- >0;){if((C=Cn(g,w,l))===y)return u[p]=g,u[m]=w,i(u);if(C>0)g=Math.floor(g/C)*C,w=Math.ceil(w/C)*C;else{if(!(C<0))break;g=Math.ceil(g*C)/C,w=Math.floor(w*C)/C}y=C}return e},e}function or(){var e=Ao();return e.copy=function(){return ie(e,or())},zo.apply(e,arguments),So(e)}function Wr(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var No={value:()=>{}};function ar(){for(var u,e=0,i=arguments.length,l={};e<i;++e){if(!(u=arguments[e]+"")||u in l||/[\s.]/.test(u))throw new Error("illegal type: "+u);l[u]=[]}return new Ge(l)}function Ge(e){this._=e}function Jo(e,i){return e.trim().split(/^|\s+/).map(function(l){var u="",p=l.indexOf(".");if(p>=0&&(u=l.slice(p+1),l=l.slice(0,p)),l&&!i.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:u}})}function Do(e,i){for(var p,l=0,u=e.length;l<u;++l)if((p=e[l]).name===i)return p.value}function Gr(e,i,l){for(var u=0,p=e.length;u<p;++u)if(e[u].name===i){e[u]=No,e=e.slice(0,u).concat(e.slice(u+1));break}return null!=l&&e.push({name:i,value:l}),e}Ge.prototype=ar.prototype={constructor:Ge,on:function(e,i){var p,l=this._,u=Jo(e+"",l),m=-1,g=u.length;if(!(arguments.length<2)){if(null!=i&&"function"!=typeof i)throw new Error("invalid callback: "+i);for(;++m<g;)if(p=(e=u[m]).type)l[p]=Gr(l[p],e.name,i);else if(null==i)for(p in l)l[p]=Gr(l[p],e.name,null);return this}for(;++m<g;)if((p=(e=u[m]).type)&&(p=Do(l[p],e.name)))return p},copy:function(){var e={},i=this._;for(var l in i)e[l]=i[l].slice();return new Ge(e)},call:function(e,i){if((p=arguments.length-2)>0)for(var p,m,l=new Array(p),u=0;u<p;++u)l[u]=arguments[u+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(u=0,p=(m=this._[e]).length;u<p;++u)m[u].value.apply(i,l)},apply:function(e,i,l){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var u=this._[e],p=0,m=u.length;p<m;++p)u[p].value.apply(i,l)}};const qo=ar;var kn,Ke,Ce=0,je=0,Xe=0,Mn=0,he=0,Zn=0,tn="object"==typeof performance&&performance.now?performance:Date,jr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Ot(){return he||(jr(Fo),he=tn.now()+Zn)}function Fo(){he=0}function en(){this._call=this._time=this._next=null}function It(e,i,l){var u=new en;return u.restart(e,i,l),u}function Wt(){he=(Mn=tn.now())+Zn,Ce=je=0;try{!function Xo(){Ot(),++Ce;for(var i,e=kn;e;)(i=he-e._time)>=0&&e._call.call(void 0,i),e=e._next;--Ce}()}finally{Ce=0,function Eo(){for(var e,l,i=kn,u=1/0;i;)i._call?(u>i._time&&(u=i._time),e=i,i=i._next):(l=i._next,i._next=null,i=e?e._next=l:kn=l);Ke=e,sr(u)}(),he=0}}function Po(){var e=tn.now(),i=e-Mn;i>1e3&&(Zn-=i,Mn=e)}function sr(e){Ce||(je&&(je=clearTimeout(je)),e-he>24?(e<1/0&&(je=setTimeout(Wt,e-tn.now()-Zn)),Xe&&(Xe=clearInterval(Xe))):(Xe||(Mn=tn.now(),Xe=setInterval(Po,1e3)),Ce=1,jr(Wt)))}function Xr(e,i,l){var u=new en;return u.restart(p=>{u.stop(),e(p+i)},i=null==i?0:+i,l),u}en.prototype=It.prototype={constructor:en,restart:function(e,i,l){if("function"!=typeof e)throw new TypeError("callback is not a function");l=(null==l?Ot():+l)+(null==i?0:+i),!this._next&&Ke!==this&&(Ke?Ke._next=this:kn=this,Ke=this),this._call=e,this._time=l,sr()},stop:function(){this._call&&(this._call=null,this._time=1/0,sr())}};var Kr=qo("start","end","cancel","interrupt"),Ko=[];function f(e,i,l,u,p,m){var g=e.__transition;if(g){if(l in g)return}else e.__transition={};!function x(e,i,l){var p,u=e.__transition;function m(C){l.state=1,l.timer.restart(g,l.delay,l.time),l.delay<=C&&g(C-l.delay)}function g(C){var A,k,M,q;if(1!==l.state)return y();for(A in u)if((q=u[A]).name===l.name){if(3===q.state)return Xr(g);4===q.state?(q.state=6,q.timer.stop(),q.on.call("interrupt",e,e.__data__,q.index,q.group),delete u[A]):+A<i&&(q.state=6,q.timer.stop(),q.on.call("cancel",e,e.__data__,q.index,q.group),delete u[A])}if(Xr(function(){3===l.state&&(l.state=4,l.timer.restart(w,l.delay,l.time),w(C))}),l.state=2,l.on.call("start",e,e.__data__,l.index,l.group),2===l.state){for(l.state=3,p=new Array(M=l.tween.length),A=0,k=-1;A<M;++A)(q=l.tween[A].value.call(e,e.__data__,l.index,l.group))&&(p[++k]=q);p.length=k+1}}function w(C){for(var A=C<l.duration?l.ease.call(null,C/l.duration):(l.timer.restart(y),l.state=5,1),k=-1,M=p.length;++k<M;)p[k].call(e,A);5===l.state&&(l.on.call("end",e,e.__data__,l.index,l.group),y())}function y(){for(var C in l.state=6,l.timer.stop(),delete u[i],u)return;delete e.__transition}u[i]=l,l.timer=It(m,0,l.time)}(e,l,{name:i,index:u,group:p,on:Kr,tween:Ko,time:m.time,delay:m.delay,duration:m.duration,ease:m.ease,timer:null,state:0})}function d(e,i){var l=v(e,i);if(l.state>0)throw new Error("too late; already scheduled");return l}function _(e,i){var l=v(e,i);if(l.state>3)throw new Error("too late; already running");return l}function v(e,i){var l=e.__transition;if(!l||!(l=l[i]))throw new Error("transition not found");return l}var Tt,E=180/Math.PI,I={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Q(e,i,l,u,p,m){var g,w,y;return(g=Math.sqrt(e*e+i*i))&&(e/=g,i/=g),(y=e*l+i*u)&&(l-=e*y,u-=i*y),(w=Math.sqrt(l*l+u*u))&&(l/=w,u/=w,y/=w),e*u<i*l&&(e=-e,i=-i,y=-y,g=-g),{translateX:p,translateY:m,rotate:Math.atan2(i,e)*E,skewX:Math.atan(y)*E,scaleX:g,scaleY:w}}function oe(e,i,l,u){function p(C){return C.length?C.pop()+" ":""}return function(C,A){var k=[],M=[];return C=e(C),A=e(A),function m(C,A,k,M,q,R){if(C!==k||A!==M){var tt=q.push("translate(",null,i,null,l);R.push({i:tt-4,x:Ct(C,k)},{i:tt-2,x:Ct(A,M)})}else(k||M)&&q.push("translate("+k+i+M+l)}(C.translateX,C.translateY,A.translateX,A.translateY,k,M),function g(C,A,k,M){C!==A?(C-A>180?A+=360:A-C>180&&(C+=360),M.push({i:k.push(p(k)+"rotate(",null,u)-2,x:Ct(C,A)})):A&&k.push(p(k)+"rotate("+A+u)}(C.rotate,A.rotate,k,M),function w(C,A,k,M){C!==A?M.push({i:k.push(p(k)+"skewX(",null,u)-2,x:Ct(C,A)}):A&&k.push(p(k)+"skewX("+A+u)}(C.skewX,A.skewX,k,M),function y(C,A,k,M,q,R){if(C!==k||A!==M){var tt=q.push(p(q)+"scale(",null,",",null,")");R.push({i:tt-4,x:Ct(C,k)},{i:tt-2,x:Ct(A,M)})}else(1!==k||1!==M)&&q.push(p(q)+"scale("+k+","+M+")")}(C.scaleX,C.scaleY,A.scaleX,A.scaleY,k,M),C=A=null,function(q){for(var ht,R=-1,tt=M.length;++R<tt;)k[(ht=M[R]).i]=ht.x(q);return k.join("")}}}var Nt=oe(function At(e){const i=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return i.isIdentity?I:Q(i.a,i.b,i.c,i.d,i.e,i.f)},"px, ","px)","deg)"),Te=oe(function St(e){return null!=e&&(Tt||(Tt=document.createElementNS("http://www.w3.org/2000/svg","g")),Tt.setAttribute("transform",e),e=Tt.transform.baseVal.consolidate())?Q((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):I},", ",")",")");function On(e,i){var l,u;return function(){var p=_(this,e),m=p.tween;if(m!==l)for(var g=0,w=(u=l=m).length;g<w;++g)if(u[g].name===i){(u=u.slice()).splice(g,1);break}p.tween=u}}function ti(e,i,l){var u,p;if("function"!=typeof l)throw new Error;return function(){var m=_(this,e),g=m.tween;if(g!==u){p=(u=g).slice();for(var w={name:i,value:l},y=0,C=p.length;y<C;++y)if(p[y].name===i){p[y]=w;break}y===C&&p.push(w)}m.tween=p}}function Io(e,i,l){var u=e._id;return e.each(function(){var p=_(this,u);(p.value||(p.value={}))[i]=l.apply(this,arguments)}),function(p){return v(p,u).value[i]}}function Ae(e,i){var l;return("number"==typeof i?Ct:i instanceof re?Kn:(l=re(i))?(i=l,Kn):nr)(e,i)}function ze(e){return function(){this.removeAttribute(e)}}function ni(e){return function(){this.removeAttributeNS(e.space,e.local)}}function J(e,i,l){var u,m,p=l+"";return function(){var g=this.getAttribute(e);return g===p?null:g===u?m:m=i(u=g,l)}}function _t(e,i,l){var u,m,p=l+"";return function(){var g=this.getAttributeNS(e.space,e.local);return g===p?null:g===u?m:m=i(u=g,l)}}function ft(e,i,l){var u,p,m;return function(){var g,y,w=l(this);return null==w?void this.removeAttribute(e):(g=this.getAttribute(e))===(y=w+"")?null:g===u&&y===p?m:(p=y,m=i(u=g,w))}}function Gt(e,i,l){var u,p,m;return function(){var g,y,w=l(this);return null==w?void this.removeAttributeNS(e.space,e.local):(g=this.getAttributeNS(e.space,e.local))===(y=w+"")?null:g===u&&y===p?m:(p=y,m=i(u=g,w))}}function nn(e,i){return function(l){this.setAttribute(e,i.call(this,l))}}function Me(e,i){return function(l){this.setAttributeNS(e.space,e.local,i.call(this,l))}}function Lo(e,i){var l,u;function p(){var m=i.apply(this,arguments);return m!==u&&(l=(u=m)&&Me(e,m)),l}return p._value=i,p}function Bo(e,i){var l,u;function p(){var m=i.apply(this,arguments);return m!==u&&(l=(u=m)&&nn(e,m)),l}return p._value=i,p}function ha(e,i){return function(){d(this,e).delay=+i.apply(this,arguments)}}function pa(e,i){return i=+i,function(){d(this,e).delay=i}}function ga(e,i){return function(){_(this,e).duration=+i.apply(this,arguments)}}function ma(e,i){return i=+i,function(){_(this,e).duration=i}}function va(e,i){if("function"!=typeof i)throw new Error;return function(){_(this,e).ease=i}}function Aa(e,i,l){var u,p,m=function Ta(e){return(e+"").trim().split(/^|\s+/).every(function(i){var l=i.indexOf(".");return l>=0&&(i=i.slice(0,l)),!i||"start"===i})}(i)?d:_;return function(){var g=m(this,e),w=g.on;w!==u&&(p=(u=w).copy()).on(i,l),g.on=p}}var Sa=Kt.prototype.constructor;function ra(e){return function(){this.style.removeProperty(e)}}function Ea(e,i,l){return function(u){this.style.setProperty(e,i.call(this,u),l)}}function Ia(e,i,l){var u,p;function m(){var g=i.apply(this,arguments);return g!==p&&(u=(p=g)&&Ea(e,g,l)),u}return m._value=i,m}function Qa(e){return function(i){this.textContent=e.call(this,i)}}function Va(e){var i,l;function u(){var p=e.apply(this,arguments);return p!==l&&(i=(l=p)&&Qa(p)),i}return u._value=e,u}var Wa=0;function rn(e,i,l,u){this._groups=e,this._parents=i,this._name=l,this._id=u}function ia(){return++Wa}var on=Kt.prototype;rn.prototype=function Ga(e){return Kt().transition(e)}.prototype={constructor:rn,select:function Za(e){var i=this._name,l=this._id;"function"!=typeof e&&(e=dt(e));for(var u=this._groups,p=u.length,m=new Array(p),g=0;g<p;++g)for(var A,k,w=u[g],y=w.length,C=m[g]=new Array(y),M=0;M<y;++M)(A=w[M])&&(k=e.call(A,A.__data__,M,w))&&("__data__"in A&&(k.__data__=A.__data__),C[M]=k,f(C[M],i,l,M,C,v(A,l)));return new rn(m,this._parents,i,l)},selectAll:function Oa(e){var i=this._name,l=this._id;"function"!=typeof e&&(e=Ne(e));for(var u=this._groups,p=u.length,m=[],g=[],w=0;w<p;++w)for(var A,y=u[w],C=y.length,k=0;k<C;++k)if(A=y[k]){for(var q,M=e.call(A,A.__data__,k,y),R=v(A,l),tt=0,ht=M.length;tt<ht;++tt)(q=M[tt])&&f(q,i,l,tt,M,R);m.push(M),g.push(A)}return new rn(m,g,i,l)},selectChild:on.selectChild,selectChildren:on.selectChildren,filter:function ba(e){"function"!=typeof e&&(e=G(e));for(var i=this._groups,l=i.length,u=new Array(l),p=0;p<l;++p)for(var y,m=i[p],g=m.length,w=u[p]=[],C=0;C<g;++C)(y=m[C])&&e.call(y,y.__data__,C,m)&&w.push(y);return new rn(u,this._parents,this._name,this._id)},merge:function Ca(e){if(e._id!==this._id)throw new Error;for(var i=this._groups,l=e._groups,u=i.length,m=Math.min(u,l.length),g=new Array(u),w=0;w<m;++w)for(var M,y=i[w],C=l[w],A=y.length,k=g[w]=new Array(A),q=0;q<A;++q)(M=y[q]||C[q])&&(k[q]=M);for(;w<u;++w)g[w]=i[w];return new rn(g,this._parents,this._name,this._id)},selection:function Na(){return new Sa(this._groups,this._parents)},transition:function Ya(){for(var e=this._name,i=this._id,l=ia(),u=this._groups,p=u.length,m=0;m<p;++m)for(var y,g=u[m],w=g.length,C=0;C<w;++C)if(y=g[C]){var A=v(y,i);f(y,e,l,C,g,{time:A.time+A.delay+A.duration,delay:0,duration:A.duration,ease:A.ease})}return new rn(u,this._parents,e,l)},call:on.call,nodes:on.nodes,node:on.node,size:on.size,empty:on.empty,each:on.each,on:function za(e,i){var l=this._id;return arguments.length<2?v(this.node(),l).on.on(e):this.each(Aa(l,e,i))},attr:function ke(e,i){var l=ue(e),u="transform"===l?Te:Ae;return this.attrTween(e,"function"==typeof i?(l.local?Gt:ft)(l,u,Io(this,"attr."+e,i)):null==i?(l.local?ni:ze)(l):(l.local?_t:J)(l,u,i))},attrTween:function fa(e,i){var l="attr."+e;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==i)return this.tween(l,null);if("function"!=typeof i)throw new Error;var u=ue(e);return this.tween(l,(u.local?Lo:Bo)(u,i))},style:function Pa(e,i,l){var u="transform"==(e+="")?Nt:Ae;return null==i?this.styleTween(e,function Ja(e,i){var l,u,p;return function(){var m=yt(this,e),g=(this.style.removeProperty(e),yt(this,e));return m===g?null:m===l&&g===u?p:p=i(l=m,u=g)}}(e,u)).on("end.style."+e,ra(e)):"function"==typeof i?this.styleTween(e,function qa(e,i,l){var u,p,m;return function(){var g=yt(this,e),w=l(this),y=w+"";return null==w&&(this.style.removeProperty(e),y=w=yt(this,e)),g===y?null:g===u&&y===p?m:(p=y,m=i(u=g,w))}}(e,u,Io(this,"style."+e,i))).each(function Fa(e,i){var l,u,p,w,m="style."+i,g="end."+m;return function(){var y=_(this,e),C=y.on,A=null==y.value[m]?w||(w=ra(i)):void 0;(C!==l||p!==A)&&(u=(l=C).copy()).on(g,p=A),y.on=u}}(this._id,e)):this.styleTween(e,function Da(e,i,l){var u,m,p=l+"";return function(){var g=yt(this,e);return g===p?null:g===u?m:m=i(u=g,l)}}(e,u,i),l).on("end.style."+e,null)},styleTween:function La(e,i,l){var u="style."+(e+="");if(arguments.length<2)return(u=this.tween(u))&&u._value;if(null==i)return this.tween(u,null);if("function"!=typeof i)throw new Error;return this.tween(u,Ia(e,i,null==l?"":l))},text:function Ra(e){return this.tween("text","function"==typeof e?function Ua(e){return function(){var i=e(this);this.textContent=null==i?"":i}}(Io(this,"text",e)):function Ba(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function Ha(e){var i="text";if(arguments.length<1)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,Va(e))},remove:function Ma(){return this.on("end.remove",function ka(e){return function(){var i=this.parentNode;for(var l in this.__transition)if(+l!==e)return;i&&i.removeChild(this)}}(this._id))},tween:function ei(e,i){var l=this._id;if(e+="",arguments.length<2){for(var g,u=v(this.node(),l).tween,p=0,m=u.length;p<m;++p)if((g=u[p]).name===e)return g.value;return null}return this.each((null==i?On:ti)(l,e,i))},delay:function da(e){var i=this._id;return arguments.length?this.each(("function"==typeof e?ha:pa)(i,e)):v(this.node(),i).delay},duration:function _a(e){var i=this._id;return arguments.length?this.each(("function"==typeof e?ga:ma)(i,e)):v(this.node(),i).duration},ease:function wa(e){var i=this._id;return arguments.length?this.each(va(i,e)):v(this.node(),i).ease},easeVarying:function xa(e){if("function"!=typeof e)throw new Error;return this.each(function ya(e,i){return function(){var l=i.apply(this,arguments);if("function"!=typeof l)throw new Error;_(this,e).ease=l}}(this._id,e))},end:function $a(){var e,i,l=this,u=l._id,p=l.size();return new Promise(function(m,g){var w={value:g},y={value:function(){0==--p&&m()}};l.each(function(){var C=_(this,u),A=C.on;A!==e&&((i=(e=A).copy())._.cancel.push(w),i._.interrupt.push(w),i._.end.push(y)),C.on=i}),0===p&&m()})},[Symbol.iterator]:on[Symbol.iterator]};var ja={time:null,delay:0,duration:250,ease:Wr};function Xa(e,i){for(var l;!(l=e.__transition)||!(l=l[i]);)if(!(e=e.parentNode))throw new Error(`transition ${i} not found`);return l}function rs(){let e=960,i=null,l=18,u=null,p=null,m="",g=750,w=Wr,y=!1,C=!1,A=null,k=null,M=0,q=null,R=null,tt=!1,ht=!1,pe=!1,zt=null,kt=!1,Ze=null,et=function(b){return b.data.n||b.data.name},Sn=function(b){return"v"in b?b.v:b.value},Oe=function(b){return b.c||b.children},ri=function(b){return b.data.l||b.data.libtype},Uo=function(b){return"d"in b.data?b.data.d:b.data.delta},lr=function(b,N,S){R=()=>{q&&(q.textContent="search: "+N+" of "+S+" total samples ( "+ve(".3f")(N/S*100,3)+"%)")},R()};const V=lr;let ae=(b,N,S=!1)=>{if(!N)return!1;let P=et(b);S&&(N=N.toLowerCase(),P=P.toLowerCase());const U=new RegExp(N);return void 0!==P&&P&&P.match(U)};const Lt=ae;let Bt=function(b){q&&(b?q.textContent=b:"function"==typeof R?R():q.textContent="")};const ta=Bt;let an=function(b){return et(b)+" ("+ve(".3f")(100*(b.x1-b.x0),3)+"%, "+Sn(b)+" samples)"},sn=function(b){return b.highlight?"#E600E6":function de(b,N){let S=Ze||"warm";return!Ze&&void 0!==N&&""!==N&&(S="red",void 0!==b&&b&&b.match(/::/)&&(S="yellow"),"kernel"===N?S="orange":"jit"===N?S="green":"inlined"===N&&(S="aqua")),function ns(e,i){let l,u,p;return"red"===e?(l=200+Math.round(55*i),u=50+Math.round(80*i),p=u):"orange"===e?(l=190+Math.round(65*i),u=90+Math.round(65*i),p=0):"yellow"===e?(l=175+Math.round(55*i),u=l,p=50+Math.round(20*i)):"green"===e?(l=50+Math.round(60*i),u=200+Math.round(55*i),p=l):"pastelgreen"===e?(l=163+Math.round(75*i),u=195+Math.round(49*i),p=72+Math.round(149*i)):"blue"===e?(l=91+Math.round(126*i),u=156+Math.round(76*i),p=221+Math.round(26*i)):"aqua"===e?(l=50+Math.round(60*i),u=165+Math.round(55*i),p=u):"cold"===e?(l=0+Math.round(55*(1-i)),u=0+Math.round(230*(1-i)),p=200+Math.round(55*i)):(l=200+Math.round(55*i),u=0+Math.round(230*(1-i)),p=0+Math.round(55*(1-i))),"rgb("+l+","+u+","+p+")"}(S,function es(e){let i=0;if(e){const l=e.split("`");l.length>1&&(e=l[l.length-1]),i=function ts(e){let l=0,u=0,p=1;if(e){for(let g=0;g<e.length&&!(g>6);g++)l+=p*(e.charCodeAt(g)%10),u+=9*p,p*=.7;u>0&&(l/=u)}return l}(e=e.split("(")[0])}return i}(b))}(et(b),ri(b))};const cr=sn;function oa(b){b.data.fade=!1,b.data.hide=!1,b.children&&b.children.forEach(oa)}function aa(b){b.parent&&(b.parent.data.fade=!0,aa(b.parent))}function ea(b){if(p&&p.hide(),function is(b){let P,U,$,N=b,S=N.parent;for(;S;){for(P=S.children,U=P.length;U--;)$=P[U],$!==N&&($.data.hide=!0);N=S,S=N.parent}}(b),oa(b),aa(b),ii(),pe){const N=mn(this).select("svg")._groups[0][0].parentNode.offsetTop,S=(window.innerHeight-N)/l;window.scrollTo({top:N+(b.height-S+10)*l,left:0,behavior:"smooth"})}"function"==typeof A&&A(b)}function sa(b,N){if(b.id===N)return b;{const S=Oe(b);if(S)for(let P=0;P<S.length;P++){const U=sa(S[P],N);if(U)return U}}}function la(b){b.highlight=!1,Oe(b)&&Oe(b).forEach(function(N){la(N)})}function as(b,N){return"function"==typeof y?y(b,N):y?Be(et(b),et(N)):void 0}const ss=Ki();function ii(){u.each(function(b){const N=or().range([0,e]),S=or().range([0,l]);ua(b),y&&b.sort(as),ss(b);const P=e/(b.x1-b.x0);function U(W){return(W.x1-W.x0)*P}const $=function ls(b){let N=b.descendants();if(M>0){const S=e/(b.x1-b.x0);N=N.filter(function(P){return(P.x1-P.x0)*S>M})}return N}(b),pt=mn(this).select("svg");pt.attr("width",e);let nt=pt.selectAll("g").data($,function(W){return W.id});(!i||ht)&&(i=(Math.max.apply(null,$.map(function(ge){return ge.depth}))+3)*l,i<zt&&(i=zt),pt.attr("height",i)),nt.transition().duration(g).ease(w).attr("transform",function(W){return"translate("+N(W.x0)+","+(C?S(W.depth):i-S(W.depth)-l)+")"}),nt.select("rect").transition().duration(g).ease(w).attr("width",U);const ln=nt.enter().append("svg:g").attr("transform",function(W){return"translate("+N(W.x0)+","+(C?S(W.depth):i-S(W.depth)-l)+")"});ln.append("svg:rect").transition().delay(g/2).attr("width",U),p||ln.append("svg:title"),ln.append("foreignObject").append("xhtml:div"),nt=pt.selectAll("g").data($,function(W){return W.id}),nt.attr("width",U).attr("height",function(W){return l}).attr("name",function(W){return et(W)}).attr("class",function(W){return W.data.fade?"frame fade":"frame"}),nt.select("rect").attr("height",function(W){return l}).attr("fill",function(W){return sn(W)}),p||nt.select("title").text(an),nt.select("foreignObject").attr("width",U).attr("height",function(W){return l}).select("div").attr("class","d3-flame-graph-label").style("display",function(W){return U(W)<35?"none":"block"}).transition().delay(g).text(et),nt.on("click",(W,ge)=>{ea(ge)}),nt.exit().remove(),nt.on("mouseover",function(W,ge){p&&p.show(ge,this),Bt(an(ge)),"function"==typeof k&&k(ge)}).on("mouseout",function(){p&&p.hide(),Bt(null)})})}function ca(b,N){N.forEach(function(S){const P=b.find(function(U){return U.name===S.name});P?(P.value+=S.value,S.children&&(P.children||(P.children=[]),ca(P.children,S.children))):b.push(S)})}function ua(b){let N,S,P,U,$,pt,nt,ln;const W=[],ge=[],Ro=[],fs=!tt;let ur=b.data;for(ur.hide?(b.value=0,S=b.children,S&&Ro.push(S)):(b.value=ur.fade?0:Sn(ur),W.push(b));N=W.pop();)if(S=N.children,S&&($=S.length)){for(U=0;$--;)nt=S[$],ur=nt.data,ur.hide?(nt.value=0,P=nt.children,P&&Ro.push(P)):(ur.fade?nt.value=0:(ln=Sn(ur),nt.value=ln,U+=ln),W.push(nt));fs&&N.value&&(N.value-=U),ge.push(S)}for($=ge.length;$--;){for(S=ge[$],U=0,pt=S.length;pt--;)U+=S[pt].value;S[0].parent.value+=U}for(;Ro.length;)for(S=Ro.pop(),pt=S.length;pt--;)nt=S[pt],nt.value=0,P=nt.children,P&&Ro.push(P)}function na(){u.datum(b=>{if("Node"!==b.constructor.name){const N=gt(b,Oe);return function us(b){let N=0;!function cs(b,N){N(b);let S=b.children;if(S){const P=[S];let U,$,pt;for(;P.length;)for(S=P.pop(),U=S.length;U--;)$=S[U],N($),pt=$.children,pt&&P.push(pt)}}(b,function(S){S.id=N++})}(N),ua(N),N.originalValue=N.value,kt&&N.eachAfter(S=>{let P=Uo(S);const U=S.children;let $=U&&U.length;for(;--$>=0;)P+=U[$].delta;S.delta=P}),N}})}function Z(b){if(!arguments.length)return Z;u=b,na(),u.each(function(N){if(0===mn(this).select("svg").size()){const S=mn(this).append("svg:svg").attr("width",e).attr("class","partition d3-flame-graph");i&&(i<zt&&(i=zt),S.attr("height",i)),S.append("svg:text").attr("class","title").attr("text-anchor","middle").attr("y","25").attr("x",e/2).attr("fill","#808080").text(m),p&&S.call(p)}}),ii()}return Z.height=function(b){return arguments.length?(i=b,Z):i},Z.minHeight=function(b){return arguments.length?(zt=b,Z):zt},Z.width=function(b){return arguments.length?(e=b,Z):e},Z.cellHeight=function(b){return arguments.length?(l=b,Z):l},Z.tooltip=function(b){return arguments.length?("function"==typeof b&&(p=b),Z):p},Z.title=function(b){return arguments.length?(m=b,Z):m},Z.transitionDuration=function(b){return arguments.length?(g=b,Z):g},Z.transitionEase=function(b){return arguments.length?(w=b,Z):w},Z.sort=function(b){return arguments.length?(y=b,Z):y},Z.inverted=function(b){return arguments.length?(C=b,Z):C},Z.computeDelta=function(b){return arguments.length?(kt=b,Z):kt},Z.label=Z.setLabelHandler=function(b){return arguments.length?(an=b,Z):an},Z.search=function(b){const N=[];let S=0,P=0;u.each(function(U){const $=function os(b,N){const S=[];let P=0;return function U($,pt){let nt=!1;ae($,N)?($.highlight=!0,nt=!0,pt||(P+=Sn($)),S.push($)):$.highlight=!1,Oe($)&&Oe($).forEach(function(ln){U(ln,pt||nt)})}(b,!1),[S,P]}(U,b);N.push(...$[0]),S+=$[1],P+=U.originalValue}),lr(N,S,P),ii()},Z.findById=function(b){if(null==b)return null;let N=null;return u.each(function(S){null===N&&(N=sa(S,b))}),N},Z.clear=function(){Bt(null),u.each(function(b){la(b),ii()})},Z.zoomTo=function(b){ea(b)},Z.resetZoom=function(){u.each(function(b){ea(b)})},Z.onClick=function(b){return arguments.length?(A=b,Z):A},Z.onHover=function(b){return arguments.length?(k=b,Z):k},Z.merge=function(b){return u&&(this.resetZoom(),R=null,Bt(null),u.datum(N=>(ca([N.data],[b]),N.data)),na(),ii()),Z},Z.update=function(b){return u&&(b&&(u.datum(b),na()),ii()),Z},Z.destroy=function(){return u&&(p&&(p.hide(),"function"==typeof p.destroy&&p.destroy()),u.selectAll("svg").remove()),Z},Z.color=Z.setColorMapper=function(b){return arguments.length?(sn=N=>{const S=cr(N);return b(N,S)},Z):(sn=cr,Z)},Z.setColorHue=function(b){return arguments.length?(Ze=b,Z):(Ze=null,Z)},Z.minFrameSize=function(b){return arguments.length?(M=b,Z):M},Z.details=Z.setDetailsElement=function(b){return arguments.length?(q=b,Z):q},Z.selfValue=function(b){return arguments.length?(tt=b,Z):tt},Z.resetHeightOnZoom=function(b){return arguments.length?(ht=b,Z):ht},Z.scrollOnZoom=function(b){return arguments.length?(pe=b,Z):pe},Z.getName=function(b){return arguments.length?(et=b,Z):et},Z.getValue=function(b){return arguments.length?(Sn=b,Z):Sn},Z.getChildren=function(b){return arguments.length?(Oe=b,Z):Oe},Z.getLibtype=function(b){return arguments.length?(ri=b,Z):ri},Z.getDelta=function(b){return arguments.length?(Uo=b,Z):Uo},Z.setSearchHandler=function(b){return arguments.length?(lr=b,Z):(lr=V,Z)},Z.setDetailsHandler=function(b){return arguments.length?(Bt=b,Z):(Bt=ta,Z)},Z.setSearchMatch=function(b){return arguments.length?(ae=b,Z):(ae=Lt,Z)},Z}return Kt.prototype.interrupt=function z(e){return this.each(function(){!function T(e,i){var u,p,g,l=e.__transition,m=!0;if(l){for(g in i=null==i?null:i+"",l)(u=l[g]).name===i?(p=u.state>2&&u.state<5,u.state=6,u.timer.stop(),u.on.call(p?"interrupt":"cancel",e,e.__data__,u.index,u.group),delete l[g]):m=!1;m&&delete e.__transition}}(this,e)})},Kt.prototype.transition=function Ka(e){var i,l;e instanceof rn?(i=e._id,e=e._name):(i=ia(),(l=ja).time=Ot(),e=null==e?null:e+"");for(var u=this._groups,p=u.length,m=0;m<p;++m)for(var y,g=u[m],w=g.length,C=0;C<w;++C)(y=g[C])&&f(y,e,i,C,g,l||Xa(y,i));return new rn(u,this._parents,e,i)},O.default})()}}]);