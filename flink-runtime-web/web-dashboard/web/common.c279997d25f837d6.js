"use strict";(self.webpackChunkflink=self.webpackChunkflink||[]).push([[592],{22423:(z,m,o)=>{o.d(m,{O:()=>E});var t=o(68896),C=o(30567),d=o(24850),r=o(27221),u=o(5e3),_=o(40520),f=o(70946);let E=(()=>{class a{constructor(n,e){this.httpClient=n,this.configService=e}cancelJob(n){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/yarn-cancel`)}loadJobs(){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/overview`).pipe((0,d.U)(n=>(n.jobs.forEach(e=>{for(const l in e.tasks){const h=l.toUpperCase();e.tasks[h]=e.tasks[l],delete e.tasks[l]}e.completed=["FINISHED","FAILED","CANCELED"].indexOf(e.state)>-1}),n.jobs||[])),(0,r.K)(()=>t.E))}loadJobConfig(n){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/config`)}loadJob(n){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}`).pipe((0,d.U)(e=>this.convertJob(e)))}loadAccumulators(n,e){return(0,C.D)([this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/accumulators`),this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/subtasks/accumulators`)]).pipe((0,d.U)(([l,h])=>({main:l["user-accumulators"],subtasks:h.subtasks})))}loadExceptions(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/exceptions?maxExceptions=${e}`)}loadOperatorBackPressure(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/backpressure`)}loadOperatorFlameGraph(n,e,l){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/flamegraph?type=${l}`)}loadSubTasks(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}`)}loadSubTaskTimes(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/subtasktimes`)}loadTaskManagers(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/vertices/${e}/taskmanagers`)}loadCheckpointStats(n){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/checkpoints`)}loadCheckpointConfig(n){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/checkpoints/config`)}loadCheckpointDetails(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/checkpoints/details/${e}`)}loadCheckpointSubtaskDetails(n,e,l){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/checkpoints/details/${e}/subtasks/${l}`)}convertJob(n){var e,l;const h=[];let v=[];if(null===(l=null===(e=n.plan)||void 0===e?void 0:e.nodes)||void 0===l?void 0:l.length){v=n.plan.nodes.map(s=>{let g;return n.vertices&&n.vertices.length&&(g=n.vertices.find(i=>i.id===s.id)),Object.assign(Object.assign({},s),{detail:g})}),v.forEach(s=>{s.inputs&&s.inputs.length&&s.inputs.forEach(g=>{h.push(Object.assign(Object.assign({},g),{source:g.id,target:s.id,id:`${g.id}-${s.id}`}))})});const T=n.vertices.map(s=>s.id);v.sort((s,g)=>T.indexOf(s.id)-T.indexOf(g.id))}return Object.assign(Object.assign({},n),{plan:Object.assign(Object.assign({},n.plan),{nodes:v,links:h})})}}return a.\u0275fac=function(n){return new(n||a)(u.LFG(_.eN),u.LFG(f.E))},a.\u0275prov=u.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},45695:(z,m,o)=>{o.d(m,{k:()=>E});var t=o(40520),C=o(21086),d=o(68896),r=o(24850),u=o(27221),_=o(5e3),f=o(70946);let E=(()=>{class a{constructor(n,e){this.httpClient=n,this.configService=e}loadManagers(){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers`).pipe((0,r.U)(n=>n.taskmanagers||[]),(0,u.K)(()=>(0,C.of)([])))}loadManager(n){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}`).pipe((0,u.K)(()=>d.E))}loadLogList(n){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}/logs`).pipe((0,r.U)(e=>e.logs))}loadLog(n,e){const l=`${this.configService.BASE_URL}/taskmanagers/${n}/logs/${e}`;return this.httpClient.get(l,{responseType:"text",headers:(new t.WM).append("Cache-Control","no-cache")}).pipe((0,r.U)(h=>({data:h,url:l})))}loadThreadDump(n){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}/thread-dump`).pipe((0,r.U)(e=>e.threadInfos.map(l=>l.stringifiedThreadInfo).join("")))}loadLogs(n){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}/log`,{responseType:"text",headers:(new t.WM).append("Cache-Control","no-cache")})}loadStdout(n){return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}/stdout`,{responseType:"text",headers:(new t.WM).append("Cache-Control","no-cache")})}loadMetrics(n,e){const l=e.join(",");return this.httpClient.get(`${this.configService.BASE_URL}/taskmanagers/${n}/metrics?get=${l}`).pipe((0,r.U)(h=>{const v={};return h.forEach(T=>{v[T.id]=parseInt(T.value,10)}),v}))}loadHistoryServerTaskManagerLogUrl(n,e){return this.httpClient.get(`${this.configService.BASE_URL}/jobs/${n}/taskmanagers/${e}/log-url`).pipe((0,r.U)(l=>l.url))}}return a.\u0275fac=function(n){return new(n||a)(_.LFG(t.eN),_.LFG(f.E))},a.\u0275prov=_.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})()},67035:(z,m,o)=>{o.d(m,{I:()=>T});var t=o(5e3),C=o(77484),d=o(69808),r=o(70592);function u(s,g){if(1&s&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t.TgZ(2,"strong"),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"td",2),t._uU(5),t.qZA(),t.qZA()),2&s){const i=g.$implicit;t.xp6(3),t.Oqu(i.key),t.xp6(1),t.uIk("title",i.value),t.xp6(1),t.Oqu(i.value)}}const _=function(){return{y:"200px"}};let f=(()=>{class s{constructor(){this.listOfData=[],this.trackByKey=(i,c)=>c.key}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["flink-table-display"]],inputs:{listOfData:"listOfData"},decls:3,vars:11,consts:[[3,"nzData","nzSize","nzFrontPagination","nzShowPagination","nzVirtualItemSize","nzVirtualMaxBufferPx","nzVirtualMinBufferPx","nzVirtualForTrackBy","nzScroll"],[4,"ngFor","ngForOf"],[1,"td-value"]],template:function(i,c){1&i&&(t.TgZ(0,"nz-table",0),t.TgZ(1,"tbody"),t.YNc(2,u,6,3,"tr",1),t.qZA(),t.qZA()),2&i&&(t.Q6J("nzData",c.listOfData)("nzSize","small")("nzFrontPagination",!1)("nzShowPagination",!1)("nzVirtualItemSize",36)("nzVirtualMaxBufferPx",300)("nzVirtualMinBufferPx",300)("nzVirtualForTrackBy",c.trackByKey)("nzScroll",t.DdM(10,_)),t.xp6(2),t.Q6J("ngForOf",c.listOfData))},directives:[r.N8,r.p0,d.sg,r.$Z,r.Uo],styles:["[_nghost-%COMP%]   td[_ngcontent-%COMP%]{width:50%;font-size:12px}[_nghost-%COMP%]   td.td-value[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:pre}"],changeDetection:0}),s})();var E=o(90685);function a(s,g){if(1&s&&t._UZ(0,"flink-table-display",6),2&s){const i=t.oxw();t.Q6J("listOfData",i.configurations)}}function p(s,g){if(1&s&&t._UZ(0,"flink-table-display",6),2&s){const i=t.oxw();t.Q6J("listOfData",i.convertJVMToKV(i.environmentInfo.jvm))}}function n(s,g){if(1&s&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.qZA()),2&s){const i=g.$implicit;t.xp6(1),t.uIk("title",i),t.xp6(1),t.Oqu(i)}}const e=function(){return{y:"200px"}};function l(s,g){if(1&s&&(t.TgZ(0,"nz-table",7),t.YNc(1,n,3,2,"tr",8),t.qZA()),2&s){const i=t.oxw();t.Q6J("nzData",i.environmentInfo.classpath)("nzSize","small")("nzFrontPagination",!1)("nzShowPagination",!1)("nzScroll",t.DdM(6,e)),t.xp6(1),t.Q6J("ngForOf",i.environmentInfo.classpath)}}function h(s,g){1&s&&t._UZ(0,"nz-empty",11)}function v(s,g){if(1&s&&(t.TgZ(0,"div",9),t.YNc(1,h,1,0,"nz-empty",10),t.qZA()),2&s){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",!i.loading)}}let T=(()=>{class s{constructor(){this.title="Configurations",this.configurations=[],this.loading=!0}convertJVMToKV(i){return[{key:"version",value:i.version},{key:"arch",value:i.arch},{key:"options",value:i.options.join("\n")}]}}return s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=t.Xpm({type:s,selectors:[["flink-configuration-cards"]],inputs:{title:"title",configurations:"configurations",environmentInfo:"environmentInfo",loading:"loading"},decls:8,vars:10,consts:[["nzType","inner",3,"nzTitle","nzLoading"],[3,"listOfData",4,"ngIf","ngIfElse"],["nzType","inner","nzTitle","JVM",3,"nzLoading"],["nzType","inner","nzTitle","Classpath",3,"nzLoading"],[3,"nzData","nzSize","nzFrontPagination","nzShowPagination","nzScroll",4,"ngIf","ngIfElse"],["noDataTemplate",""],[3,"listOfData"],[3,"nzData","nzSize","nzFrontPagination","nzShowPagination","nzScroll"],[4,"ngFor","ngForOf"],[1,"empty"],["class","ant-empty-normal","nzNotFoundImage","simple",4,"ngIf"],["nzNotFoundImage","simple",1,"ant-empty-normal"]],template:function(i,c){if(1&i&&(t.TgZ(0,"nz-card",0),t.YNc(1,a,1,1,"flink-table-display",1),t.qZA(),t.TgZ(2,"nz-card",2),t.YNc(3,p,1,1,"flink-table-display",1),t.qZA(),t.TgZ(4,"nz-card",3),t.YNc(5,l,2,7,"nz-table",4),t.qZA(),t.YNc(6,v,2,1,"ng-template",null,5,t.W1O)),2&i){const O=t.MAs(7);t.Q6J("nzTitle",c.title)("nzLoading",c.loading),t.xp6(1),t.Q6J("ngIf",c.configurations.length)("ngIfElse",O),t.xp6(1),t.Q6J("nzLoading",c.loading),t.xp6(1),t.Q6J("ngIf",c.environmentInfo)("ngIfElse",O),t.xp6(1),t.Q6J("nzLoading",c.loading),t.xp6(1),t.Q6J("ngIf",c.environmentInfo)("ngIfElse",O)}},directives:[C.bd,d.O5,f,r.N8,d.sg,r.$Z,r.Uo,E.p9],styles:["[_nghost-%COMP%]   nz-card[_ngcontent-%COMP%]{margin:24px}[_nghost-%COMP%]   td[_ngcontent-%COMP%]{font-size:12px}[_nghost-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;justify-content:center}[_nghost-%COMP%]     .ant-collapse>.ant-collapse-item>.ant-collapse-header{padding:0 16px}"],changeDetection:0}),s})()},16672:(z,m,o)=>{o.d(m,{A:()=>d});var t=o(5e3),C=o(70946);let d=(()=>{class r{constructor(_){this.configService=_}backgroundColor(_){return this.configService.COLOR_MAP[_]}}return r.\u0275fac=function(_){return new(_||r)(t.Y36(C.E))},r.\u0275cmp=t.Xpm({type:r,selectors:[["flink-job-badge"]],inputs:{state:"state"},decls:3,vars:3,consts:[[1,"background"]],template:function(_,f){1&_&&(t.TgZ(0,"div",0),t.TgZ(1,"span"),t._uU(2),t.qZA(),t.qZA()),2&_&&(t.xp6(1),t.Udp("background",f.backgroundColor(f.state)),t.xp6(1),t.Oqu(f.state))},styles:["span[_ngcontent-%COMP%]{width:30px;padding:3px 5px;color:#fff;font-weight:700;text-align:center;cursor:default}"],changeDetection:0}),r})()},312:(z,m,o)=>{o.d(m,{Q:()=>T});var t=o(5e3),C=o(8929),d=o(7625),r=o(61709),u=o(22679),_=o(22423),f=o(49727),E=o(77484),a=o(70592),p=o(69808),n=o(5416),e=o(16672),l=o(40870),h=o(53148);function v(s,g){if(1&s){const i=t.EpF();t.TgZ(0,"tr",6),t.NdJ("click",function(){const P=t.CHM(i).$implicit;return t.oxw().navigateToJob(P)}),t.TgZ(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.ALo(5,"humanizeDate"),t.qZA(),t.TgZ(6,"td"),t._uU(7),t.ALo(8,"humanizeDuration"),t.qZA(),t.TgZ(9,"td"),t._uU(10),t.ALo(11,"humanizeDate"),t.qZA(),t.TgZ(12,"td"),t._UZ(13,"flink-task-badge",7),t.qZA(),t.TgZ(14,"td"),t._UZ(15,"flink-job-badge",8),t.qZA(),t.qZA()}if(2&s){const i=g.$implicit;t.xp6(2),t.Oqu(i.name),t.xp6(2),t.Oqu(t.xi3(5,6,i["start-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Oqu(t.lcZ(8,9,i.duration)),t.xp6(3),t.Oqu(t.xi3(11,11,i["end-time"],"yyyy-MM-dd HH:mm:ss")),t.xp6(3),t.Q6J("tasks",i.tasks),t.xp6(2),t.Q6J("state",i.state)}}let T=(()=>{class s{constructor(i,c,O,P){this.statusService=i,this.jobService=c,this.nzMessageService=O,this.cdr=P,this.listOfJob=[],this.isLoading=!0,this.destroy$=new C.xQ,this.completed=!1,this.navigate=new t.vpe,this.sortStartTimeFn=(D,M)=>D["start-time"]-M["start-time"],this.sortDurationFn=(D,M)=>D.duration-M.duration,this.sortEndTimeFn=(D,M)=>D["end-time"]-M["end-time"],this.sortStateFn=(D,M)=>D.state.localeCompare(M.state)}trackJobBy(i,c){return c.jid}navigateToJob(i){"INITIALIZING"===i.state?this.nzMessageService.info("Job detail page is not available while it is in state INITIALIZING."):this.navigate.emit(i)}ngOnInit(){this.jobData$=this.jobData$||this.statusService.refresh$.pipe((0,d.R)(this.destroy$),(0,r.zg)(()=>this.jobService.loadJobs())),this.jobData$.subscribe(i=>{this.isLoading=!1,this.listOfJob=i.filter(c=>c.completed===this.completed),this.cdr.markForCheck()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngOnChanges(i){const{completed:c}=i;c&&(this.isLoading=!0,this.cdr.markForCheck())}}return s.\u0275fac=function(i){return new(i||s)(t.Y36(u.B),t.Y36(_.O),t.Y36(f.dD),t.Y36(t.sBO))},s.\u0275cmp=t.Xpm({type:s,selectors:[["flink-job-list"]],inputs:{completed:"completed",title:"title",jobData$:"jobData$"},outputs:{navigate:"navigate"},features:[t.TTD],decls:19,vars:13,consts:[[3,"nzBordered","nzTitle","nzLoading"],[1,"no-border",3,"nzSize","nzData","nzFrontPagination","nzShowPagination"],["table",""],["nzWidth","40%"],[3,"nzSortFn"],["class","clickable",3,"click",4,"ngFor","ngForOf","ngForTrackBy"],[1,"clickable",3,"click"],[3,"tasks"],[3,"state"]],template:function(i,c){if(1&i&&(t.TgZ(0,"nz-card",0),t.TgZ(1,"nz-table",1,2),t.TgZ(3,"thead"),t.TgZ(4,"tr"),t.TgZ(5,"th",3),t._uU(6,"Job Name"),t.qZA(),t.TgZ(7,"th",4),t._uU(8,"Start Time"),t.qZA(),t.TgZ(9,"th",4),t._uU(10,"Duration"),t.qZA(),t.TgZ(11,"th",4),t._uU(12,"End Time"),t.qZA(),t.TgZ(13,"th"),t._uU(14,"Tasks"),t.qZA(),t.TgZ(15,"th",4),t._uU(16,"Status"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"tbody"),t.YNc(18,v,16,14,"tr",5),t.qZA(),t.qZA(),t.qZA()),2&i){const O=t.MAs(2);t.Q6J("nzBordered",!1)("nzTitle",c.title)("nzLoading",c.isLoading),t.xp6(1),t.Q6J("nzSize","small")("nzData",c.listOfJob)("nzFrontPagination",!1)("nzShowPagination",!1),t.xp6(6),t.Q6J("nzSortFn",c.sortStartTimeFn),t.xp6(2),t.Q6J("nzSortFn",c.sortDurationFn),t.xp6(2),t.Q6J("nzSortFn",c.sortEndTimeFn),t.xp6(4),t.Q6J("nzSortFn",c.sortStateFn),t.xp6(3),t.Q6J("ngForOf",O.data)("ngForTrackBy",c.trackJobBy)}},directives:[E.bd,a.N8,a.Om,a.$Z,a.Uo,a._C,a.qD,a.p0,p.sg,n.K,e.A],pipes:[l.c,h.w],styles:["[_nghost-%COMP%]     .ant-card-body{padding:24px 16px}"],changeDetection:0}),s})()},5416:(z,m,o)=>{o.d(m,{K:()=>E});var t=o(5e3),C=o(70946),d=o(69808),r=o(16695);function u(a,p){if(1&a&&(t.TgZ(0,"span",4),t._uU(1),t.qZA()),2&a){const n=t.oxw().$implicit,e=t.oxw(2);t.Udp("background",e.colorMap[n]),t.Q6J("nzTooltipTitle",n),t.xp6(1),t.hij(" ",e.tasks[n]," ")}}function _(a,p){if(1&a&&(t.ynx(0),t.YNc(1,u,2,4,"span",3),t.BQk()),2&a){const n=p.$implicit,e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.tasks[n])}}function f(a,p){if(1&a&&(t.TgZ(0,"div",1),t.YNc(1,_,2,1,"ng-container",2),t.qZA()),2&a){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.statusList)}}let E=(()=>{class a{constructor(n){this.configService=n,this.statusList=Object.keys(this.configService.COLOR_MAP)}get colorMap(){return this.configService.COLOR_MAP}}return a.\u0275fac=function(n){return new(n||a)(t.Y36(C.E))},a.\u0275cmp=t.Xpm({type:a,selectors:[["flink-task-badge"]],inputs:{tasks:"tasks"},decls:1,vars:1,consts:[["class","background",4,"ngIf"],[1,"background"],[4,"ngFor","ngForOf"],["nz-tooltip","",3,"nzTooltipTitle","background",4,"ngIf"],["nz-tooltip","",3,"nzTooltipTitle"]],template:function(n,e){1&n&&t.YNc(0,f,2,1,"div",0),2&n&&t.Q6J("ngIf",e.tasks)},directives:[d.O5,d.sg,r.SY],styles:["span[_ngcontent-%COMP%]{min-width:32px;padding:3px 5px;color:#fff;font-weight:700;text-align:center;cursor:default}"],changeDetection:0}),a})()},53148:(z,m,o)=>{o.d(m,{w:()=>d});var t=o(7963),C=o(5e3);let d=(()=>{class r{transform(_,f=!1){if((0,t.k)(_)||isNaN(_))return"-";if(_<0)return"-";{const E=_%1e3;let a=Math.floor(_/1e3);const p=a%60;a=Math.floor(a/60);const n=a%60;a=Math.floor(a/60);const e=a%24;a=Math.floor(a/24);const l=a;return 0===l?0===e?0===n?0===p?`${E}ms`:`${p}s`:`${n}m ${p}s`:f?`${e}h ${n}m`:`${e}h ${n}m ${p}s`:f?`${l}d ${e}h`:`${l}d ${e}h ${n}m ${p}s`}}}return r.\u0275fac=function(_){return new(_||r)},r.\u0275pipe=C.Yjl({name:"humanizeDuration",type:r,pure:!0}),r})()}}]);